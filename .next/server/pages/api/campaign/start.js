"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "pages/api/campaign/start";
exports.ids = ["pages/api/campaign/start"];
exports.modules = {

/***/ "bullmq":
/*!*************************!*\
  !*** external "bullmq" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("bullmq");

/***/ }),

/***/ "ioredis":
/*!**************************!*\
  !*** external "ioredis" ***!
  \**************************/
/***/ ((module) => {

module.exports = require("ioredis");

/***/ }),

/***/ "mongodb":
/*!**************************!*\
  !*** external "mongodb" ***!
  \**************************/
/***/ ((module) => {

module.exports = require("mongodb");

/***/ }),

/***/ "next/dist/compiled/next-server/pages-api.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/pages-api.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/pages-api.runtime.dev.js");

/***/ }),

/***/ "(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fcampaign%2Fstart&preferredRegion=&absolutePagePath=.%2Fpages%5Capi%5Ccampaign%5Cstart.ts&middlewareConfigBase64=e30%3D!":
/*!**************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fcampaign%2Fstart&preferredRegion=&absolutePagePath=.%2Fpages%5Capi%5Ccampaign%5Cstart.ts&middlewareConfigBase64=e30%3D! ***!
  \**************************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   config: () => (/* binding */ config),\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__),\n/* harmony export */   routeModule: () => (/* binding */ routeModule)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/pages-api/module.compiled */ \"(api)/./node_modules/next/dist/server/future/route-modules/pages-api/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(api)/./node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/build/templates/helpers */ \"(api)/./node_modules/next/dist/build/templates/helpers.js\");\n/* harmony import */ var _pages_api_campaign_start_ts__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./pages\\api\\campaign\\start.ts */ \"(api)/./pages/api/campaign/start.ts\");\n\n\n\n// Import the userland code.\n\n// Re-export the handler (should be the default export).\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__.hoist)(_pages_api_campaign_start_ts__WEBPACK_IMPORTED_MODULE_3__, \"default\"));\n// Re-export config.\nconst config = (0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__.hoist)(_pages_api_campaign_start_ts__WEBPACK_IMPORTED_MODULE_3__, \"config\");\n// Create and export the route module that will be consumed.\nconst routeModule = new next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__.PagesAPIRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.PAGES_API,\n        page: \"/api/campaign/start\",\n        pathname: \"/api/campaign/start\",\n        // The following aren't used in production.\n        bundlePath: \"\",\n        filename: \"\"\n    },\n    userland: _pages_api_campaign_start_ts__WEBPACK_IMPORTED_MODULE_3__\n});\n\n//# sourceMappingURL=pages-api.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LXJvdXRlLWxvYWRlci9pbmRleC5qcz9raW5kPVBBR0VTX0FQSSZwYWdlPSUyRmFwaSUyRmNhbXBhaWduJTJGc3RhcnQmcHJlZmVycmVkUmVnaW9uPSZhYnNvbHV0ZVBhZ2VQYXRoPS4lMkZwYWdlcyU1Q2FwaSU1Q2NhbXBhaWduJTVDc3RhcnQudHMmbWlkZGxld2FyZUNvbmZpZ0Jhc2U2ND1lMzAlM0QhIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7O0FBQXNHO0FBQ3ZDO0FBQ0w7QUFDMUQ7QUFDNkQ7QUFDN0Q7QUFDQSxpRUFBZSx3RUFBSyxDQUFDLHlEQUFRLFlBQVksRUFBQztBQUMxQztBQUNPLGVBQWUsd0VBQUssQ0FBQyx5REFBUTtBQUNwQztBQUNPLHdCQUF3QixnSEFBbUI7QUFDbEQ7QUFDQSxjQUFjLHlFQUFTO0FBQ3ZCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0wsWUFBWTtBQUNaLENBQUM7O0FBRUQiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9tYXJrZXRpbmctbXZwLz9mYzFhIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IFBhZ2VzQVBJUm91dGVNb2R1bGUgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9mdXR1cmUvcm91dGUtbW9kdWxlcy9wYWdlcy1hcGkvbW9kdWxlLmNvbXBpbGVkXCI7XG5pbXBvcnQgeyBSb3V0ZUtpbmQgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9mdXR1cmUvcm91dGUta2luZFwiO1xuaW1wb3J0IHsgaG9pc3QgfSBmcm9tIFwibmV4dC9kaXN0L2J1aWxkL3RlbXBsYXRlcy9oZWxwZXJzXCI7XG4vLyBJbXBvcnQgdGhlIHVzZXJsYW5kIGNvZGUuXG5pbXBvcnQgKiBhcyB1c2VybGFuZCBmcm9tIFwiLi9wYWdlc1xcXFxhcGlcXFxcY2FtcGFpZ25cXFxcc3RhcnQudHNcIjtcbi8vIFJlLWV4cG9ydCB0aGUgaGFuZGxlciAoc2hvdWxkIGJlIHRoZSBkZWZhdWx0IGV4cG9ydCkuXG5leHBvcnQgZGVmYXVsdCBob2lzdCh1c2VybGFuZCwgXCJkZWZhdWx0XCIpO1xuLy8gUmUtZXhwb3J0IGNvbmZpZy5cbmV4cG9ydCBjb25zdCBjb25maWcgPSBob2lzdCh1c2VybGFuZCwgXCJjb25maWdcIik7XG4vLyBDcmVhdGUgYW5kIGV4cG9ydCB0aGUgcm91dGUgbW9kdWxlIHRoYXQgd2lsbCBiZSBjb25zdW1lZC5cbmV4cG9ydCBjb25zdCByb3V0ZU1vZHVsZSA9IG5ldyBQYWdlc0FQSVJvdXRlTW9kdWxlKHtcbiAgICBkZWZpbml0aW9uOiB7XG4gICAgICAgIGtpbmQ6IFJvdXRlS2luZC5QQUdFU19BUEksXG4gICAgICAgIHBhZ2U6IFwiL2FwaS9jYW1wYWlnbi9zdGFydFwiLFxuICAgICAgICBwYXRobmFtZTogXCIvYXBpL2NhbXBhaWduL3N0YXJ0XCIsXG4gICAgICAgIC8vIFRoZSBmb2xsb3dpbmcgYXJlbid0IHVzZWQgaW4gcHJvZHVjdGlvbi5cbiAgICAgICAgYnVuZGxlUGF0aDogXCJcIixcbiAgICAgICAgZmlsZW5hbWU6IFwiXCJcbiAgICB9LFxuICAgIHVzZXJsYW5kXG59KTtcblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9cGFnZXMtYXBpLmpzLm1hcCJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fcampaign%2Fstart&preferredRegion=&absolutePagePath=.%2Fpages%5Capi%5Ccampaign%5Cstart.ts&middlewareConfigBase64=e30%3D!\n");

/***/ }),

/***/ "(api)/./lib/mongo.ts":
/*!**********************!*\
  !*** ./lib/mongo.ts ***!
  \**********************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony import */ var mongodb__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! mongodb */ \"mongodb\");\n/* harmony import */ var mongodb__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(mongodb__WEBPACK_IMPORTED_MODULE_0__);\n\nconst uri = process.env.MONGODB_URI;\nif (!uri) throw new Error(\"MONGODB_URI not set\");\nlet client;\nlet clientPromise;\nif (!global._mongoClientPromise) {\n    client = new mongodb__WEBPACK_IMPORTED_MODULE_0__.MongoClient(uri, {\n        maxPoolSize: 10,\n        serverSelectionTimeoutMS: 5000,\n        socketTimeoutMS: 45000\n    });\n    // Connect immediately but reuse promise globally\n    global._mongoClientPromise = client.connect();\n    // Optional: log connection events\n    client.on(\"serverOpening\", (event)=>console.log(\"MongoDB server opening\", event));\n    client.on(\"serverClosed\", (event)=>console.warn(\"MongoDB server closed\", event));\n    client.on(\"topologyClosed\", ()=>console.warn(\"MongoDB topology closed\"));\n    client.on(\"topologyOpening\", ()=>console.log(\"MongoDB topology opening\"));\n    client.on(\"error\", (err)=>console.error(\"MongoDB error\", err));\n}\nclientPromise = global._mongoClientPromise;\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (clientPromise);\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi9saWIvbW9uZ28udHMiLCJtYXBwaW5ncyI6Ijs7Ozs7O0FBQXNDO0FBRXRDLE1BQU1DLE1BQU1DLFFBQVFDLEdBQUcsQ0FBQ0MsV0FBVztBQUNuQyxJQUFJLENBQUNILEtBQUssTUFBTSxJQUFJSSxNQUFNO0FBRTFCLElBQUlDO0FBQ0osSUFBSUM7QUFPSixJQUFJLENBQUNDLE9BQU9DLG1CQUFtQixFQUFFO0lBQy9CSCxTQUFTLElBQUlOLGdEQUFXQSxDQUFDQyxLQUFLO1FBQzVCUyxhQUFhO1FBQ2JDLDBCQUEwQjtRQUMxQkMsaUJBQWlCO0lBRW5CO0lBRUEsaURBQWlEO0lBQ2pESixPQUFPQyxtQkFBbUIsR0FBR0gsT0FBT08sT0FBTztJQUUzQyxrQ0FBa0M7SUFDbENQLE9BQU9RLEVBQUUsQ0FBQyxpQkFBaUIsQ0FBQ0MsUUFBVUMsUUFBUUMsR0FBRyxDQUFDLDBCQUEwQkY7SUFDNUVULE9BQU9RLEVBQUUsQ0FBQyxnQkFBZ0IsQ0FBQ0MsUUFBVUMsUUFBUUUsSUFBSSxDQUFDLHlCQUF5Qkg7SUFDM0VULE9BQU9RLEVBQUUsQ0FBQyxrQkFBa0IsSUFBTUUsUUFBUUUsSUFBSSxDQUFDO0lBQy9DWixPQUFPUSxFQUFFLENBQUMsbUJBQW1CLElBQU1FLFFBQVFDLEdBQUcsQ0FBQztJQUMvQ1gsT0FBT1EsRUFBRSxDQUFDLFNBQVMsQ0FBQ0ssTUFBUUgsUUFBUUksS0FBSyxDQUFDLGlCQUFpQkQ7QUFDN0Q7QUFFQVosZ0JBQWdCQyxPQUFPQyxtQkFBbUI7QUFFMUMsaUVBQWVGLGFBQWFBLEVBQUMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9tYXJrZXRpbmctbXZwLy4vbGliL21vbmdvLnRzPzU3ZmUiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgTW9uZ29DbGllbnQgfSBmcm9tICdtb25nb2RiJztcclxuXHJcbmNvbnN0IHVyaSA9IHByb2Nlc3MuZW52Lk1PTkdPREJfVVJJO1xyXG5pZiAoIXVyaSkgdGhyb3cgbmV3IEVycm9yKCdNT05HT0RCX1VSSSBub3Qgc2V0Jyk7XHJcblxyXG5sZXQgY2xpZW50OiBNb25nb0NsaWVudDtcclxubGV0IGNsaWVudFByb21pc2U6IFByb21pc2U8TW9uZ29DbGllbnQ+O1xyXG5cclxuZGVjbGFyZSBnbG9iYWwge1xyXG4gIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBuby12YXJcclxuICB2YXIgX21vbmdvQ2xpZW50UHJvbWlzZTogUHJvbWlzZTxNb25nb0NsaWVudD4gfCB1bmRlZmluZWQ7XHJcbn1cclxuXHJcbmlmICghZ2xvYmFsLl9tb25nb0NsaWVudFByb21pc2UpIHtcclxuICBjbGllbnQgPSBuZXcgTW9uZ29DbGllbnQodXJpLCB7XHJcbiAgICBtYXhQb29sU2l6ZTogMTAsXHJcbiAgICBzZXJ2ZXJTZWxlY3Rpb25UaW1lb3V0TVM6IDUwMDAsXHJcbiAgICBzb2NrZXRUaW1lb3V0TVM6IDQ1MDAwLFxyXG4gICAgLy8gdXNlVW5pZmllZFRvcG9sb2d5IGlzIGRlZmF1bHQgaW4gbW9kZXJuIGRyaXZlcnNcclxuICB9KTtcclxuXHJcbiAgLy8gQ29ubmVjdCBpbW1lZGlhdGVseSBidXQgcmV1c2UgcHJvbWlzZSBnbG9iYWxseVxyXG4gIGdsb2JhbC5fbW9uZ29DbGllbnRQcm9taXNlID0gY2xpZW50LmNvbm5lY3QoKTtcclxuXHJcbiAgLy8gT3B0aW9uYWw6IGxvZyBjb25uZWN0aW9uIGV2ZW50c1xyXG4gIGNsaWVudC5vbignc2VydmVyT3BlbmluZycsIChldmVudCkgPT4gY29uc29sZS5sb2coJ01vbmdvREIgc2VydmVyIG9wZW5pbmcnLCBldmVudCkpO1xyXG4gIGNsaWVudC5vbignc2VydmVyQ2xvc2VkJywgKGV2ZW50KSA9PiBjb25zb2xlLndhcm4oJ01vbmdvREIgc2VydmVyIGNsb3NlZCcsIGV2ZW50KSk7XHJcbiAgY2xpZW50Lm9uKCd0b3BvbG9neUNsb3NlZCcsICgpID0+IGNvbnNvbGUud2FybignTW9uZ29EQiB0b3BvbG9neSBjbG9zZWQnKSk7XHJcbiAgY2xpZW50Lm9uKCd0b3BvbG9neU9wZW5pbmcnLCAoKSA9PiBjb25zb2xlLmxvZygnTW9uZ29EQiB0b3BvbG9neSBvcGVuaW5nJykpO1xyXG4gIGNsaWVudC5vbignZXJyb3InLCAoZXJyKSA9PiBjb25zb2xlLmVycm9yKCdNb25nb0RCIGVycm9yJywgZXJyKSk7XHJcbn1cclxuXHJcbmNsaWVudFByb21pc2UgPSBnbG9iYWwuX21vbmdvQ2xpZW50UHJvbWlzZTtcclxuXHJcbmV4cG9ydCBkZWZhdWx0IGNsaWVudFByb21pc2U7XHJcbiJdLCJuYW1lcyI6WyJNb25nb0NsaWVudCIsInVyaSIsInByb2Nlc3MiLCJlbnYiLCJNT05HT0RCX1VSSSIsIkVycm9yIiwiY2xpZW50IiwiY2xpZW50UHJvbWlzZSIsImdsb2JhbCIsIl9tb25nb0NsaWVudFByb21pc2UiLCJtYXhQb29sU2l6ZSIsInNlcnZlclNlbGVjdGlvblRpbWVvdXRNUyIsInNvY2tldFRpbWVvdXRNUyIsImNvbm5lY3QiLCJvbiIsImV2ZW50IiwiY29uc29sZSIsImxvZyIsIndhcm4iLCJlcnIiLCJlcnJvciJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(api)/./lib/mongo.ts\n");

/***/ }),

/***/ "(api)/./lib/redis.ts":
/*!**********************!*\
  !*** ./lib/redis.ts ***!
  \**********************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   redis: () => (/* binding */ redis)\n/* harmony export */ });\n/* harmony import */ var ioredis__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ioredis */ \"ioredis\");\n/* harmony import */ var ioredis__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(ioredis__WEBPACK_IMPORTED_MODULE_0__);\n\nconst redis = new (ioredis__WEBPACK_IMPORTED_MODULE_0___default())(process.env.REDIS_URL || \"redis://127.0.0.1:6379\", {\n    maxRetriesPerRequest: null,\n    lazyConnect: true,\n    reconnectOnError: (err)=>{\n        // reconnect on most errors\n        const targetErrors = [\n            \"READONLY\",\n            \"ECONNRESET\",\n            \"ETIMEDOUT\"\n        ];\n        if (targetErrors.some((e)=>err.message.includes(e))) return true;\n        return false;\n    }\n});\n// Optional: log Redis connection events for observability\nredis.on(\"connect\", ()=>console.log(\"Redis connected\"));\nredis.on(\"ready\", ()=>console.log(\"Redis ready\"));\nredis.on(\"error\", (err)=>console.error(\"Redis error\", err));\nredis.on(\"close\", ()=>console.warn(\"Redis connection closed\"));\nredis.on(\"reconnecting\", ()=>console.log(\"Redis reconnecting\"));\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi9saWIvcmVkaXMudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7O0FBQThCO0FBRXZCLE1BQU1DLFFBQVEsSUFBSUQsZ0RBQU9BLENBQUNFLFFBQVFDLEdBQUcsQ0FBQ0MsU0FBUyxJQUFJLDBCQUEwQjtJQUNsRkMsc0JBQXNCO0lBQ3RCQyxhQUFhO0lBQ2JDLGtCQUFrQixDQUFDQztRQUNqQiwyQkFBMkI7UUFDM0IsTUFBTUMsZUFBZTtZQUFDO1lBQVk7WUFBYztTQUFZO1FBQzVELElBQUlBLGFBQWFDLElBQUksQ0FBQ0MsQ0FBQUEsSUFBS0gsSUFBSUksT0FBTyxDQUFDQyxRQUFRLENBQUNGLEtBQUssT0FBTztRQUM1RCxPQUFPO0lBQ1Q7QUFDRixHQUFHO0FBRUgsMERBQTBEO0FBQzFEVixNQUFNYSxFQUFFLENBQUMsV0FBVyxJQUFNQyxRQUFRQyxHQUFHLENBQUM7QUFDdENmLE1BQU1hLEVBQUUsQ0FBQyxTQUFTLElBQU1DLFFBQVFDLEdBQUcsQ0FBQztBQUNwQ2YsTUFBTWEsRUFBRSxDQUFDLFNBQVMsQ0FBQ04sTUFBUU8sUUFBUUUsS0FBSyxDQUFDLGVBQWVUO0FBQ3hEUCxNQUFNYSxFQUFFLENBQUMsU0FBUyxJQUFNQyxRQUFRRyxJQUFJLENBQUM7QUFDckNqQixNQUFNYSxFQUFFLENBQUMsZ0JBQWdCLElBQU1DLFFBQVFDLEdBQUcsQ0FBQyIsInNvdXJjZXMiOlsid2VicGFjazovL21hcmtldGluZy1tdnAvLi9saWIvcmVkaXMudHM/NTFlOSJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgSU9SZWRpcyBmcm9tICdpb3JlZGlzJztcblxuZXhwb3J0IGNvbnN0IHJlZGlzID0gbmV3IElPUmVkaXMocHJvY2Vzcy5lbnYuUkVESVNfVVJMIHx8ICdyZWRpczovLzEyNy4wLjAuMTo2Mzc5Jywge1xuICBtYXhSZXRyaWVzUGVyUmVxdWVzdDogbnVsbCxcbiAgbGF6eUNvbm5lY3Q6IHRydWUsICAgICAgICAgICAvLyBwcmV2ZW50cyBpbW1lZGlhdGUgY29ubmVjdGlvbiBvbiBpbXBvcnRcbiAgcmVjb25uZWN0T25FcnJvcjogKGVycikgPT4ge1xuICAgIC8vIHJlY29ubmVjdCBvbiBtb3N0IGVycm9yc1xuICAgIGNvbnN0IHRhcmdldEVycm9ycyA9IFsnUkVBRE9OTFknLCAnRUNPTk5SRVNFVCcsICdFVElNRURPVVQnXTtcbiAgICBpZiAodGFyZ2V0RXJyb3JzLnNvbWUoZSA9PiBlcnIubWVzc2FnZS5pbmNsdWRlcyhlKSkpIHJldHVybiB0cnVlO1xuICAgIHJldHVybiBmYWxzZTtcbiAgfSxcbn0pO1xuXG4vLyBPcHRpb25hbDogbG9nIFJlZGlzIGNvbm5lY3Rpb24gZXZlbnRzIGZvciBvYnNlcnZhYmlsaXR5XG5yZWRpcy5vbignY29ubmVjdCcsICgpID0+IGNvbnNvbGUubG9nKCdSZWRpcyBjb25uZWN0ZWQnKSk7XG5yZWRpcy5vbigncmVhZHknLCAoKSA9PiBjb25zb2xlLmxvZygnUmVkaXMgcmVhZHknKSk7XG5yZWRpcy5vbignZXJyb3InLCAoZXJyKSA9PiBjb25zb2xlLmVycm9yKCdSZWRpcyBlcnJvcicsIGVycikpO1xucmVkaXMub24oJ2Nsb3NlJywgKCkgPT4gY29uc29sZS53YXJuKCdSZWRpcyBjb25uZWN0aW9uIGNsb3NlZCcpKTtcbnJlZGlzLm9uKCdyZWNvbm5lY3RpbmcnLCAoKSA9PiBjb25zb2xlLmxvZygnUmVkaXMgcmVjb25uZWN0aW5nJykpOyJdLCJuYW1lcyI6WyJJT1JlZGlzIiwicmVkaXMiLCJwcm9jZXNzIiwiZW52IiwiUkVESVNfVVJMIiwibWF4UmV0cmllc1BlclJlcXVlc3QiLCJsYXp5Q29ubmVjdCIsInJlY29ubmVjdE9uRXJyb3IiLCJlcnIiLCJ0YXJnZXRFcnJvcnMiLCJzb21lIiwiZSIsIm1lc3NhZ2UiLCJpbmNsdWRlcyIsIm9uIiwiY29uc29sZSIsImxvZyIsImVycm9yIiwid2FybiJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(api)/./lib/redis.ts\n");

/***/ }),

/***/ "(api)/./pages/api/campaign/start.ts":
/*!*************************************!*\
  !*** ./pages/api/campaign/start.ts ***!
  \*************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (/* binding */ handler)\n/* harmony export */ });\n/* harmony import */ var bullmq__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! bullmq */ \"bullmq\");\n/* harmony import */ var bullmq__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(bullmq__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _lib_redis__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../lib/redis */ \"(api)/./lib/redis.ts\");\n/* harmony import */ var _lib_mongo__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../lib/mongo */ \"(api)/./lib/mongo.ts\");\n// pages/api/campaign/start.ts\n\n\n\nconst queue = new bullmq__WEBPACK_IMPORTED_MODULE_0__.Queue(\"campaigns\", {\n    connection: _lib_redis__WEBPACK_IMPORTED_MODULE_1__.redis\n});\n// utility to chunk arrays\nfunction chunkArray(arr, size = 1000) {\n    const out = [];\n    for(let i = 0; i < arr.length; i += size)out.push(arr.slice(i, i + size));\n    return out;\n}\nasync function handler(req, res) {\n    if (req.method !== \"POST\") {\n        return res.status(405).json({\n            error: \"Method not allowed\"\n        });\n    }\n    const { name, contacts, initial, followUps = [] } = req.body;\n    if (!name || typeof name !== \"string\") {\n        return res.status(400).json({\n            error: \"Campaign name required\"\n        });\n    }\n    if (!initial?.subject || !initial?.body) {\n        return res.status(400).json({\n            error: \"Initial email subject and body required\"\n        });\n    }\n    if (!contacts || ![\n        \"all\",\n        \"segment\"\n    ].includes(contacts.type)) {\n        return res.status(400).json({\n            error: \"Invalid contact selection\"\n        });\n    }\n    const client = await _lib_mongo__WEBPACK_IMPORTED_MODULE_2__[\"default\"];\n    const db = client.db(\"PlatformData\");\n    const query = contacts.type === \"all\" ? {} : {\n        segments: contacts.value\n    };\n    const contactDocs = await db.collection(\"contacts\").find(query).project({\n        _id: 1,\n        email: 1\n    }).toArray();\n    if (!contactDocs.length) {\n        return res.status(400).json({\n            error: \"No contacts matched selection\"\n        });\n    }\n    const createdAt = new Date();\n    // --- Create campaign document ---\n    const campaignDoc = {\n        name,\n        contacts,\n        initial,\n        followUps,\n        totals: {\n            intended: contactDocs.length,\n            processed: 0,\n            sent: 0,\n            failed: 0\n        },\n        status: \"running\",\n        createdAt\n    };\n    const campaignResult = await db.collection(\"campaigns\").insertOne(campaignDoc);\n    const campaignObjectId = campaignResult.insertedId;\n    const campaignId = campaignObjectId.toString();\n    // --- Insert ledger idempotently ---\n    const ledgerDocs = contactDocs.map((c)=>({\n            campaignId: campaignObjectId,\n            contactId: c._id,\n            status: \"pending\",\n            attempts: 0,\n            createdAt: new Date()\n        }));\n    const chunks = chunkArray(ledgerDocs, 1000);\n    for (const chunk of chunks){\n        try {\n            await db.collection(\"campaign_contacts\").insertMany(chunk, {\n                ordered: false\n            });\n        } catch (e) {\n        // Duplicate key errors are safe to ignore (idempotency)\n        }\n    }\n    // --- Redis runtime meta (best-effort) ---\n    try {\n        await _lib_redis__WEBPACK_IMPORTED_MODULE_1__.redis.hset(`campaign:${campaignId}:meta`, {\n            name,\n            total: String(contactDocs.length),\n            processed: \"0\",\n            sent: \"0\",\n            failed: \"0\",\n            status: \"running\",\n            createdAt: createdAt.toISOString()\n        });\n        await _lib_redis__WEBPACK_IMPORTED_MODULE_1__.redis.set(`campaign:${campaignId}:definition`, JSON.stringify({\n            initial,\n            followUps,\n            name,\n            contacts\n        }));\n        await _lib_redis__WEBPACK_IMPORTED_MODULE_1__.redis.sadd(\"campaign:all\", campaignId);\n    } catch (e) {\n        console.warn(\"Redis unavailable during campaign start\", e);\n    }\n    // --- Enqueue initial jobs ONLY for pending ledger rows ---\n    for (const c of contactDocs){\n        if (!c.email) continue;\n        await queue.add(\"initial\", {\n            campaignId,\n            contactId: c._id.toString()\n        }, {\n            removeOnComplete: true,\n            removeOnFail: true\n        });\n    }\n    // --- Notify UI ---\n    try {\n        await _lib_redis__WEBPACK_IMPORTED_MODULE_1__.redis.publish(\"campaign:new\", JSON.stringify({\n            id: campaignId,\n            name,\n            total: contactDocs.length,\n            createdAt: createdAt.toISOString()\n        }));\n    } catch  {\n    // non-fatal\n    }\n    return res.status(201).json({\n        campaignId,\n        total: contactDocs.length\n    });\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QjhCLFdBQVdBLFVBQVUyQixXQUFXO1FBQ2xDO0lBRUosRUFBRSxPQUFNO0lBQ04sWUFBWTtJQUNkO0lBRUEsT0FBT3BELElBQUlFLE1BQU0sQ0FBQyxLQUFLQyxJQUFJLENBQUM7UUFDMUJrQztRQUNBYSxPQUFPaEMsWUFBWXZCLE1BQU07SUFDM0I7QUFDRiIsInNvdXJjZXMiOlsid2VicGFjazovL21hcmtldGluZy1tdnAvLi9wYWdlcy9hcGkvY2FtcGFpZ24vc3RhcnQudHM/NDU1ZiJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBwYWdlcy9hcGkvY2FtcGFpZ24vc3RhcnQudHNcbmltcG9ydCB0eXBlIHsgTmV4dEFwaVJlcXVlc3QsIE5leHRBcGlSZXNwb25zZSB9IGZyb20gJ25leHQnO1xuaW1wb3J0IHsgUXVldWUgfSBmcm9tICdidWxsbXEnO1xuaW1wb3J0IHsgcmVkaXMgfSBmcm9tICcuLi8uLi8uLi9saWIvcmVkaXMnO1xuaW1wb3J0IGNsaWVudFByb21pc2UgZnJvbSAnLi4vLi4vLi4vbGliL21vbmdvJztcbmltcG9ydCB7IE9iamVjdElkIH0gZnJvbSAnbW9uZ29kYic7XG5cbmNvbnN0IHF1ZXVlID0gbmV3IFF1ZXVlKCdjYW1wYWlnbnMnLCB7IGNvbm5lY3Rpb246IHJlZGlzIH0pO1xuXG4vLyB1dGlsaXR5IHRvIGNodW5rIGFycmF5c1xuZnVuY3Rpb24gY2h1bmtBcnJheTxUPihhcnI6IFRbXSwgc2l6ZSA9IDEwMDApOiBUW11bXSB7XG4gIGNvbnN0IG91dDogVFtdW10gPSBbXTtcbiAgZm9yIChsZXQgaSA9IDA7IGkgPCBhcnIubGVuZ3RoOyBpICs9IHNpemUpIG91dC5wdXNoKGFyci5zbGljZShpLCBpICsgc2l6ZSkpO1xuICByZXR1cm4gb3V0O1xufVxuXG5leHBvcnQgZGVmYXVsdCBhc3luYyBmdW5jdGlvbiBoYW5kbGVyKFxuICByZXE6IE5leHRBcGlSZXF1ZXN0LFxuICByZXM6IE5leHRBcGlSZXNwb25zZVxuKSB7XG4gIGlmIChyZXEubWV0aG9kICE9PSAnUE9TVCcpIHtcbiAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDUpLmpzb24oeyBlcnJvcjogJ01ldGhvZCBub3QgYWxsb3dlZCcgfSk7XG4gIH1cblxuICBjb25zdCB7IG5hbWUsIGNvbnRhY3RzLCBpbml0aWFsLCBmb2xsb3dVcHMgPSBbXSB9ID0gcmVxLmJvZHk7XG5cbiAgaWYgKCFuYW1lIHx8IHR5cGVvZiBuYW1lICE9PSAnc3RyaW5nJykge1xuICAgIHJldHVybiByZXMuc3RhdHVzKDQwMCkuanNvbih7IGVycm9yOiAnQ2FtcGFpZ24gbmFtZSByZXF1aXJlZCcgfSk7XG4gIH1cblxuICBpZiAoIWluaXRpYWw/LnN1YmplY3QgfHwgIWluaXRpYWw/LmJvZHkpIHtcbiAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDApLmpzb24oeyBlcnJvcjogJ0luaXRpYWwgZW1haWwgc3ViamVjdCBhbmQgYm9keSByZXF1aXJlZCcgfSk7XG4gIH1cblxuICBpZiAoIWNvbnRhY3RzIHx8ICFbJ2FsbCcsICdzZWdtZW50J10uaW5jbHVkZXMoY29udGFjdHMudHlwZSkpIHtcbiAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDApLmpzb24oeyBlcnJvcjogJ0ludmFsaWQgY29udGFjdCBzZWxlY3Rpb24nIH0pO1xuICB9XG5cbiAgY29uc3QgY2xpZW50ID0gYXdhaXQgY2xpZW50UHJvbWlzZTtcbiAgY29uc3QgZGIgPSBjbGllbnQuZGIoJ1BsYXRmb3JtRGF0YScpO1xuXG4gIGNvbnN0IHF1ZXJ5ID1cbiAgICBjb250YWN0cy50eXBlID09PSAnYWxsJ1xuICAgICAgPyB7fVxuICAgICAgOiB7IHNlZ21lbnRzOiBjb250YWN0cy52YWx1ZSB9O1xuXG4gIGNvbnN0IGNvbnRhY3REb2NzID0gYXdhaXQgZGJcbiAgICAuY29sbGVjdGlvbignY29udGFjdHMnKVxuICAgIC5maW5kKHF1ZXJ5KVxuICAgIC5wcm9qZWN0KHsgX2lkOiAxLCBlbWFpbDogMSB9KVxuICAgIC50b0FycmF5KCk7XG5cbiAgaWYgKCFjb250YWN0RG9jcy5sZW5ndGgpIHtcbiAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDApLmpzb24oeyBlcnJvcjogJ05vIGNvbnRhY3RzIG1hdGNoZWQgc2VsZWN0aW9uJyB9KTtcbiAgfVxuXG4gIGNvbnN0IGNyZWF0ZWRBdCA9IG5ldyBEYXRlKCk7XG5cbiAgLy8gLS0tIENyZWF0ZSBjYW1wYWlnbiBkb2N1bWVudCAtLS1cbiAgY29uc3QgY2FtcGFpZ25Eb2MgPSB7XG4gICAgbmFtZSxcbiAgICBjb250YWN0cyxcbiAgICBpbml0aWFsLFxuICAgIGZvbGxvd1VwcyxcbiAgICB0b3RhbHM6IHtcbiAgICAgIGludGVuZGVkOiBjb250YWN0RG9jcy5sZW5ndGgsXG4gICAgICBwcm9jZXNzZWQ6IDAsXG4gICAgICBzZW50OiAwLFxuICAgICAgZmFpbGVkOiAwLFxuICAgIH0sXG4gICAgc3RhdHVzOiAncnVubmluZycsXG4gICAgY3JlYXRlZEF0LFxuICB9O1xuXG4gIGNvbnN0IGNhbXBhaWduUmVzdWx0ID0gYXdhaXQgZGJcbiAgICAuY29sbGVjdGlvbignY2FtcGFpZ25zJylcbiAgICAuaW5zZXJ0T25lKGNhbXBhaWduRG9jKTtcblxuICBjb25zdCBjYW1wYWlnbk9iamVjdElkID0gY2FtcGFpZ25SZXN1bHQuaW5zZXJ0ZWRJZDtcbiAgY29uc3QgY2FtcGFpZ25JZCA9IGNhbXBhaWduT2JqZWN0SWQudG9TdHJpbmcoKTtcblxuICAvLyAtLS0gSW5zZXJ0IGxlZGdlciBpZGVtcG90ZW50bHkgLS0tXG4gIGNvbnN0IGxlZGdlckRvY3MgPSBjb250YWN0RG9jcy5tYXAoKGMpID0+ICh7XG4gICAgY2FtcGFpZ25JZDogY2FtcGFpZ25PYmplY3RJZCxcbiAgICBjb250YWN0SWQ6IGMuX2lkLFxuICAgIHN0YXR1czogJ3BlbmRpbmcnLFxuICAgIGF0dGVtcHRzOiAwLFxuICAgIGNyZWF0ZWRBdDogbmV3IERhdGUoKSxcbiAgfSkpO1xuXG4gIGNvbnN0IGNodW5rcyA9IGNodW5rQXJyYXkobGVkZ2VyRG9jcywgMTAwMCk7XG4gIGZvciAoY29uc3QgY2h1bmsgb2YgY2h1bmtzKSB7XG4gICAgdHJ5IHtcbiAgICAgIGF3YWl0IGRiXG4gICAgICAgIC5jb2xsZWN0aW9uKCdjYW1wYWlnbl9jb250YWN0cycpXG4gICAgICAgIC5pbnNlcnRNYW55KGNodW5rLCB7IG9yZGVyZWQ6IGZhbHNlIH0pO1xuICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgIC8vIER1cGxpY2F0ZSBrZXkgZXJyb3JzIGFyZSBzYWZlIHRvIGlnbm9yZSAoaWRlbXBvdGVuY3kpXG4gICAgfVxuICB9XG5cbiAgLy8gLS0tIFJlZGlzIHJ1bnRpbWUgbWV0YSAoYmVzdC1lZmZvcnQpIC0tLVxuICB0cnkge1xuICAgIGF3YWl0IHJlZGlzLmhzZXQoYGNhbXBhaWduOiR7Y2FtcGFpZ25JZH06bWV0YWAsIHtcbiAgICAgIG5hbWUsXG4gICAgICB0b3RhbDogU3RyaW5nKGNvbnRhY3REb2NzLmxlbmd0aCksXG4gICAgICBwcm9jZXNzZWQ6ICcwJyxcbiAgICAgIHNlbnQ6ICcwJyxcbiAgICAgIGZhaWxlZDogJzAnLFxuICAgICAgc3RhdHVzOiAncnVubmluZycsXG4gICAgICBjcmVhdGVkQXQ6IGNyZWF0ZWRBdC50b0lTT1N0cmluZygpLFxuICAgIH0pO1xuXG4gICAgYXdhaXQgcmVkaXMuc2V0KFxuICAgICAgYGNhbXBhaWduOiR7Y2FtcGFpZ25JZH06ZGVmaW5pdGlvbmAsXG4gICAgICBKU09OLnN0cmluZ2lmeSh7IGluaXRpYWwsIGZvbGxvd1VwcywgbmFtZSwgY29udGFjdHMgfSlcbiAgICApO1xuXG4gICAgYXdhaXQgcmVkaXMuc2FkZCgnY2FtcGFpZ246YWxsJywgY2FtcGFpZ25JZCk7XG4gIH0gY2F0Y2ggKGUpIHtcbiAgICBjb25zb2xlLndhcm4oJ1JlZGlzIHVuYXZhaWxhYmxlIGR1cmluZyBjYW1wYWlnbiBzdGFydCcsIGUpO1xuICB9XG5cbiAgLy8gLS0tIEVucXVldWUgaW5pdGlhbCBqb2JzIE9OTFkgZm9yIHBlbmRpbmcgbGVkZ2VyIHJvd3MgLS0tXG4gIGZvciAoY29uc3QgYyBvZiBjb250YWN0RG9jcykge1xuICAgIGlmICghYy5lbWFpbCkgY29udGludWU7XG5cbiAgICBhd2FpdCBxdWV1ZS5hZGQoXG4gICAgICAnaW5pdGlhbCcsXG4gICAgICB7XG4gICAgICAgIGNhbXBhaWduSWQsXG4gICAgICAgIGNvbnRhY3RJZDogYy5faWQudG9TdHJpbmcoKSxcbiAgICAgIH0sXG4gICAgICB7XG4gICAgICAgIHJlbW92ZU9uQ29tcGxldGU6IHRydWUsXG4gICAgICAgIHJlbW92ZU9uRmFpbDogdHJ1ZSxcbiAgICAgIH1cbiAgICApO1xuICB9XG5cbiAgLy8gLS0tIE5vdGlmeSBVSSAtLS1cbiAgdHJ5IHtcbiAgICBhd2FpdCByZWRpcy5wdWJsaXNoKFxuICAgICAgJ2NhbXBhaWduOm5ldycsXG4gICAgICBKU09OLnN0cmluZ2lmeSh7XG4gICAgICAgIGlkOiBjYW1wYWlnbklkLFxuICAgICAgICBuYW1lLFxuICAgICAgICB0b3RhbDogY29udGFjdERvY3MubGVuZ3RoLFxuICAgICAgICBjcmVhdGVkQXQ6IGNyZWF0ZWRBdC50b0lTT1N0cmluZygpLFxuICAgICAgfSlcbiAgICApO1xuICB9IGNhdGNoIHtcbiAgICAvLyBub24tZmF0YWxcbiAgfVxuXG4gIHJldHVybiByZXMuc3RhdHVzKDIwMSkuanNvbih7XG4gICAgY2FtcGFpZ25JZCxcbiAgICB0b3RhbDogY29udGFjdERvY3MubGVuZ3RoLFxuICB9KTtcbn1cbiJdLCJuYW1lcyI6WyJRdWV1ZSIsInJlZGlzIiwiY2xpZW50UHJvbWlzZSIsInF1ZXVlIiwiY29ubmVjdGlvbiIsImNodW5rQXJyYXkiLCJhcnIiLCJzaXplIiwib3V0IiwiaSIsImxlbmd0aCIsInB1c2giLCJzbGljZSIsImhhbmRsZXIiLCJyZXEiLCJyZXMiLCJtZXRob2QiLCJzdGF0dXMiLCJqc29uIiwiZXJyb3IiLCJuYW1lIiwiY29udGFjdHMiLCJpbml0aWFsIiwiZm9sbG93VXBzIiwiYm9keSIsInN1YmplY3QiLCJpbmNsdWRlcyIsInR5cGUiLCJjbGllbnQiLCJkYiIsInF1ZXJ5Iiwic2VnbWVudHMiLCJ2YWx1ZSIsImNvbnRhY3REb2NzIiwiY29sbGVjdGlvbiIsImZpbmQiLCJwcm9qZWN0IiwiX2lkIiwiZW1haWwiLCJ0b0FycmF5IiwiY3JlYXRlZEF0IiwiRGF0ZSIsImNhbXBhaWduRG9jIiwidG90YWxzIiwiaW50ZW5kZWQiLCJwcm9jZXNzZWQiLCJzZW50IiwiZmFpbGVkIiwiY2FtcGFpZ25SZXN1bHQiLCJpbnNlcnRPbmUiLCJjYW1wYWlnbk9iamVjdElkIiwiaW5zZXJ0ZWRJZCIsImNhbXBhaWduSWQiLCJ0b1N0cmluZyIsImxlZGdlckRvY3MiLCJtYXAiLCJjIiwiY29udGFjdElkIiwiYXR0ZW1wdHMiLCJjaHVua3MiLCJjaHVuayIsImluc2VydE1hbnkiLCJvcmRlcmVkIiwiZSIsImhzZXQiLCJ0b3RhbCIsIlN0cmluZyIsInRvSVNPU3RyaW5nIiwic2V0IiwiSlNPTiIsInN0cmluZ2lmeSIsInNhZGQiLCJjb25zb2xlIiwid2FybiIsImFkZCIsInJlbW92ZU9uQ29tcGxldGUiLCJyZW1vdmVPbkZhaWwiLCJwdWJsaXNoIiwiaWQiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(api)/./pages/api/campaign/start.ts\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../webpack-api-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next"], () => (__webpack_exec__("(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fcampaign%2Fstart&preferredRegion=&absolutePagePath=.%2Fpages%5Capi%5Ccampaign%5Cstart.ts&middlewareConfigBase64=e30%3D!")));
module.exports = __webpack_exports__;

})();