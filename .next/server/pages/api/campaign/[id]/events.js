"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "pages/api/campaign/[id]/events";
exports.ids = ["pages/api/campaign/[id]/events"];
exports.modules = {

/***/ "ioredis":
/*!**************************!*\
  !*** external "ioredis" ***!
  \**************************/
/***/ ((module) => {

module.exports = require("ioredis");

/***/ }),

/***/ "next/dist/compiled/next-server/pages-api.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/pages-api.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/pages-api.runtime.dev.js");

/***/ }),

/***/ "(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fcampaign%2F%5Bid%5D%2Fevents&preferredRegion=&absolutePagePath=.%2Fpages%5Capi%5Ccampaign%5C%5Bid%5D%5Cevents.ts&middlewareConfigBase64=e30%3D!":
/*!**************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fcampaign%2F%5Bid%5D%2Fevents&preferredRegion=&absolutePagePath=.%2Fpages%5Capi%5Ccampaign%5C%5Bid%5D%5Cevents.ts&middlewareConfigBase64=e30%3D! ***!
  \**************************************************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   config: () => (/* binding */ config),\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__),\n/* harmony export */   routeModule: () => (/* binding */ routeModule)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/pages-api/module.compiled */ \"(api)/./node_modules/next/dist/server/future/route-modules/pages-api/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(api)/./node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/build/templates/helpers */ \"(api)/./node_modules/next/dist/build/templates/helpers.js\");\n/* harmony import */ var _pages_api_campaign_id_events_ts__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./pages\\api\\campaign\\[id]\\events.ts */ \"(api)/./pages/api/campaign/[id]/events.ts\");\n\n\n\n// Import the userland code.\n\n// Re-export the handler (should be the default export).\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__.hoist)(_pages_api_campaign_id_events_ts__WEBPACK_IMPORTED_MODULE_3__, \"default\"));\n// Re-export config.\nconst config = (0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__.hoist)(_pages_api_campaign_id_events_ts__WEBPACK_IMPORTED_MODULE_3__, \"config\");\n// Create and export the route module that will be consumed.\nconst routeModule = new next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__.PagesAPIRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.PAGES_API,\n        page: \"/api/campaign/[id]/events\",\n        pathname: \"/api/campaign/[id]/events\",\n        // The following aren't used in production.\n        bundlePath: \"\",\n        filename: \"\"\n    },\n    userland: _pages_api_campaign_id_events_ts__WEBPACK_IMPORTED_MODULE_3__\n});\n\n//# sourceMappingURL=pages-api.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LXJvdXRlLWxvYWRlci9pbmRleC5qcz9raW5kPVBBR0VTX0FQSSZwYWdlPSUyRmFwaSUyRmNhbXBhaWduJTJGJTVCaWQlNUQlMkZldmVudHMmcHJlZmVycmVkUmVnaW9uPSZhYnNvbHV0ZVBhZ2VQYXRoPS4lMkZwYWdlcyU1Q2FwaSU1Q2NhbXBhaWduJTVDJTVCaWQlNUQlNUNldmVudHMudHMmbWlkZGxld2FyZUNvbmZpZ0Jhc2U2ND1lMzAlM0QhIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7O0FBQXNHO0FBQ3ZDO0FBQ0w7QUFDMUQ7QUFDb0U7QUFDcEU7QUFDQSxpRUFBZSx3RUFBSyxDQUFDLDZEQUFRLFlBQVksRUFBQztBQUMxQztBQUNPLGVBQWUsd0VBQUssQ0FBQyw2REFBUTtBQUNwQztBQUNPLHdCQUF3QixnSEFBbUI7QUFDbEQ7QUFDQSxjQUFjLHlFQUFTO0FBQ3ZCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0wsWUFBWTtBQUNaLENBQUM7O0FBRUQiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9tYXJrZXRpbmctbXZwLz9jNTk5Il0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IFBhZ2VzQVBJUm91dGVNb2R1bGUgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9mdXR1cmUvcm91dGUtbW9kdWxlcy9wYWdlcy1hcGkvbW9kdWxlLmNvbXBpbGVkXCI7XG5pbXBvcnQgeyBSb3V0ZUtpbmQgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9mdXR1cmUvcm91dGUta2luZFwiO1xuaW1wb3J0IHsgaG9pc3QgfSBmcm9tIFwibmV4dC9kaXN0L2J1aWxkL3RlbXBsYXRlcy9oZWxwZXJzXCI7XG4vLyBJbXBvcnQgdGhlIHVzZXJsYW5kIGNvZGUuXG5pbXBvcnQgKiBhcyB1c2VybGFuZCBmcm9tIFwiLi9wYWdlc1xcXFxhcGlcXFxcY2FtcGFpZ25cXFxcW2lkXVxcXFxldmVudHMudHNcIjtcbi8vIFJlLWV4cG9ydCB0aGUgaGFuZGxlciAoc2hvdWxkIGJlIHRoZSBkZWZhdWx0IGV4cG9ydCkuXG5leHBvcnQgZGVmYXVsdCBob2lzdCh1c2VybGFuZCwgXCJkZWZhdWx0XCIpO1xuLy8gUmUtZXhwb3J0IGNvbmZpZy5cbmV4cG9ydCBjb25zdCBjb25maWcgPSBob2lzdCh1c2VybGFuZCwgXCJjb25maWdcIik7XG4vLyBDcmVhdGUgYW5kIGV4cG9ydCB0aGUgcm91dGUgbW9kdWxlIHRoYXQgd2lsbCBiZSBjb25zdW1lZC5cbmV4cG9ydCBjb25zdCByb3V0ZU1vZHVsZSA9IG5ldyBQYWdlc0FQSVJvdXRlTW9kdWxlKHtcbiAgICBkZWZpbml0aW9uOiB7XG4gICAgICAgIGtpbmQ6IFJvdXRlS2luZC5QQUdFU19BUEksXG4gICAgICAgIHBhZ2U6IFwiL2FwaS9jYW1wYWlnbi9baWRdL2V2ZW50c1wiLFxuICAgICAgICBwYXRobmFtZTogXCIvYXBpL2NhbXBhaWduL1tpZF0vZXZlbnRzXCIsXG4gICAgICAgIC8vIFRoZSBmb2xsb3dpbmcgYXJlbid0IHVzZWQgaW4gcHJvZHVjdGlvbi5cbiAgICAgICAgYnVuZGxlUGF0aDogXCJcIixcbiAgICAgICAgZmlsZW5hbWU6IFwiXCJcbiAgICB9LFxuICAgIHVzZXJsYW5kXG59KTtcblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9cGFnZXMtYXBpLmpzLm1hcCJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fcampaign%2F%5Bid%5D%2Fevents&preferredRegion=&absolutePagePath=.%2Fpages%5Capi%5Ccampaign%5C%5Bid%5D%5Cevents.ts&middlewareConfigBase64=e30%3D!\n");

/***/ }),

/***/ "(api)/./lib/redis.ts":
/*!**********************!*\
  !*** ./lib/redis.ts ***!
  \**********************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   redis: () => (/* binding */ redis),\n/* harmony export */   subscribe: () => (/* binding */ subscribe),\n/* harmony export */   subscribeToChannels: () => (/* binding */ subscribeToChannels)\n/* harmony export */ });\n/* harmony import */ var ioredis__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ioredis */ \"ioredis\");\n/* harmony import */ var ioredis__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(ioredis__WEBPACK_IMPORTED_MODULE_0__);\n// lib/redis.ts\n\nconst redis = new (ioredis__WEBPACK_IMPORTED_MODULE_0___default())(process.env.REDIS_URL || \"redis://127.0.0.1:6379\", {\n    maxRetriesPerRequest: null,\n    lazyConnect: true,\n    reconnectOnError: (err)=>{\n        const targetErrors = [\n            \"READONLY\",\n            \"ECONNRESET\",\n            \"ETIMEDOUT\"\n        ];\n        try {\n            if (err && typeof err.message === \"string\") {\n                return targetErrors.some((e)=>err.message.includes(e));\n            }\n        } catch  {\n        // fall through\n        }\n        return false;\n    }\n});\nredis.on(\"connect\", ()=>console.log(\"Redis connected\"));\nredis.on(\"ready\", ()=>console.log(\"Redis ready\"));\nredis.on(\"error\", (err)=>console.error(\"Redis error\", err));\nredis.on(\"close\", ()=>console.warn(\"Redis connection closed\"));\nredis.on(\"reconnecting\", ()=>console.log(\"Redis reconnecting\"));\n/**\r\n * Subscribe to a single Redis channel (ioredis-style).\r\n * Returns an async unsubscribe function.\r\n */ async function subscribe(channel, handler) {\n    const sub = redis.duplicate();\n    const onMessage = (msgChannel, message)=>{\n        if (msgChannel !== channel) return;\n        try {\n            handler(JSON.parse(message));\n        } catch  {\n            handler(message);\n        }\n    };\n    sub.on(\"error\", (err)=>{\n        console.error(`Redis subscriber error for channel ${channel}`, err);\n    });\n    sub.on(\"message\", onMessage);\n    try {\n        // connect only if not already connecting/ready\n        try {\n            if (typeof sub.connect === \"function\") {\n                const status = sub.status;\n                if (status !== \"ready\" && status !== \"connecting\") {\n                    await sub.connect().catch((err)=>{\n                        console.warn(\"Subscriber connect error (continuing):\", err);\n                    });\n                } else {\n                // already connecting/ready — skip connect\n                }\n            }\n        } catch (e) {\n            console.warn(\"Subscriber connect guard error\", e);\n        }\n        await sub.subscribe(channel).catch((err)=>{\n            console.warn(`subscribe(${channel}) failed`, err);\n        });\n    } catch (err) {\n        console.error(`Failed to subscribe to Redis channel ${channel}`, err);\n    }\n    return async ()=>{\n        try {\n            sub.off(\"message\", onMessage);\n            try {\n                await sub.unsubscribe(channel);\n            } catch (e) {}\n            try {\n                await sub.quit();\n            } catch (e) {}\n        } catch (err) {\n            console.warn(`Failed to cleanly unsubscribe from Redis channel ${channel}`, err);\n        }\n    };\n}\n/**\r\n * Robust multi-channel subscription helper.\r\n */ async function subscribeToChannels(sub, channels, handler) {\n    if (!sub || !channels || channels.length === 0) return;\n    // ensure connection if possible (guard against duplicate connect calls)\n    try {\n        if (typeof sub.connect === \"function\") {\n            const status = sub.status;\n            if (status !== \"ready\" && status !== \"connecting\") {\n                await sub.connect().catch((err)=>{\n                    console.warn(\"subscribeToChannels: subscriber connect warning\", err);\n                });\n            } else {\n            // already connecting/ready, skip connect\n            }\n        }\n    } catch (e) {\n    // ignore connect errors\n    }\n    for (const ch of channels){\n        try {\n            if (typeof sub.subscribe === \"function\") {\n                await sub.subscribe(ch).catch((err)=>{\n                    console.warn(`subscribeToChannels: subscribe(${ch}) failed`, err);\n                });\n            } else {\n                await sub.subscribe(ch);\n            }\n        } catch (e) {\n            console.warn(`subscribe failed for channel ${ch}, will attempt fallback`, e);\n        }\n    }\n    // Attach 'message' listener\n    try {\n        if (typeof sub.on === \"function\") {\n            const onMsg = (a, b)=>{\n                if (typeof a === \"string\" && typeof b === \"string\") {\n                    handler(a, b);\n                } else if (typeof b === \"string\" && channels.includes(b)) {\n                    handler(b, a);\n                } else {\n                    handler(String(a), String(b));\n                }\n            };\n            sub.__subscribe_to_channels_on_message = onMsg;\n            sub.on(\"message\", onMsg);\n        }\n    } catch (e) {\n        console.warn(\"Fallback Redis message hook failed\", e);\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUFJLE9BQU9BLE1BQU0sWUFBWUwsU0FBU3RCLFFBQVEsQ0FBQzJCLElBQUk7b0JBQ3hEbkIsUUFBUW1CLEdBQUdEO2dCQUNiLE9BQU87b0JBQ0xsQixRQUFRb0IsT0FBT0YsSUFBSUUsT0FBT0Q7Z0JBQzVCO1lBQ0Y7WUFDQ2xCLElBQVlvQixrQ0FBa0MsR0FBR0o7WUFDbERoQixJQUFJUixFQUFFLENBQUMsV0FBV3dCO1FBQ3BCO0lBQ0YsRUFBRSxPQUFPMUIsR0FBRztRQUNWRyxRQUFRRyxJQUFJLENBQUMsc0NBQXNDTjtJQUNyRDtBQUNGIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vbWFya2V0aW5nLW12cC8uL2xpYi9yZWRpcy50cz81MWU5Il0sInNvdXJjZXNDb250ZW50IjpbIi8vIGxpYi9yZWRpcy50c1xyXG5pbXBvcnQgSU9SZWRpcyBmcm9tICdpb3JlZGlzJztcclxuXHJcbmV4cG9ydCBjb25zdCByZWRpcyA9IG5ldyBJT1JlZGlzKHByb2Nlc3MuZW52LlJFRElTX1VSTCB8fCAncmVkaXM6Ly8xMjcuMC4wLjE6NjM3OScsIHtcclxuICBtYXhSZXRyaWVzUGVyUmVxdWVzdDogbnVsbCxcclxuICBsYXp5Q29ubmVjdDogdHJ1ZSxcclxuICByZWNvbm5lY3RPbkVycm9yOiAoZXJyOiBhbnkpID0+IHtcclxuICAgIGNvbnN0IHRhcmdldEVycm9ycyA9IFsnUkVBRE9OTFknLCAnRUNPTk5SRVNFVCcsICdFVElNRURPVVQnXTtcclxuICAgIHRyeSB7XHJcbiAgICAgIGlmIChlcnIgJiYgdHlwZW9mIGVyci5tZXNzYWdlID09PSAnc3RyaW5nJykge1xyXG4gICAgICAgIHJldHVybiB0YXJnZXRFcnJvcnMuc29tZShlID0+IGVyci5tZXNzYWdlLmluY2x1ZGVzKGUpKTtcclxuICAgICAgfVxyXG4gICAgfSBjYXRjaCB7XHJcbiAgICAgIC8vIGZhbGwgdGhyb3VnaFxyXG4gICAgfVxyXG4gICAgcmV0dXJuIGZhbHNlO1xyXG4gIH0sXHJcbn0pO1xyXG5cclxucmVkaXMub24oJ2Nvbm5lY3QnLCAoKSA9PiBjb25zb2xlLmxvZygnUmVkaXMgY29ubmVjdGVkJykpO1xyXG5yZWRpcy5vbigncmVhZHknLCAoKSA9PiBjb25zb2xlLmxvZygnUmVkaXMgcmVhZHknKSk7XHJcbnJlZGlzLm9uKCdlcnJvcicsIChlcnIpID0+IGNvbnNvbGUuZXJyb3IoJ1JlZGlzIGVycm9yJywgZXJyKSk7XHJcbnJlZGlzLm9uKCdjbG9zZScsICgpID0+IGNvbnNvbGUud2FybignUmVkaXMgY29ubmVjdGlvbiBjbG9zZWQnKSk7XHJcbnJlZGlzLm9uKCdyZWNvbm5lY3RpbmcnLCAoKSA9PiBjb25zb2xlLmxvZygnUmVkaXMgcmVjb25uZWN0aW5nJykpO1xyXG5cclxuLyoqXHJcbiAqIFN1YnNjcmliZSB0byBhIHNpbmdsZSBSZWRpcyBjaGFubmVsIChpb3JlZGlzLXN0eWxlKS5cclxuICogUmV0dXJucyBhbiBhc3luYyB1bnN1YnNjcmliZSBmdW5jdGlvbi5cclxuICovXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBzdWJzY3JpYmUoY2hhbm5lbDogc3RyaW5nLCBoYW5kbGVyOiAoZGF0YTogYW55KSA9PiB2b2lkKTogUHJvbWlzZTwoKSA9PiBQcm9taXNlPHZvaWQ+PiB7XHJcbiAgY29uc3Qgc3ViID0gcmVkaXMuZHVwbGljYXRlKCk7XHJcblxyXG4gIGNvbnN0IG9uTWVzc2FnZSA9IChtc2dDaGFubmVsOiBzdHJpbmcsIG1lc3NhZ2U6IHN0cmluZykgPT4ge1xyXG4gICAgaWYgKG1zZ0NoYW5uZWwgIT09IGNoYW5uZWwpIHJldHVybjtcclxuICAgIHRyeSB7XHJcbiAgICAgIGhhbmRsZXIoSlNPTi5wYXJzZShtZXNzYWdlKSk7XHJcbiAgICB9IGNhdGNoIHtcclxuICAgICAgaGFuZGxlcihtZXNzYWdlKTtcclxuICAgIH1cclxuICB9O1xyXG5cclxuICBzdWIub24oJ2Vycm9yJywgKGVycjogYW55KSA9PiB7XHJcbiAgICBjb25zb2xlLmVycm9yKGBSZWRpcyBzdWJzY3JpYmVyIGVycm9yIGZvciBjaGFubmVsICR7Y2hhbm5lbH1gLCBlcnIpO1xyXG4gIH0pO1xyXG5cclxuICBzdWIub24oJ21lc3NhZ2UnLCBvbk1lc3NhZ2UpO1xyXG5cclxuICB0cnkge1xyXG4gICAgLy8gY29ubmVjdCBvbmx5IGlmIG5vdCBhbHJlYWR5IGNvbm5lY3RpbmcvcmVhZHlcclxuICAgIHRyeSB7XHJcbiAgICAgIGlmICh0eXBlb2YgKHN1YiBhcyBhbnkpLmNvbm5lY3QgPT09ICdmdW5jdGlvbicpIHtcclxuICAgICAgICBjb25zdCBzdGF0dXMgPSAoc3ViIGFzIGFueSkuc3RhdHVzO1xyXG4gICAgICAgIGlmIChzdGF0dXMgIT09ICdyZWFkeScgJiYgc3RhdHVzICE9PSAnY29ubmVjdGluZycpIHtcclxuICAgICAgICAgIGF3YWl0IChzdWIgYXMgYW55KS5jb25uZWN0KCkuY2F0Y2goKGVycjogYW55KSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUud2FybignU3Vic2NyaWJlciBjb25uZWN0IGVycm9yIChjb250aW51aW5nKTonLCBlcnIpO1xyXG4gICAgICAgICAgfSk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgIC8vIGFscmVhZHkgY29ubmVjdGluZy9yZWFkeSDigJQgc2tpcCBjb25uZWN0XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICB9IGNhdGNoIChlKSB7XHJcbiAgICAgIGNvbnNvbGUud2FybignU3Vic2NyaWJlciBjb25uZWN0IGd1YXJkIGVycm9yJywgZSk7XHJcbiAgICB9XHJcblxyXG4gICAgYXdhaXQgKHN1YiBhcyBhbnkpLnN1YnNjcmliZShjaGFubmVsKS5jYXRjaCgoZXJyOiBhbnkpID0+IHtcclxuICAgICAgY29uc29sZS53YXJuKGBzdWJzY3JpYmUoJHtjaGFubmVsfSkgZmFpbGVkYCwgZXJyKTtcclxuICAgIH0pO1xyXG4gIH0gY2F0Y2ggKGVycikge1xyXG4gICAgY29uc29sZS5lcnJvcihgRmFpbGVkIHRvIHN1YnNjcmliZSB0byBSZWRpcyBjaGFubmVsICR7Y2hhbm5lbH1gLCBlcnIpO1xyXG4gIH1cclxuXHJcbiAgcmV0dXJuIGFzeW5jICgpID0+IHtcclxuICAgIHRyeSB7XHJcbiAgICAgIHN1Yi5vZmYoJ21lc3NhZ2UnLCBvbk1lc3NhZ2UpO1xyXG4gICAgICB0cnkgeyBhd2FpdCAoc3ViIGFzIGFueSkudW5zdWJzY3JpYmUoY2hhbm5lbCk7IH0gY2F0Y2ggKGUpIHt9XHJcbiAgICAgIHRyeSB7IGF3YWl0IChzdWIgYXMgYW55KS5xdWl0KCk7IH0gY2F0Y2ggKGUpIHt9XHJcbiAgICB9IGNhdGNoIChlcnIpIHtcclxuICAgICAgY29uc29sZS53YXJuKGBGYWlsZWQgdG8gY2xlYW5seSB1bnN1YnNjcmliZSBmcm9tIFJlZGlzIGNoYW5uZWwgJHtjaGFubmVsfWAsIGVycik7XHJcbiAgICB9XHJcbiAgfTtcclxufVxyXG5cclxuLyoqXHJcbiAqIFJvYnVzdCBtdWx0aS1jaGFubmVsIHN1YnNjcmlwdGlvbiBoZWxwZXIuXHJcbiAqL1xyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gc3Vic2NyaWJlVG9DaGFubmVscyhcclxuICBzdWI6IGFueSxcclxuICBjaGFubmVsczogc3RyaW5nW10sXHJcbiAgaGFuZGxlcjogKGNoYW5uZWw6IHN0cmluZywgbWVzc2FnZTogc3RyaW5nKSA9PiB2b2lkXHJcbik6IFByb21pc2U8dm9pZD4ge1xyXG4gIGlmICghc3ViIHx8ICFjaGFubmVscyB8fCBjaGFubmVscy5sZW5ndGggPT09IDApIHJldHVybjtcclxuXHJcbiAgLy8gZW5zdXJlIGNvbm5lY3Rpb24gaWYgcG9zc2libGUgKGd1YXJkIGFnYWluc3QgZHVwbGljYXRlIGNvbm5lY3QgY2FsbHMpXHJcbiAgdHJ5IHtcclxuICAgIGlmICh0eXBlb2Ygc3ViLmNvbm5lY3QgPT09ICdmdW5jdGlvbicpIHtcclxuICAgICAgY29uc3Qgc3RhdHVzID0gKHN1YiBhcyBhbnkpLnN0YXR1cztcclxuICAgICAgaWYgKHN0YXR1cyAhPT0gJ3JlYWR5JyAmJiBzdGF0dXMgIT09ICdjb25uZWN0aW5nJykge1xyXG4gICAgICAgIGF3YWl0IHN1Yi5jb25uZWN0KCkuY2F0Y2goKGVycjogYW55KSA9PiB7XHJcbiAgICAgICAgICBjb25zb2xlLndhcm4oJ3N1YnNjcmliZVRvQ2hhbm5lbHM6IHN1YnNjcmliZXIgY29ubmVjdCB3YXJuaW5nJywgZXJyKTtcclxuICAgICAgICB9KTtcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICAvLyBhbHJlYWR5IGNvbm5lY3RpbmcvcmVhZHksIHNraXAgY29ubmVjdFxyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgfSBjYXRjaCAoZSkge1xyXG4gICAgLy8gaWdub3JlIGNvbm5lY3QgZXJyb3JzXHJcbiAgfVxyXG5cclxuICBmb3IgKGNvbnN0IGNoIG9mIGNoYW5uZWxzKSB7XHJcbiAgICB0cnkge1xyXG4gICAgICBpZiAodHlwZW9mIHN1Yi5zdWJzY3JpYmUgPT09ICdmdW5jdGlvbicpIHtcclxuICAgICAgICBhd2FpdCBzdWIuc3Vic2NyaWJlKGNoKS5jYXRjaCgoZXJyOiBhbnkpID0+IHtcclxuICAgICAgICAgIGNvbnNvbGUud2Fybihgc3Vic2NyaWJlVG9DaGFubmVsczogc3Vic2NyaWJlKCR7Y2h9KSBmYWlsZWRgLCBlcnIpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIGF3YWl0IChzdWIgYXMgYW55KS5zdWJzY3JpYmUoY2gpO1xyXG4gICAgICB9XHJcbiAgICB9IGNhdGNoIChlKSB7XHJcbiAgICAgIGNvbnNvbGUud2Fybihgc3Vic2NyaWJlIGZhaWxlZCBmb3IgY2hhbm5lbCAke2NofSwgd2lsbCBhdHRlbXB0IGZhbGxiYWNrYCwgZSk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICAvLyBBdHRhY2ggJ21lc3NhZ2UnIGxpc3RlbmVyXHJcbiAgdHJ5IHtcclxuICAgIGlmICh0eXBlb2Ygc3ViLm9uID09PSAnZnVuY3Rpb24nKSB7XHJcbiAgICAgIGNvbnN0IG9uTXNnID0gKGE6IGFueSwgYjogYW55KSA9PiB7XHJcbiAgICAgICAgaWYgKHR5cGVvZiBhID09PSAnc3RyaW5nJyAmJiB0eXBlb2YgYiA9PT0gJ3N0cmluZycpIHtcclxuICAgICAgICAgIGhhbmRsZXIoYSwgYik7XHJcbiAgICAgICAgfSBlbHNlIGlmICh0eXBlb2YgYiA9PT0gJ3N0cmluZycgJiYgY2hhbm5lbHMuaW5jbHVkZXMoYikpIHtcclxuICAgICAgICAgIGhhbmRsZXIoYiwgYSk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgIGhhbmRsZXIoU3RyaW5nKGEpLCBTdHJpbmcoYikpO1xyXG4gICAgICAgIH1cclxuICAgICAgfTtcclxuICAgICAgKHN1YiBhcyBhbnkpLl9fc3Vic2NyaWJlX3RvX2NoYW5uZWxzX29uX21lc3NhZ2UgPSBvbk1zZztcclxuICAgICAgc3ViLm9uKCdtZXNzYWdlJywgb25Nc2cpO1xyXG4gICAgfVxyXG4gIH0gY2F0Y2ggKGUpIHtcclxuICAgIGNvbnNvbGUud2FybignRmFsbGJhY2sgUmVkaXMgbWVzc2FnZSBob29rIGZhaWxlZCcsIGUpO1xyXG4gIH1cclxufVxyXG4iXSwibmFtZXMiOlsiSU9SZWRpcyIsInJlZGlzIiwicHJvY2VzcyIsImVudiIsIlJFRElTX1VSTCIsIm1heFJldHJpZXNQZXJSZXF1ZXN0IiwibGF6eUNvbm5lY3QiLCJyZWNvbm5lY3RPbkVycm9yIiwiZXJyIiwidGFyZ2V0RXJyb3JzIiwibWVzc2FnZSIsInNvbWUiLCJlIiwiaW5jbHVkZXMiLCJvbiIsImNvbnNvbGUiLCJsb2ciLCJlcnJvciIsIndhcm4iLCJzdWJzY3JpYmUiLCJjaGFubmVsIiwiaGFuZGxlciIsInN1YiIsImR1cGxpY2F0ZSIsIm9uTWVzc2FnZSIsIm1zZ0NoYW5uZWwiLCJKU09OIiwicGFyc2UiLCJjb25uZWN0Iiwic3RhdHVzIiwiY2F0Y2giLCJvZmYiLCJ1bnN1YnNjcmliZSIsInF1aXQiLCJzdWJzY3JpYmVUb0NoYW5uZWxzIiwiY2hhbm5lbHMiLCJsZW5ndGgiLCJjaCIsIm9uTXNnIiwiYSIsImIiLCJTdHJpbmciLCJfX3N1YnNjcmliZV90b19jaGFubmVsc19vbl9tZXNzYWdlIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(api)/./lib/redis.ts\n");

/***/ }),

/***/ "(api)/./pages/api/campaign/[id]/events.ts":
/*!*******************************************!*\
  !*** ./pages/api/campaign/[id]/events.ts ***!
  \*******************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (/* binding */ handler)\n/* harmony export */ });\n/* harmony import */ var _lib_redis__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../../lib/redis */ \"(api)/./lib/redis.ts\");\n// pages/api/campaign/[id]/events.ts\n\n/**\r\n * SSE endpoint that subscribes to Redis channels and forwards events to clients.\r\n * Forwards campaign-level events as \"campaign\" and contact-level as \"contact\".\r\n */ async function handler(req, res) {\n    const { id } = req.query;\n    if (!id || typeof id !== \"string\") {\n        res.status(400).end(\"Invalid campaign id\");\n        return;\n    }\n    // SSE headers\n    res.setHeader(\"Content-Type\", \"text/event-stream\");\n    res.setHeader(\"Cache-Control\", \"no-cache, no-transform\");\n    res.setHeader(\"Connection\", \"keep-alive\");\n    res.setHeader(\"Access-Control-Allow-Origin\", \"*\");\n    try {\n        res.flushHeaders?.();\n    } catch  {}\n    // Duplicate Redis client for pub/sub\n    const sub = _lib_redis__WEBPACK_IMPORTED_MODULE_0__.redis.duplicate();\n    try {\n        // try to connect (subscribeToChannels has its own guard)\n        await sub.connect().catch((err)=>{\n            // connect may already be in-progress; ignore\n            // but log for debugging\n            if (err && String(err).includes(\"already connecting\")) {\n                console.warn(\"subscribe: sub.connect already connecting — continuing\");\n            } else {\n                console.warn(\"subscribe: sub.connect failed (continuing)\", err);\n            }\n        });\n    } catch (err) {\n        console.error(\"Failed to connect redis subscriber\", err);\n        res.write(`event: error\\n`);\n        res.write(`data: ${JSON.stringify({\n            error: \"redis-connect-failed\"\n        })}\\n\\n`);\n        res.end();\n        return;\n    }\n    const channels = [\n        `campaign:${id}:contact_update`,\n        `campaign:${id}:events`,\n        \"campaign:new\"\n    ];\n    // SSE helper\n    function writeEvent(eventName, payload) {\n        try {\n            const data = JSON.stringify(payload);\n            res.write(`event: ${eventName}\\n`);\n            res.write(`data: ${data}\\n\\n`);\n            try {\n                res.flush?.();\n            } catch  {}\n        } catch (e) {\n            console.warn(\"Failed to write SSE event\", e);\n        }\n    }\n    // Standardized message handler\n    const messageHandler = (channel, message)=>{\n        try {\n            let payload = null;\n            try {\n                payload = typeof message === \"string\" ? JSON.parse(message) : message;\n            } catch  {\n                payload = {\n                    raw: String(message)\n                };\n            }\n            console.log(\"[SSE] redis message\", channel, message);\n            if (channel === \"campaign:new\") {\n                writeEvent(\"campaign\", payload);\n            } else if (channel.endsWith(\":contact_update\")) {\n                writeEvent(\"contact\", payload);\n            } else {\n                // generic events channel\n                writeEvent(\"campaign_event\", {\n                    channel,\n                    payload\n                });\n            }\n        } catch (e) {\n            console.warn(\"messageHandler error\", e);\n        }\n    };\n    // Use helper from lib/redis for robust subscription\n    try {\n        await (0,_lib_redis__WEBPACK_IMPORTED_MODULE_0__.subscribeToChannels)(sub, channels, messageHandler);\n    } catch (e) {\n        console.error(\"Failed to set up Redis subscriptions\", e);\n        writeEvent(\"error\", {\n            error: \"subscribe-failed\"\n        });\n    }\n    // Heartbeat\n    const heartbeatMs = 15000;\n    const heartbeat = setInterval(()=>{\n        try {\n            writeEvent(\"ping\", {\n                ts: Date.now()\n            });\n        } catch  {}\n    }, heartbeatMs);\n    // Cleanup on close\n    req.on(\"close\", async ()=>{\n        clearInterval(heartbeat);\n        try {\n            // remove our message handler if present\n            if (sub.__subscribe_to_channels_on_message) {\n                try {\n                    sub.off(\"message\", sub.__subscribe_to_channels_on_message);\n                } catch  {}\n            }\n            try {\n                await sub.unsubscribe(channels);\n            } catch  {}\n            try {\n                await sub.quit();\n            } catch  {}\n        } catch (e) {\n            console.warn(\"Error during SSE cleanup\", e);\n        }\n        try {\n            res.end();\n        } catch  {}\n    });\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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O0lBQ0Y7SUFFQSxvREFBb0Q7SUFDcEQsSUFBSTtRQUNGLE1BQU03QiwrREFBbUJBLENBQUNVLEtBQUthLFVBQVVPO0lBQzNDLEVBQUUsT0FBT0QsR0FBRztRQUNWWixRQUFRRSxLQUFLLENBQUMsd0NBQXdDVTtRQUN0REwsV0FBVyxTQUFTO1lBQUVMLE9BQU87UUFBbUI7SUFDbEQ7SUFFQSxZQUFZO0lBQ1osTUFBTWtCLGNBQWM7SUFDcEIsTUFBTUMsWUFBWUMsWUFBWTtRQUM1QixJQUFJO1lBQ0ZmLFdBQVcsUUFBUTtnQkFBRWdCLElBQUlDLEtBQUtDLEdBQUc7WUFBRztRQUN0QyxFQUFFLE9BQU0sQ0FBQztJQUNYLEdBQUdMO0lBRUgsbUJBQW1CO0lBQ25CbkMsSUFBSXlDLEVBQUUsQ0FBQyxTQUFTO1FBQ2RDLGNBQWNOO1FBQ2QsSUFBSTtZQUNGLHdDQUF3QztZQUN4QyxJQUFJLElBQWFPLGtDQUFrQyxFQUFFO2dCQUNuRCxJQUFJO29CQUFFbkMsSUFBSW9DLEdBQUcsQ0FBQyxXQUFXLElBQWFELGtDQUFrQztnQkFBRyxFQUFFLE9BQU0sQ0FBQztZQUN0RjtZQUNBLElBQUk7Z0JBQUUsTUFBTW5DLElBQUlxQyxXQUFXLENBQUN4QjtZQUFXLEVBQUUsT0FBTSxDQUFDO1lBQ2hELElBQUk7Z0JBQUUsTUFBTWIsSUFBSXNDLElBQUk7WUFBSSxFQUFFLE9BQU0sQ0FBQztRQUNuQyxFQUFFLE9BQU9uQixHQUFHO1lBQ1ZaLFFBQVFDLElBQUksQ0FBQyw0QkFBNEJXO1FBQzNDO1FBQ0EsSUFBSTtZQUFFMUIsSUFBSUksR0FBRztRQUFJLEVBQUUsT0FBTSxDQUFDO0lBQzVCO0FBQ0YiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9tYXJrZXRpbmctbXZwLy4vcGFnZXMvYXBpL2NhbXBhaWduL1tpZF0vZXZlbnRzLnRzPzdhNmQiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gcGFnZXMvYXBpL2NhbXBhaWduL1tpZF0vZXZlbnRzLnRzXHJcbmltcG9ydCB0eXBlIHsgTmV4dEFwaVJlcXVlc3QsIE5leHRBcGlSZXNwb25zZSB9IGZyb20gJ25leHQnO1xyXG5pbXBvcnQgeyByZWRpcywgc3Vic2NyaWJlVG9DaGFubmVscyB9IGZyb20gJy4uLy4uLy4uLy4uL2xpYi9yZWRpcyc7XHJcblxyXG4vKipcclxuICogU1NFIGVuZHBvaW50IHRoYXQgc3Vic2NyaWJlcyB0byBSZWRpcyBjaGFubmVscyBhbmQgZm9yd2FyZHMgZXZlbnRzIHRvIGNsaWVudHMuXHJcbiAqIEZvcndhcmRzIGNhbXBhaWduLWxldmVsIGV2ZW50cyBhcyBcImNhbXBhaWduXCIgYW5kIGNvbnRhY3QtbGV2ZWwgYXMgXCJjb250YWN0XCIuXHJcbiAqL1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgYXN5bmMgZnVuY3Rpb24gaGFuZGxlcihyZXE6IE5leHRBcGlSZXF1ZXN0LCByZXM6IE5leHRBcGlSZXNwb25zZSkge1xyXG4gIGNvbnN0IHsgaWQgfSA9IHJlcS5xdWVyeTtcclxuICBpZiAoIWlkIHx8IHR5cGVvZiBpZCAhPT0gJ3N0cmluZycpIHtcclxuICAgIHJlcy5zdGF0dXMoNDAwKS5lbmQoJ0ludmFsaWQgY2FtcGFpZ24gaWQnKTtcclxuICAgIHJldHVybjtcclxuICB9XHJcblxyXG4gIC8vIFNTRSBoZWFkZXJzXHJcbiAgcmVzLnNldEhlYWRlcignQ29udGVudC1UeXBlJywgJ3RleHQvZXZlbnQtc3RyZWFtJyk7XHJcbiAgcmVzLnNldEhlYWRlcignQ2FjaGUtQ29udHJvbCcsICduby1jYWNoZSwgbm8tdHJhbnNmb3JtJyk7XHJcbiAgcmVzLnNldEhlYWRlcignQ29ubmVjdGlvbicsICdrZWVwLWFsaXZlJyk7XHJcbiAgcmVzLnNldEhlYWRlcignQWNjZXNzLUNvbnRyb2wtQWxsb3ctT3JpZ2luJywgJyonKTtcclxuXHJcbiAgdHJ5IHtcclxuICAgIHJlcy5mbHVzaEhlYWRlcnM/LigpO1xyXG4gIH0gY2F0Y2gge31cclxuXHJcbiAgLy8gRHVwbGljYXRlIFJlZGlzIGNsaWVudCBmb3IgcHViL3N1YlxyXG4gIGNvbnN0IHN1YiA9IChyZWRpcyBhcyBhbnkpLmR1cGxpY2F0ZSgpO1xyXG5cclxuICB0cnkge1xyXG4gICAgLy8gdHJ5IHRvIGNvbm5lY3QgKHN1YnNjcmliZVRvQ2hhbm5lbHMgaGFzIGl0cyBvd24gZ3VhcmQpXHJcbiAgICBhd2FpdCBzdWIuY29ubmVjdCgpLmNhdGNoKChlcnI6IGFueSkgPT4ge1xyXG4gICAgICAvLyBjb25uZWN0IG1heSBhbHJlYWR5IGJlIGluLXByb2dyZXNzOyBpZ25vcmVcclxuICAgICAgLy8gYnV0IGxvZyBmb3IgZGVidWdnaW5nXHJcbiAgICAgIGlmIChlcnIgJiYgU3RyaW5nKGVycikuaW5jbHVkZXMoJ2FscmVhZHkgY29ubmVjdGluZycpKSB7XHJcbiAgICAgICAgY29uc29sZS53YXJuKCdzdWJzY3JpYmU6IHN1Yi5jb25uZWN0IGFscmVhZHkgY29ubmVjdGluZyDigJQgY29udGludWluZycpO1xyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIGNvbnNvbGUud2Fybignc3Vic2NyaWJlOiBzdWIuY29ubmVjdCBmYWlsZWQgKGNvbnRpbnVpbmcpJywgZXJyKTtcclxuICAgICAgfVxyXG4gICAgfSk7XHJcbiAgfSBjYXRjaCAoZXJyKSB7XHJcbiAgICBjb25zb2xlLmVycm9yKCdGYWlsZWQgdG8gY29ubmVjdCByZWRpcyBzdWJzY3JpYmVyJywgZXJyKTtcclxuICAgIHJlcy53cml0ZShgZXZlbnQ6IGVycm9yXFxuYCk7XHJcbiAgICByZXMud3JpdGUoYGRhdGE6ICR7SlNPTi5zdHJpbmdpZnkoeyBlcnJvcjogJ3JlZGlzLWNvbm5lY3QtZmFpbGVkJyB9KX1cXG5cXG5gKTtcclxuICAgIHJlcy5lbmQoKTtcclxuICAgIHJldHVybjtcclxuICB9XHJcblxyXG4gIGNvbnN0IGNoYW5uZWxzID0gW1xyXG4gICAgYGNhbXBhaWduOiR7aWR9OmNvbnRhY3RfdXBkYXRlYCxcclxuICAgIGBjYW1wYWlnbjoke2lkfTpldmVudHNgLFxyXG4gICAgJ2NhbXBhaWduOm5ldycsXHJcbiAgXTtcclxuXHJcbiAgLy8gU1NFIGhlbHBlclxyXG4gIGZ1bmN0aW9uIHdyaXRlRXZlbnQoZXZlbnROYW1lOiBzdHJpbmcsIHBheWxvYWQ6IHVua25vd24pIHtcclxuICAgIHRyeSB7XHJcbiAgICAgIGNvbnN0IGRhdGEgPSBKU09OLnN0cmluZ2lmeShwYXlsb2FkKTtcclxuICAgICAgcmVzLndyaXRlKGBldmVudDogJHtldmVudE5hbWV9XFxuYCk7XHJcbiAgICAgIHJlcy53cml0ZShgZGF0YTogJHtkYXRhfVxcblxcbmApO1xyXG4gICAgICB0cnkgeyAocmVzIGFzIGFueSkuZmx1c2g/LigpOyB9IGNhdGNoIHt9XHJcbiAgICB9IGNhdGNoIChlKSB7XHJcbiAgICAgIGNvbnNvbGUud2FybignRmFpbGVkIHRvIHdyaXRlIFNTRSBldmVudCcsIGUpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgLy8gU3RhbmRhcmRpemVkIG1lc3NhZ2UgaGFuZGxlclxyXG4gIGNvbnN0IG1lc3NhZ2VIYW5kbGVyID0gKGNoYW5uZWw6IHN0cmluZywgbWVzc2FnZTogc3RyaW5nKSA9PiB7XHJcbiAgICB0cnkge1xyXG4gICAgICBsZXQgcGF5bG9hZDogYW55ID0gbnVsbDtcclxuICAgICAgdHJ5IHtcclxuICAgICAgICBwYXlsb2FkID0gdHlwZW9mIG1lc3NhZ2UgPT09ICdzdHJpbmcnID8gSlNPTi5wYXJzZShtZXNzYWdlKSA6IG1lc3NhZ2U7XHJcbiAgICAgIH0gY2F0Y2gge1xyXG4gICAgICAgIHBheWxvYWQgPSB7IHJhdzogU3RyaW5nKG1lc3NhZ2UpIH07XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIGNvbnNvbGUubG9nKCdbU1NFXSByZWRpcyBtZXNzYWdlJywgY2hhbm5lbCwgbWVzc2FnZSk7XHJcblxyXG4gICAgICBpZiAoY2hhbm5lbCA9PT0gJ2NhbXBhaWduOm5ldycpIHtcclxuICAgICAgICB3cml0ZUV2ZW50KCdjYW1wYWlnbicsIHBheWxvYWQpO1xyXG4gICAgICB9IGVsc2UgaWYgKGNoYW5uZWwuZW5kc1dpdGgoJzpjb250YWN0X3VwZGF0ZScpKSB7XHJcbiAgICAgICAgd3JpdGVFdmVudCgnY29udGFjdCcsIHBheWxvYWQpO1xyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIC8vIGdlbmVyaWMgZXZlbnRzIGNoYW5uZWxcclxuICAgICAgICB3cml0ZUV2ZW50KCdjYW1wYWlnbl9ldmVudCcsIHsgY2hhbm5lbCwgcGF5bG9hZCB9KTtcclxuICAgICAgfVxyXG4gICAgfSBjYXRjaCAoZSkge1xyXG4gICAgICBjb25zb2xlLndhcm4oJ21lc3NhZ2VIYW5kbGVyIGVycm9yJywgZSk7XHJcbiAgICB9XHJcbiAgfTtcclxuXHJcbiAgLy8gVXNlIGhlbHBlciBmcm9tIGxpYi9yZWRpcyBmb3Igcm9idXN0IHN1YnNjcmlwdGlvblxyXG4gIHRyeSB7XHJcbiAgICBhd2FpdCBzdWJzY3JpYmVUb0NoYW5uZWxzKHN1YiwgY2hhbm5lbHMsIG1lc3NhZ2VIYW5kbGVyKTtcclxuICB9IGNhdGNoIChlKSB7XHJcbiAgICBjb25zb2xlLmVycm9yKCdGYWlsZWQgdG8gc2V0IHVwIFJlZGlzIHN1YnNjcmlwdGlvbnMnLCBlKTtcclxuICAgIHdyaXRlRXZlbnQoJ2Vycm9yJywgeyBlcnJvcjogJ3N1YnNjcmliZS1mYWlsZWQnIH0pO1xyXG4gIH1cclxuXHJcbiAgLy8gSGVhcnRiZWF0XHJcbiAgY29uc3QgaGVhcnRiZWF0TXMgPSAxNTAwMDtcclxuICBjb25zdCBoZWFydGJlYXQgPSBzZXRJbnRlcnZhbCgoKSA9PiB7XHJcbiAgICB0cnkge1xyXG4gICAgICB3cml0ZUV2ZW50KCdwaW5nJywgeyB0czogRGF0ZS5ub3coKSB9KTtcclxuICAgIH0gY2F0Y2gge31cclxuICB9LCBoZWFydGJlYXRNcyk7XHJcblxyXG4gIC8vIENsZWFudXAgb24gY2xvc2VcclxuICByZXEub24oJ2Nsb3NlJywgYXN5bmMgKCkgPT4ge1xyXG4gICAgY2xlYXJJbnRlcnZhbChoZWFydGJlYXQpO1xyXG4gICAgdHJ5IHtcclxuICAgICAgLy8gcmVtb3ZlIG91ciBtZXNzYWdlIGhhbmRsZXIgaWYgcHJlc2VudFxyXG4gICAgICBpZiAoKHN1YiBhcyBhbnkpLl9fc3Vic2NyaWJlX3RvX2NoYW5uZWxzX29uX21lc3NhZ2UpIHtcclxuICAgICAgICB0cnkgeyBzdWIub2ZmKCdtZXNzYWdlJywgKHN1YiBhcyBhbnkpLl9fc3Vic2NyaWJlX3RvX2NoYW5uZWxzX29uX21lc3NhZ2UpOyB9IGNhdGNoIHt9XHJcbiAgICAgIH1cclxuICAgICAgdHJ5IHsgYXdhaXQgc3ViLnVuc3Vic2NyaWJlKGNoYW5uZWxzKTsgfSBjYXRjaCB7fVxyXG4gICAgICB0cnkgeyBhd2FpdCBzdWIucXVpdCgpOyB9IGNhdGNoIHt9XHJcbiAgICB9IGNhdGNoIChlKSB7XHJcbiAgICAgIGNvbnNvbGUud2FybignRXJyb3IgZHVyaW5nIFNTRSBjbGVhbnVwJywgZSk7XHJcbiAgICB9XHJcbiAgICB0cnkgeyByZXMuZW5kKCk7IH0gY2F0Y2gge31cclxuICB9KTtcclxufVxyXG4iXSwibmFtZXMiOlsicmVkaXMiLCJzdWJzY3JpYmVUb0NoYW5uZWxzIiwiaGFuZGxlciIsInJlcSIsInJlcyIsImlkIiwicXVlcnkiLCJzdGF0dXMiLCJlbmQiLCJzZXRIZWFkZXIiLCJmbHVzaEhlYWRlcnMiLCJzdWIiLCJkdXBsaWNhdGUiLCJjb25uZWN0IiwiY2F0Y2giLCJlcnIiLCJTdHJpbmciLCJpbmNsdWRlcyIsImNvbnNvbGUiLCJ3YXJuIiwiZXJyb3IiLCJ3cml0ZSIsIkpTT04iLCJzdHJpbmdpZnkiLCJjaGFubmVscyIsIndyaXRlRXZlbnQiLCJldmVudE5hbWUiLCJwYXlsb2FkIiwiZGF0YSIsImZsdXNoIiwiZSIsIm1lc3NhZ2VIYW5kbGVyIiwiY2hhbm5lbCIsIm1lc3NhZ2UiLCJwYXJzZSIsInJhdyIsImxvZyIsImVuZHNXaXRoIiwiaGVhcnRiZWF0TXMiLCJoZWFydGJlYXQiLCJzZXRJbnRlcnZhbCIsInRzIiwiRGF0ZSIsIm5vdyIsIm9uIiwiY2xlYXJJbnRlcnZhbCIsIl9fc3Vic2NyaWJlX3RvX2NoYW5uZWxzX29uX21lc3NhZ2UiLCJvZmYiLCJ1bnN1YnNjcmliZSIsInF1aXQiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(api)/./pages/api/campaign/[id]/events.ts\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../../webpack-api-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next"], () => (__webpack_exec__("(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fcampaign%2F%5Bid%5D%2Fevents&preferredRegion=&absolutePagePath=.%2Fpages%5Capi%5Ccampaign%5C%5Bid%5D%5Cevents.ts&middlewareConfigBase64=e30%3D!")));
module.exports = __webpack_exports__;

})();