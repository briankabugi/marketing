"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "pages/api/campaign/[id]/contacts";
exports.ids = ["pages/api/campaign/[id]/contacts"];
exports.modules = {

/***/ "ioredis":
/*!**************************!*\
  !*** external "ioredis" ***!
  \**************************/
/***/ ((module) => {

module.exports = require("ioredis");

/***/ }),

/***/ "mongodb":
/*!**************************!*\
  !*** external "mongodb" ***!
  \**************************/
/***/ ((module) => {

module.exports = require("mongodb");

/***/ }),

/***/ "next/dist/compiled/next-server/pages-api.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/pages-api.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/pages-api.runtime.dev.js");

/***/ }),

/***/ "(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fcampaign%2F%5Bid%5D%2Fcontacts&preferredRegion=&absolutePagePath=.%2Fpages%5Capi%5Ccampaign%5C%5Bid%5D%5Ccontacts.ts&middlewareConfigBase64=e30%3D!":
/*!******************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fcampaign%2F%5Bid%5D%2Fcontacts&preferredRegion=&absolutePagePath=.%2Fpages%5Capi%5Ccampaign%5C%5Bid%5D%5Ccontacts.ts&middlewareConfigBase64=e30%3D! ***!
  \******************************************************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   config: () => (/* binding */ config),\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__),\n/* harmony export */   routeModule: () => (/* binding */ routeModule)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/pages-api/module.compiled */ \"(api)/./node_modules/next/dist/server/future/route-modules/pages-api/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(api)/./node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/build/templates/helpers */ \"(api)/./node_modules/next/dist/build/templates/helpers.js\");\n/* harmony import */ var _pages_api_campaign_id_contacts_ts__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./pages\\api\\campaign\\[id]\\contacts.ts */ \"(api)/./pages/api/campaign/[id]/contacts.ts\");\n\n\n\n// Import the userland code.\n\n// Re-export the handler (should be the default export).\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__.hoist)(_pages_api_campaign_id_contacts_ts__WEBPACK_IMPORTED_MODULE_3__, \"default\"));\n// Re-export config.\nconst config = (0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__.hoist)(_pages_api_campaign_id_contacts_ts__WEBPACK_IMPORTED_MODULE_3__, \"config\");\n// Create and export the route module that will be consumed.\nconst routeModule = new next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__.PagesAPIRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.PAGES_API,\n        page: \"/api/campaign/[id]/contacts\",\n        pathname: \"/api/campaign/[id]/contacts\",\n        // The following aren't used in production.\n        bundlePath: \"\",\n        filename: \"\"\n    },\n    userland: _pages_api_campaign_id_contacts_ts__WEBPACK_IMPORTED_MODULE_3__\n});\n\n//# sourceMappingURL=pages-api.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LXJvdXRlLWxvYWRlci9pbmRleC5qcz9raW5kPVBBR0VTX0FQSSZwYWdlPSUyRmFwaSUyRmNhbXBhaWduJTJGJTVCaWQlNUQlMkZjb250YWN0cyZwcmVmZXJyZWRSZWdpb249JmFic29sdXRlUGFnZVBhdGg9LiUyRnBhZ2VzJTVDYXBpJTVDY2FtcGFpZ24lNUMlNUJpZCU1RCU1Q2NvbnRhY3RzLnRzJm1pZGRsZXdhcmVDb25maWdCYXNlNjQ9ZTMwJTNEISIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7OztBQUFzRztBQUN2QztBQUNMO0FBQzFEO0FBQ3NFO0FBQ3RFO0FBQ0EsaUVBQWUsd0VBQUssQ0FBQywrREFBUSxZQUFZLEVBQUM7QUFDMUM7QUFDTyxlQUFlLHdFQUFLLENBQUMsK0RBQVE7QUFDcEM7QUFDTyx3QkFBd0IsZ0hBQW1CO0FBQ2xEO0FBQ0EsY0FBYyx5RUFBUztBQUN2QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMLFlBQVk7QUFDWixDQUFDOztBQUVEIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vbWFya2V0aW5nLW12cC8/OThjZCJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBQYWdlc0FQSVJvdXRlTW9kdWxlIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvZnV0dXJlL3JvdXRlLW1vZHVsZXMvcGFnZXMtYXBpL21vZHVsZS5jb21waWxlZFwiO1xuaW1wb3J0IHsgUm91dGVLaW5kIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvZnV0dXJlL3JvdXRlLWtpbmRcIjtcbmltcG9ydCB7IGhvaXN0IH0gZnJvbSBcIm5leHQvZGlzdC9idWlsZC90ZW1wbGF0ZXMvaGVscGVyc1wiO1xuLy8gSW1wb3J0IHRoZSB1c2VybGFuZCBjb2RlLlxuaW1wb3J0ICogYXMgdXNlcmxhbmQgZnJvbSBcIi4vcGFnZXNcXFxcYXBpXFxcXGNhbXBhaWduXFxcXFtpZF1cXFxcY29udGFjdHMudHNcIjtcbi8vIFJlLWV4cG9ydCB0aGUgaGFuZGxlciAoc2hvdWxkIGJlIHRoZSBkZWZhdWx0IGV4cG9ydCkuXG5leHBvcnQgZGVmYXVsdCBob2lzdCh1c2VybGFuZCwgXCJkZWZhdWx0XCIpO1xuLy8gUmUtZXhwb3J0IGNvbmZpZy5cbmV4cG9ydCBjb25zdCBjb25maWcgPSBob2lzdCh1c2VybGFuZCwgXCJjb25maWdcIik7XG4vLyBDcmVhdGUgYW5kIGV4cG9ydCB0aGUgcm91dGUgbW9kdWxlIHRoYXQgd2lsbCBiZSBjb25zdW1lZC5cbmV4cG9ydCBjb25zdCByb3V0ZU1vZHVsZSA9IG5ldyBQYWdlc0FQSVJvdXRlTW9kdWxlKHtcbiAgICBkZWZpbml0aW9uOiB7XG4gICAgICAgIGtpbmQ6IFJvdXRlS2luZC5QQUdFU19BUEksXG4gICAgICAgIHBhZ2U6IFwiL2FwaS9jYW1wYWlnbi9baWRdL2NvbnRhY3RzXCIsXG4gICAgICAgIHBhdGhuYW1lOiBcIi9hcGkvY2FtcGFpZ24vW2lkXS9jb250YWN0c1wiLFxuICAgICAgICAvLyBUaGUgZm9sbG93aW5nIGFyZW4ndCB1c2VkIGluIHByb2R1Y3Rpb24uXG4gICAgICAgIGJ1bmRsZVBhdGg6IFwiXCIsXG4gICAgICAgIGZpbGVuYW1lOiBcIlwiXG4gICAgfSxcbiAgICB1c2VybGFuZFxufSk7XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPXBhZ2VzLWFwaS5qcy5tYXAiXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fcampaign%2F%5Bid%5D%2Fcontacts&preferredRegion=&absolutePagePath=.%2Fpages%5Capi%5Ccampaign%5C%5Bid%5D%5Ccontacts.ts&middlewareConfigBase64=e30%3D!\n");

/***/ }),

/***/ "(api)/./lib/mongo.ts":
/*!**********************!*\
  !*** ./lib/mongo.ts ***!
  \**********************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony import */ var mongodb__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! mongodb */ \"mongodb\");\n/* harmony import */ var mongodb__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(mongodb__WEBPACK_IMPORTED_MODULE_0__);\n// lib/mongo.ts\n\nconst uri = process.env.MONGODB_URI;\nif (!uri) throw new Error(\"MONGODB_URI not set\");\nlet client;\nlet clientPromise;\n// Retry logic in case MongoDB connection fails\nasync function connectWithRetry() {\n    const MAX_RETRIES = 5;\n    let attempts = 0;\n    let lastError = null;\n    while(attempts < MAX_RETRIES){\n        try {\n            const client = new mongodb__WEBPACK_IMPORTED_MODULE_0__.MongoClient(uri, {\n                maxPoolSize: 10,\n                serverSelectionTimeoutMS: 10000,\n                socketTimeoutMS: 45000\n            });\n            await client.connect();\n            return client;\n        } catch (err) {\n            lastError = err;\n            attempts++;\n            console.error(`MongoDB connection failed (attempt ${attempts}/${MAX_RETRIES}):`, err);\n            if (attempts < MAX_RETRIES) {\n                await new Promise((resolve)=>setTimeout(resolve, 5000)); // wait for 5 seconds before retrying\n            }\n        }\n    }\n    // After max retries, throw the last error encountered\n    throw lastError || new Error(\"MongoDB connection failed after maximum retry attempts\");\n}\nif (!global._mongoClientPromise) {\n    global._mongoClientPromise = connectWithRetry();\n    // Optional: log connection events\n    global._mongoClientPromise.then((client)=>{\n        client.on(\"serverOpening\", (event)=>console.log(\"MongoDB server opening\", event));\n        client.on(\"serverClosed\", (event)=>console.warn(\"MongoDB server closed\", event));\n        client.on(\"topologyClosed\", ()=>console.warn(\"MongoDB topology closed\"));\n        client.on(\"topologyOpening\", ()=>console.log(\"MongoDB topology opening\"));\n        client.on(\"error\", (err)=>console.error(\"MongoDB error\", err));\n    }).catch((err)=>{\n        console.error(\"MongoDB client failed to connect after retries\", err);\n    });\n}\nclientPromise = global._mongoClientPromise;\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (clientPromise);\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi9saWIvbW9uZ28udHMiLCJtYXBwaW5ncyI6Ijs7Ozs7O0FBQUEsZUFBZTtBQUN1QjtBQUV0QyxNQUFNQyxNQUFNQyxRQUFRQyxHQUFHLENBQUNDLFdBQVc7QUFDbkMsSUFBSSxDQUFDSCxLQUFLLE1BQU0sSUFBSUksTUFBTTtBQUUxQixJQUFJQztBQUNKLElBQUlDO0FBT0osK0NBQStDO0FBQy9DLGVBQWVDO0lBQ2IsTUFBTUMsY0FBYztJQUNwQixJQUFJQyxXQUFXO0lBQ2YsSUFBSUMsWUFBMEI7SUFFOUIsTUFBT0QsV0FBV0QsWUFBYTtRQUM3QixJQUFJO1lBQ0YsTUFBTUgsU0FBUyxJQUFJTixnREFBV0EsQ0FBQ0MsS0FBSztnQkFDbENXLGFBQWE7Z0JBQ2JDLDBCQUEwQjtnQkFDMUJDLGlCQUFpQjtZQUNuQjtZQUNBLE1BQU1SLE9BQU9TLE9BQU87WUFDcEIsT0FBT1Q7UUFDVCxFQUFFLE9BQU9VLEtBQVU7WUFDakJMLFlBQVlLO1lBQ1pOO1lBQ0FPLFFBQVFDLEtBQUssQ0FBQyxDQUFDLG1DQUFtQyxFQUFFUixTQUFTLENBQUMsRUFBRUQsWUFBWSxFQUFFLENBQUMsRUFBRU87WUFDakYsSUFBSU4sV0FBV0QsYUFBYTtnQkFDMUIsTUFBTSxJQUFJVSxRQUFRQyxDQUFBQSxVQUFXQyxXQUFXRCxTQUFTLFFBQVEscUNBQXFDO1lBQ2hHO1FBQ0Y7SUFDRjtJQUVBLHNEQUFzRDtJQUN0RCxNQUFNVCxhQUFhLElBQUlOLE1BQU07QUFDL0I7QUFFQSxJQUFJLENBQUNpQixPQUFPQyxtQkFBbUIsRUFBRTtJQUMvQkQsT0FBT0MsbUJBQW1CLEdBQUdmO0lBRTdCLGtDQUFrQztJQUNsQ2MsT0FBT0MsbUJBQW1CLENBQ3ZCQyxJQUFJLENBQUNsQixDQUFBQTtRQUNKQSxPQUFPbUIsRUFBRSxDQUFDLGlCQUFpQixDQUFDQyxRQUFVVCxRQUFRVSxHQUFHLENBQUMsMEJBQTBCRDtRQUM1RXBCLE9BQU9tQixFQUFFLENBQUMsZ0JBQWdCLENBQUNDLFFBQVVULFFBQVFXLElBQUksQ0FBQyx5QkFBeUJGO1FBQzNFcEIsT0FBT21CLEVBQUUsQ0FBQyxrQkFBa0IsSUFBTVIsUUFBUVcsSUFBSSxDQUFDO1FBQy9DdEIsT0FBT21CLEVBQUUsQ0FBQyxtQkFBbUIsSUFBTVIsUUFBUVUsR0FBRyxDQUFDO1FBQy9DckIsT0FBT21CLEVBQUUsQ0FBQyxTQUFTLENBQUNULE1BQVFDLFFBQVFDLEtBQUssQ0FBQyxpQkFBaUJGO0lBQzdELEdBQ0NhLEtBQUssQ0FBQ2IsQ0FBQUE7UUFDTEMsUUFBUUMsS0FBSyxDQUFDLGtEQUFrREY7SUFDbEU7QUFDSjtBQUVBVCxnQkFBZ0JlLE9BQU9DLG1CQUFtQjtBQUUxQyxpRUFBZWhCLGFBQWFBLEVBQUMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9tYXJrZXRpbmctbXZwLy4vbGliL21vbmdvLnRzPzU3ZmUiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gbGliL21vbmdvLnRzXHJcbmltcG9ydCB7IE1vbmdvQ2xpZW50IH0gZnJvbSAnbW9uZ29kYic7XHJcblxyXG5jb25zdCB1cmkgPSBwcm9jZXNzLmVudi5NT05HT0RCX1VSSTtcclxuaWYgKCF1cmkpIHRocm93IG5ldyBFcnJvcignTU9OR09EQl9VUkkgbm90IHNldCcpO1xyXG5cclxubGV0IGNsaWVudDogTW9uZ29DbGllbnQ7XHJcbmxldCBjbGllbnRQcm9taXNlOiBQcm9taXNlPE1vbmdvQ2xpZW50PjtcclxuXHJcbmRlY2xhcmUgZ2xvYmFsIHtcclxuICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tdmFyXHJcbiAgdmFyIF9tb25nb0NsaWVudFByb21pc2U6IFByb21pc2U8TW9uZ29DbGllbnQ+IHwgdW5kZWZpbmVkO1xyXG59XHJcblxyXG4vLyBSZXRyeSBsb2dpYyBpbiBjYXNlIE1vbmdvREIgY29ubmVjdGlvbiBmYWlsc1xyXG5hc3luYyBmdW5jdGlvbiBjb25uZWN0V2l0aFJldHJ5KCk6IFByb21pc2U8TW9uZ29DbGllbnQ+IHtcclxuICBjb25zdCBNQVhfUkVUUklFUyA9IDU7XHJcbiAgbGV0IGF0dGVtcHRzID0gMDtcclxuICBsZXQgbGFzdEVycm9yOiBFcnJvciB8IG51bGwgPSBudWxsO1xyXG5cclxuICB3aGlsZSAoYXR0ZW1wdHMgPCBNQVhfUkVUUklFUykge1xyXG4gICAgdHJ5IHtcclxuICAgICAgY29uc3QgY2xpZW50ID0gbmV3IE1vbmdvQ2xpZW50KHVyaSwge1xyXG4gICAgICAgIG1heFBvb2xTaXplOiAxMCxcclxuICAgICAgICBzZXJ2ZXJTZWxlY3Rpb25UaW1lb3V0TVM6IDEwMDAwLFxyXG4gICAgICAgIHNvY2tldFRpbWVvdXRNUzogNDUwMDAsXHJcbiAgICAgIH0pO1xyXG4gICAgICBhd2FpdCBjbGllbnQuY29ubmVjdCgpO1xyXG4gICAgICByZXR1cm4gY2xpZW50O1xyXG4gICAgfSBjYXRjaCAoZXJyOiBhbnkpIHtcclxuICAgICAgbGFzdEVycm9yID0gZXJyO1xyXG4gICAgICBhdHRlbXB0cysrO1xyXG4gICAgICBjb25zb2xlLmVycm9yKGBNb25nb0RCIGNvbm5lY3Rpb24gZmFpbGVkIChhdHRlbXB0ICR7YXR0ZW1wdHN9LyR7TUFYX1JFVFJJRVN9KTpgLCBlcnIpO1xyXG4gICAgICBpZiAoYXR0ZW1wdHMgPCBNQVhfUkVUUklFUykge1xyXG4gICAgICAgIGF3YWl0IG5ldyBQcm9taXNlKHJlc29sdmUgPT4gc2V0VGltZW91dChyZXNvbHZlLCA1MDAwKSk7IC8vIHdhaXQgZm9yIDUgc2Vjb25kcyBiZWZvcmUgcmV0cnlpbmdcclxuICAgICAgfVxyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgLy8gQWZ0ZXIgbWF4IHJldHJpZXMsIHRocm93IHRoZSBsYXN0IGVycm9yIGVuY291bnRlcmVkXHJcbiAgdGhyb3cgbGFzdEVycm9yIHx8IG5ldyBFcnJvcignTW9uZ29EQiBjb25uZWN0aW9uIGZhaWxlZCBhZnRlciBtYXhpbXVtIHJldHJ5IGF0dGVtcHRzJyk7XHJcbn1cclxuXHJcbmlmICghZ2xvYmFsLl9tb25nb0NsaWVudFByb21pc2UpIHtcclxuICBnbG9iYWwuX21vbmdvQ2xpZW50UHJvbWlzZSA9IGNvbm5lY3RXaXRoUmV0cnkoKTtcclxuICBcclxuICAvLyBPcHRpb25hbDogbG9nIGNvbm5lY3Rpb24gZXZlbnRzXHJcbiAgZ2xvYmFsLl9tb25nb0NsaWVudFByb21pc2VcclxuICAgIC50aGVuKGNsaWVudCA9PiB7XHJcbiAgICAgIGNsaWVudC5vbignc2VydmVyT3BlbmluZycsIChldmVudCkgPT4gY29uc29sZS5sb2coJ01vbmdvREIgc2VydmVyIG9wZW5pbmcnLCBldmVudCkpO1xyXG4gICAgICBjbGllbnQub24oJ3NlcnZlckNsb3NlZCcsIChldmVudCkgPT4gY29uc29sZS53YXJuKCdNb25nb0RCIHNlcnZlciBjbG9zZWQnLCBldmVudCkpO1xyXG4gICAgICBjbGllbnQub24oJ3RvcG9sb2d5Q2xvc2VkJywgKCkgPT4gY29uc29sZS53YXJuKCdNb25nb0RCIHRvcG9sb2d5IGNsb3NlZCcpKTtcclxuICAgICAgY2xpZW50Lm9uKCd0b3BvbG9neU9wZW5pbmcnLCAoKSA9PiBjb25zb2xlLmxvZygnTW9uZ29EQiB0b3BvbG9neSBvcGVuaW5nJykpO1xyXG4gICAgICBjbGllbnQub24oJ2Vycm9yJywgKGVycikgPT4gY29uc29sZS5lcnJvcignTW9uZ29EQiBlcnJvcicsIGVycikpO1xyXG4gICAgfSlcclxuICAgIC5jYXRjaChlcnIgPT4ge1xyXG4gICAgICBjb25zb2xlLmVycm9yKCdNb25nb0RCIGNsaWVudCBmYWlsZWQgdG8gY29ubmVjdCBhZnRlciByZXRyaWVzJywgZXJyKTtcclxuICAgIH0pO1xyXG59XHJcblxyXG5jbGllbnRQcm9taXNlID0gZ2xvYmFsLl9tb25nb0NsaWVudFByb21pc2U7XHJcblxyXG5leHBvcnQgZGVmYXVsdCBjbGllbnRQcm9taXNlOyJdLCJuYW1lcyI6WyJNb25nb0NsaWVudCIsInVyaSIsInByb2Nlc3MiLCJlbnYiLCJNT05HT0RCX1VSSSIsIkVycm9yIiwiY2xpZW50IiwiY2xpZW50UHJvbWlzZSIsImNvbm5lY3RXaXRoUmV0cnkiLCJNQVhfUkVUUklFUyIsImF0dGVtcHRzIiwibGFzdEVycm9yIiwibWF4UG9vbFNpemUiLCJzZXJ2ZXJTZWxlY3Rpb25UaW1lb3V0TVMiLCJzb2NrZXRUaW1lb3V0TVMiLCJjb25uZWN0IiwiZXJyIiwiY29uc29sZSIsImVycm9yIiwiUHJvbWlzZSIsInJlc29sdmUiLCJzZXRUaW1lb3V0IiwiZ2xvYmFsIiwiX21vbmdvQ2xpZW50UHJvbWlzZSIsInRoZW4iLCJvbiIsImV2ZW50IiwibG9nIiwid2FybiIsImNhdGNoIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(api)/./lib/mongo.ts\n");

/***/ }),

/***/ "(api)/./lib/redis.ts":
/*!**********************!*\
  !*** ./lib/redis.ts ***!
  \**********************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   redis: () => (/* binding */ redis),\n/* harmony export */   subscribe: () => (/* binding */ subscribe),\n/* harmony export */   subscribeToChannels: () => (/* binding */ subscribeToChannels)\n/* harmony export */ });\n/* harmony import */ var ioredis__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ioredis */ \"ioredis\");\n/* harmony import */ var ioredis__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(ioredis__WEBPACK_IMPORTED_MODULE_0__);\n// lib/redis.ts\n\nconst redis = new (ioredis__WEBPACK_IMPORTED_MODULE_0___default())(process.env.REDIS_URL || \"redis://127.0.0.1:6379\", {\n    maxRetriesPerRequest: null,\n    lazyConnect: true,\n    reconnectOnError: (err)=>{\n        const targetErrors = [\n            \"READONLY\",\n            \"ECONNRESET\",\n            \"ETIMEDOUT\"\n        ];\n        return targetErrors.some((e)=>err.message.includes(e));\n    }\n});\nredis.on(\"connect\", ()=>console.log(\"Redis connected\"));\nredis.on(\"ready\", ()=>console.log(\"Redis ready\"));\nredis.on(\"error\", (err)=>console.error(\"Redis error\", err));\nredis.on(\"close\", ()=>console.warn(\"Redis connection closed\"));\nredis.on(\"reconnecting\", ()=>console.log(\"Redis reconnecting\"));\n/**\r\n * Single-channel subscription helper\r\n */ function subscribe(channel, handler) {\n    const sub = redis.duplicate();\n    const onMessage = (ch, message)=>{\n        if (ch !== channel) return;\n        try {\n            handler(JSON.parse(message));\n        } catch  {\n            handler(message);\n        }\n    };\n    sub.on(\"message\", onMessage);\n    sub.subscribe(channel).catch((err)=>{\n        console.error(`Redis subscribe failed for ${channel}`, err);\n    });\n    return async ()=>{\n        try {\n            sub.off(\"message\", onMessage);\n            await sub.unsubscribe(channel);\n            await sub.quit();\n        } catch (err) {\n            console.warn(`Failed to unsubscribe from ${channel}`, err);\n        }\n    };\n}\n/**\r\n * Multi-channel subscriber (worker & SSE safe)\r\n */ async function subscribeToChannels(sub, channels, handler) {\n    for (const ch of channels){\n        await sub.subscribe(ch);\n    }\n    sub.on(\"message\", (channel, message)=>{\n        if (channels.includes(channel)) {\n            handler(channel, message);\n        }\n    });\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi9saWIvcmVkaXMudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7QUFBQSxlQUFlO0FBQ2U7QUFFdkIsTUFBTUMsUUFBUSxJQUFJRCxnREFBT0EsQ0FBQ0UsUUFBUUMsR0FBRyxDQUFDQyxTQUFTLElBQUksMEJBQTBCO0lBQ2xGQyxzQkFBc0I7SUFDdEJDLGFBQWE7SUFDYkMsa0JBQWtCLENBQUNDO1FBQ2pCLE1BQU1DLGVBQWU7WUFBQztZQUFZO1lBQWM7U0FBWTtRQUM1RCxPQUFPQSxhQUFhQyxJQUFJLENBQUMsQ0FBQ0MsSUFBTUgsSUFBSUksT0FBTyxDQUFDQyxRQUFRLENBQUNGO0lBQ3ZEO0FBQ0YsR0FBRztBQUVIVixNQUFNYSxFQUFFLENBQUMsV0FBVyxJQUFNQyxRQUFRQyxHQUFHLENBQUM7QUFDdENmLE1BQU1hLEVBQUUsQ0FBQyxTQUFTLElBQU1DLFFBQVFDLEdBQUcsQ0FBQztBQUNwQ2YsTUFBTWEsRUFBRSxDQUFDLFNBQVMsQ0FBQ04sTUFBUU8sUUFBUUUsS0FBSyxDQUFDLGVBQWVUO0FBQ3hEUCxNQUFNYSxFQUFFLENBQUMsU0FBUyxJQUFNQyxRQUFRRyxJQUFJLENBQUM7QUFDckNqQixNQUFNYSxFQUFFLENBQUMsZ0JBQWdCLElBQU1DLFFBQVFDLEdBQUcsQ0FBQztBQUUzQzs7Q0FFQyxHQUNNLFNBQVNHLFVBQ2RDLE9BQWUsRUFDZkMsT0FBNEI7SUFFNUIsTUFBTUMsTUFBTXJCLE1BQU1zQixTQUFTO0lBRTNCLE1BQU1DLFlBQVksQ0FBQ0MsSUFBWWI7UUFDN0IsSUFBSWEsT0FBT0wsU0FBUztRQUNwQixJQUFJO1lBQ0ZDLFFBQVFLLEtBQUtDLEtBQUssQ0FBQ2Y7UUFDckIsRUFBRSxPQUFNO1lBQ05TLFFBQVFUO1FBQ1Y7SUFDRjtJQUVBVSxJQUFJUixFQUFFLENBQUMsV0FBV1U7SUFFbEJGLElBQUlILFNBQVMsQ0FBQ0MsU0FBU1EsS0FBSyxDQUFDLENBQUNwQjtRQUM1Qk8sUUFBUUUsS0FBSyxDQUFDLENBQUMsMkJBQTJCLEVBQUVHLFFBQVEsQ0FBQyxFQUFFWjtJQUN6RDtJQUVBLE9BQU87UUFDTCxJQUFJO1lBQ0ZjLElBQUlPLEdBQUcsQ0FBQyxXQUFXTDtZQUNuQixNQUFNRixJQUFJUSxXQUFXLENBQUNWO1lBQ3RCLE1BQU1FLElBQUlTLElBQUk7UUFDaEIsRUFBRSxPQUFPdkIsS0FBSztZQUNaTyxRQUFRRyxJQUFJLENBQUMsQ0FBQywyQkFBMkIsRUFBRUUsUUFBUSxDQUFDLEVBQUVaO1FBQ3hEO0lBQ0Y7QUFDRjtBQUVBOztDQUVDLEdBQ00sZUFBZXdCLG9CQUNwQlYsR0FBWSxFQUNaVyxRQUFrQixFQUNsQlosT0FBbUQ7SUFFbkQsS0FBSyxNQUFNSSxNQUFNUSxTQUFVO1FBQ3pCLE1BQU1YLElBQUlILFNBQVMsQ0FBQ007SUFDdEI7SUFFQUgsSUFBSVIsRUFBRSxDQUFDLFdBQVcsQ0FBQ00sU0FBU1I7UUFDMUIsSUFBSXFCLFNBQVNwQixRQUFRLENBQUNPLFVBQVU7WUFDOUJDLFFBQVFELFNBQVNSO1FBQ25CO0lBQ0Y7QUFDRiIsInNvdXJjZXMiOlsid2VicGFjazovL21hcmtldGluZy1tdnAvLi9saWIvcmVkaXMudHM/NTFlOSJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBsaWIvcmVkaXMudHNcclxuaW1wb3J0IElPUmVkaXMgZnJvbSBcImlvcmVkaXNcIjtcclxuXHJcbmV4cG9ydCBjb25zdCByZWRpcyA9IG5ldyBJT1JlZGlzKHByb2Nlc3MuZW52LlJFRElTX1VSTCB8fCBcInJlZGlzOi8vMTI3LjAuMC4xOjYzNzlcIiwge1xyXG4gIG1heFJldHJpZXNQZXJSZXF1ZXN0OiBudWxsLFxyXG4gIGxhenlDb25uZWN0OiB0cnVlLFxyXG4gIHJlY29ubmVjdE9uRXJyb3I6IChlcnIpID0+IHtcclxuICAgIGNvbnN0IHRhcmdldEVycm9ycyA9IFtcIlJFQURPTkxZXCIsIFwiRUNPTk5SRVNFVFwiLCBcIkVUSU1FRE9VVFwiXTtcclxuICAgIHJldHVybiB0YXJnZXRFcnJvcnMuc29tZSgoZSkgPT4gZXJyLm1lc3NhZ2UuaW5jbHVkZXMoZSkpO1xyXG4gIH0sXHJcbn0pO1xyXG5cclxucmVkaXMub24oXCJjb25uZWN0XCIsICgpID0+IGNvbnNvbGUubG9nKFwiUmVkaXMgY29ubmVjdGVkXCIpKTtcclxucmVkaXMub24oXCJyZWFkeVwiLCAoKSA9PiBjb25zb2xlLmxvZyhcIlJlZGlzIHJlYWR5XCIpKTtcclxucmVkaXMub24oXCJlcnJvclwiLCAoZXJyKSA9PiBjb25zb2xlLmVycm9yKFwiUmVkaXMgZXJyb3JcIiwgZXJyKSk7XHJcbnJlZGlzLm9uKFwiY2xvc2VcIiwgKCkgPT4gY29uc29sZS53YXJuKFwiUmVkaXMgY29ubmVjdGlvbiBjbG9zZWRcIikpO1xyXG5yZWRpcy5vbihcInJlY29ubmVjdGluZ1wiLCAoKSA9PiBjb25zb2xlLmxvZyhcIlJlZGlzIHJlY29ubmVjdGluZ1wiKSk7XHJcblxyXG4vKipcclxuICogU2luZ2xlLWNoYW5uZWwgc3Vic2NyaXB0aW9uIGhlbHBlclxyXG4gKi9cclxuZXhwb3J0IGZ1bmN0aW9uIHN1YnNjcmliZShcclxuICBjaGFubmVsOiBzdHJpbmcsXHJcbiAgaGFuZGxlcjogKGRhdGE6IGFueSkgPT4gdm9pZFxyXG4pOiAoKSA9PiBQcm9taXNlPHZvaWQ+IHtcclxuICBjb25zdCBzdWIgPSByZWRpcy5kdXBsaWNhdGUoKTtcclxuXHJcbiAgY29uc3Qgb25NZXNzYWdlID0gKGNoOiBzdHJpbmcsIG1lc3NhZ2U6IHN0cmluZykgPT4ge1xyXG4gICAgaWYgKGNoICE9PSBjaGFubmVsKSByZXR1cm47XHJcbiAgICB0cnkge1xyXG4gICAgICBoYW5kbGVyKEpTT04ucGFyc2UobWVzc2FnZSkpO1xyXG4gICAgfSBjYXRjaCB7XHJcbiAgICAgIGhhbmRsZXIobWVzc2FnZSk7XHJcbiAgICB9XHJcbiAgfTtcclxuXHJcbiAgc3ViLm9uKFwibWVzc2FnZVwiLCBvbk1lc3NhZ2UpO1xyXG5cclxuICBzdWIuc3Vic2NyaWJlKGNoYW5uZWwpLmNhdGNoKChlcnIpID0+IHtcclxuICAgIGNvbnNvbGUuZXJyb3IoYFJlZGlzIHN1YnNjcmliZSBmYWlsZWQgZm9yICR7Y2hhbm5lbH1gLCBlcnIpO1xyXG4gIH0pO1xyXG5cclxuICByZXR1cm4gYXN5bmMgKCkgPT4ge1xyXG4gICAgdHJ5IHtcclxuICAgICAgc3ViLm9mZihcIm1lc3NhZ2VcIiwgb25NZXNzYWdlKTtcclxuICAgICAgYXdhaXQgc3ViLnVuc3Vic2NyaWJlKGNoYW5uZWwpO1xyXG4gICAgICBhd2FpdCBzdWIucXVpdCgpO1xyXG4gICAgfSBjYXRjaCAoZXJyKSB7XHJcbiAgICAgIGNvbnNvbGUud2FybihgRmFpbGVkIHRvIHVuc3Vic2NyaWJlIGZyb20gJHtjaGFubmVsfWAsIGVycik7XHJcbiAgICB9XHJcbiAgfTtcclxufVxyXG5cclxuLyoqXHJcbiAqIE11bHRpLWNoYW5uZWwgc3Vic2NyaWJlciAod29ya2VyICYgU1NFIHNhZmUpXHJcbiAqL1xyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gc3Vic2NyaWJlVG9DaGFubmVscyhcclxuICBzdWI6IElPUmVkaXMsXHJcbiAgY2hhbm5lbHM6IHN0cmluZ1tdLFxyXG4gIGhhbmRsZXI6IChjaGFubmVsOiBzdHJpbmcsIG1lc3NhZ2U6IHN0cmluZykgPT4gdm9pZFxyXG4pIHtcclxuICBmb3IgKGNvbnN0IGNoIG9mIGNoYW5uZWxzKSB7XHJcbiAgICBhd2FpdCBzdWIuc3Vic2NyaWJlKGNoKTtcclxuICB9XHJcblxyXG4gIHN1Yi5vbihcIm1lc3NhZ2VcIiwgKGNoYW5uZWwsIG1lc3NhZ2UpID0+IHtcclxuICAgIGlmIChjaGFubmVscy5pbmNsdWRlcyhjaGFubmVsKSkge1xyXG4gICAgICBoYW5kbGVyKGNoYW5uZWwsIG1lc3NhZ2UpO1xyXG4gICAgfVxyXG4gIH0pO1xyXG59XHJcbiJdLCJuYW1lcyI6WyJJT1JlZGlzIiwicmVkaXMiLCJwcm9jZXNzIiwiZW52IiwiUkVESVNfVVJMIiwibWF4UmV0cmllc1BlclJlcXVlc3QiLCJsYXp5Q29ubmVjdCIsInJlY29ubmVjdE9uRXJyb3IiLCJlcnIiLCJ0YXJnZXRFcnJvcnMiLCJzb21lIiwiZSIsIm1lc3NhZ2UiLCJpbmNsdWRlcyIsIm9uIiwiY29uc29sZSIsImxvZyIsImVycm9yIiwid2FybiIsInN1YnNjcmliZSIsImNoYW5uZWwiLCJoYW5kbGVyIiwic3ViIiwiZHVwbGljYXRlIiwib25NZXNzYWdlIiwiY2giLCJKU09OIiwicGFyc2UiLCJjYXRjaCIsIm9mZiIsInVuc3Vic2NyaWJlIiwicXVpdCIsInN1YnNjcmliZVRvQ2hhbm5lbHMiLCJjaGFubmVscyJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(api)/./lib/redis.ts\n");

/***/ }),

/***/ "(api)/./pages/api/campaign/[id]/contacts.ts":
/*!*********************************************!*\
  !*** ./pages/api/campaign/[id]/contacts.ts ***!
  \*********************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (/* binding */ handler)\n/* harmony export */ });\n/* harmony import */ var _lib_mongo__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../../lib/mongo */ \"(api)/./lib/mongo.ts\");\n/* harmony import */ var _lib_redis__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../../lib/redis */ \"(api)/./lib/redis.ts\");\n/* harmony import */ var mongodb__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! mongodb */ \"mongodb\");\n/* harmony import */ var mongodb__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(mongodb__WEBPACK_IMPORTED_MODULE_2__);\n// pages/api/campaign/[id]/contacts.ts\n\n\n\nconst MAX_PAGE_SIZE = 200;\nconst MAX_ATTEMPTS = Number(process.env.MAX_ATTEMPTS || 3);\nfunction safeNum(v, fallback = 0) {\n    const n = Number(v);\n    return Number.isFinite(n) ? Math.max(0, Math.floor(n)) : fallback;\n}\n/**\r\n * Build a simple preview object from either the step or the campaign definition.\r\n * Kept for compatibility with earlier clients; not required for the current UI.\r\n */ async function buildPreviewForRow(campaignId, campaignDoc, row) {\n    try {\n        const key = `campaign:${campaignId}:definition`;\n        const raw = await _lib_redis__WEBPACK_IMPORTED_MODULE_1__.redis.get(key);\n        if (raw) {\n            const definition = JSON.parse(raw);\n            if (row.step && row.step.body) {\n                return {\n                    subject: row.step.subject || definition.initial?.subject || campaignDoc?.name || \"\",\n                    body: row.step.body || \"\"\n                };\n            }\n            return {\n                subject: definition.initial?.subject || campaignDoc?.name || \"\",\n                body: definition.initial?.body || campaignDoc?.body || \"\"\n            };\n        }\n    } catch (e) {\n    // ignore and continue to fallback\n    }\n    const subject = row.step?.subject || campaignDoc?.subject || campaignDoc?.title || campaignDoc?.name || `Campaign ${campaignId}`;\n    const body = row.step?.body || campaignDoc?.body || campaignDoc?.content || \"\";\n    return {\n        subject,\n        body\n    };\n}\nasync function handler(req, res) {\n    const { id } = req.query;\n    if (!id || typeof id !== \"string\") return res.status(400).json({\n        error: \"Invalid campaign id\"\n    });\n    // Query params: page, pageSize, status, search, sort, viewAll\n    const page = safeNum(req.query.page, 1);\n    const pageSize = Math.min(MAX_PAGE_SIZE, Math.max(1, safeNum(req.query.pageSize, 25)));\n    const status = typeof req.query.status === \"string\" && req.query.status.length ? req.query.status : undefined;\n    const search = typeof req.query.search === \"string\" && req.query.search.length ? req.query.search : undefined;\n    const sort = req.query.sort === \"asc\" ? 1 : -1;\n    const viewAll = req.query.viewAll === \"true\" || req.query.viewAll === \"1\";\n    try {\n        const client = await _lib_mongo__WEBPACK_IMPORTED_MODULE_0__[\"default\"];\n        const db = client.db(\"PlatformData\");\n        const campaignId = new mongodb__WEBPACK_IMPORTED_MODULE_2__.ObjectId(id);\n        const campaignDoc = await db.collection(\"campaigns\").findOne({\n            _id: campaignId\n        });\n        if (!campaignDoc) return res.status(404).json({\n            error: \"Campaign not found\"\n        });\n        const filter = {\n            campaignId\n        };\n        if (status) filter.status = status;\n        if (search) {\n            // search against email or contact snapshot fields\n            filter.$or = [\n                {\n                    email: {\n                        $regex: new RegExp(search.replace(/[.*+?^${}()|[\\]\\\\]/g, \"\\\\$&\"), \"i\")\n                    }\n                },\n                {\n                    contactIdStr: {\n                        $regex: new RegExp(search.replace(/[.*+?^${}()|[\\]\\\\]/g, \"\\\\$&\"), \"i\")\n                    }\n                }\n            ];\n        }\n        // Pagination calculation\n        const total = await db.collection(\"campaign_contacts\").countDocuments(filter);\n        // If viewAll requested, we'll return up to a server cap\n        let effectiveLimit = pageSize;\n        let skip = (page - 1) * pageSize;\n        if (viewAll) {\n            const viewAllCap = Math.min(5000, Math.max(pageSize, total));\n            effectiveLimit = viewAllCap;\n            skip = 0;\n        }\n        const cursor = db.collection(\"campaign_contacts\").find(filter, {\n            projection: {\n                _id: 1,\n                contactId: 1,\n                email: 1,\n                status: 1,\n                attempts: 1,\n                bgAttempts: 1,\n                lastAttemptAt: 1,\n                lastError: 1,\n                step: 1,\n                contactEmail: 1,\n                emailSnapshot: 1,\n                contactIdStr: 1\n            }\n        }).sort({\n            lastAttemptAt: sort,\n            email: 1\n        }).skip(skip).limit(effectiveLimit);\n        const rows = await cursor.toArray();\n        // Collect contactIds that need email backfill\n        const contactIdToRows = {};\n        const objectIdsToLookup = [];\n        for (const r of rows){\n            // Normalize contactId to string for mapping\n            const cidRaw = r.contactId ?? r.contactIdStr ?? (r._id ? r._id.toString() : null);\n            const cidStr = cidRaw ? String(cidRaw) : null;\n            // if email exists in ledger row, no need to lookup\n            if (!r.email && cidStr) {\n                // try to parse as ObjectId for lookup\n                try {\n                    const oid = new mongodb__WEBPACK_IMPORTED_MODULE_2__.ObjectId(cidStr);\n                    objectIdsToLookup.push(oid);\n                    contactIdToRows[cidStr] = contactIdToRows[cidStr] || [];\n                    contactIdToRows[cidStr].push(r);\n                } catch  {\n                    // not an ObjectId — still record so we can attempt fallback later\n                    contactIdToRows[cidStr] = contactIdToRows[cidStr] || [];\n                    contactIdToRows[cidStr].push(r);\n                }\n            }\n        }\n        // Query contacts collection for ObjectId matches\n        const idToEmail = {};\n        if (objectIdsToLookup.length > 0) {\n            const contactsRaw = await db.collection(\"contacts\").find({\n                _id: {\n                    $in: objectIdsToLookup\n                }\n            }, {\n                projection: {\n                    _id: 1,\n                    email: 1\n                }\n            }).toArray();\n            for (const c of contactsRaw){\n                if (!c || !c._id) continue;\n                idToEmail[c._id.toString()] = c.email ?? \"\";\n            }\n        }\n        // Build response items — fill email from ledger or from contacts lookup, or null\n        const items = [];\n        for (const r of rows){\n            const cidRaw = r.contactId ?? r.contactIdStr ?? (r._id ? r._id.toString() : null);\n            const cidStr = cidRaw ? String(cidRaw) : null;\n            let email = r.email ?? null;\n            if (!email && cidStr) {\n                email = idToEmail[cidStr] ?? null;\n            }\n            // As a last resort, try to see if the ledger row stores an email in another field\n            if (!email && (r.contactEmail || r.emailSnapshot)) {\n                email = r.contactEmail ?? r.emailSnapshot ?? null;\n            }\n            // keep preview for compatibility (may be empty)\n            const preview = await buildPreviewForRow(id, campaignDoc, r);\n            items.push({\n                id: r._id?.toString?.() ?? r._id,\n                contactId: cidStr,\n                email,\n                status: r.status,\n                attempts: r.attempts ?? 0,\n                bgAttempts: typeof r.bgAttempts === \"number\" ? r.bgAttempts : 0,\n                lastAttemptAt: r.lastAttemptAt ?? null,\n                lastError: r.lastError ?? null,\n                previewSubject: preview.subject ?? \"\",\n                previewBody: preview.body ?? \"\"\n            });\n        }\n        return res.status(200).json({\n            campaignId: id,\n            total,\n            page,\n            pageSize: effectiveLimit,\n            pages: viewAll ? 1 : Math.max(1, Math.ceil(total / pageSize)),\n            items,\n            maxAttempts: MAX_ATTEMPTS,\n            viewAll: !!viewAll\n        });\n    } catch (err) {\n        console.error(\"Contacts API error\", err);\n        return res.status(500).json({\n            error: \"Internal server error\"\n        });\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi9wYWdlcy9hcGkvY2FtcGFpZ24vW2lkXS9jb250YWN0cy50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7OztBQUFBLHNDQUFzQztBQUdZO0FBQ0o7QUFDWDtBQUVuQyxNQUFNRyxnQkFBZ0I7QUFDdEIsTUFBTUMsZUFBZUMsT0FBT0MsUUFBUUMsR0FBRyxDQUFDSCxZQUFZLElBQUk7QUFFeEQsU0FBU0ksUUFBUUMsQ0FBTSxFQUFFQyxXQUFXLENBQUM7SUFDbkMsTUFBTUMsSUFBSU4sT0FBT0k7SUFDakIsT0FBT0osT0FBT08sUUFBUSxDQUFDRCxLQUFLRSxLQUFLQyxHQUFHLENBQUMsR0FBR0QsS0FBS0UsS0FBSyxDQUFDSixNQUFNRDtBQUMzRDtBQUVBOzs7Q0FHQyxHQUNELGVBQWVNLG1CQUFtQkMsVUFBa0IsRUFBRUMsV0FBZ0IsRUFBRUMsR0FBUTtJQUM5RSxJQUFJO1FBQ0YsTUFBTUMsTUFBTSxDQUFDLFNBQVMsRUFBRUgsV0FBVyxXQUFXLENBQUM7UUFDL0MsTUFBTUksTUFBTSxNQUFNcEIsNkNBQUtBLENBQUNxQixHQUFHLENBQUNGO1FBQzVCLElBQUlDLEtBQUs7WUFDUCxNQUFNRSxhQUFhQyxLQUFLQyxLQUFLLENBQUNKO1lBQzlCLElBQUlGLElBQUlPLElBQUksSUFBSVAsSUFBSU8sSUFBSSxDQUFDQyxJQUFJLEVBQUU7Z0JBQzdCLE9BQU87b0JBQUVDLFNBQVNULElBQUlPLElBQUksQ0FBQ0UsT0FBTyxJQUFJTCxXQUFXTSxPQUFPLEVBQUVELFdBQVdWLGFBQWFZLFFBQVE7b0JBQUlILE1BQU1SLElBQUlPLElBQUksQ0FBQ0MsSUFBSSxJQUFJO2dCQUFHO1lBQzFIO1lBQ0EsT0FBTztnQkFBRUMsU0FBU0wsV0FBV00sT0FBTyxFQUFFRCxXQUFXVixhQUFhWSxRQUFRO2dCQUFJSCxNQUFNSixXQUFXTSxPQUFPLEVBQUVGLFFBQVFULGFBQWFTLFFBQVE7WUFBRztRQUN0STtJQUNGLEVBQUUsT0FBT0ksR0FBRztJQUNWLGtDQUFrQztJQUNwQztJ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QnFCLElBQUluQixhQUFhZ0U7WUFFMURXLE1BQU1MLElBQUksQ0FBQztnQkFDVG5ELElBQUk2QyxFQUFFNUIsR0FBRyxFQUFFOEIsZ0JBQWdCRixFQUFFNUIsR0FBRztnQkFDaENnQixXQUFXZTtnQkFDWDVCO2dCQUNBbEIsUUFBUTJDLEVBQUUzQyxNQUFNO2dCQUNoQmdDLFVBQVVXLEVBQUVYLFFBQVEsSUFBSTtnQkFDeEJDLFlBQVksT0FBT1UsRUFBRVYsVUFBVSxLQUFLLFdBQVdVLEVBQUVWLFVBQVUsR0FBRztnQkFDOURDLGVBQWVTLEVBQUVULGFBQWEsSUFBSTtnQkFDbENDLFdBQVdRLEVBQUVSLFNBQVMsSUFBSTtnQkFDMUJxQixnQkFBZ0JELFFBQVFsRSxPQUFPLElBQUk7Z0JBQ25Db0UsYUFBYUYsUUFBUW5FLElBQUksSUFBSTtZQUMvQjtRQUNGO1FBRUEsT0FBT1MsSUFBSUcsTUFBTSxDQUFDLEtBQUtDLElBQUksQ0FBQztZQUMxQnZCLFlBQVlvQjtZQUNaeUI7WUFDQXBCO1lBQ0FDLFVBQVVxQjtZQUNWaUMsT0FBT2hELFVBQVUsSUFBSXBDLEtBQUtDLEdBQUcsQ0FBQyxHQUFHRCxLQUFLcUYsSUFBSSxDQUFDcEMsUUFBUW5CO1lBQ25Ea0Q7WUFDQU0sYUFBYS9GO1lBQ2I2QyxTQUFTLENBQUMsQ0FBQ0E7UUFDYjtJQUNGLEVBQUUsT0FBT21ELEtBQUs7UUFDWkMsUUFBUTVELEtBQUssQ0FBQyxzQkFBc0IyRDtRQUNwQyxPQUFPaEUsSUFBSUcsTUFBTSxDQUFDLEtBQUtDLElBQUksQ0FBQztZQUFFQyxPQUFPO1FBQXdCO0lBQy9EO0FBQ0YiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9tYXJrZXRpbmctbXZwLy4vcGFnZXMvYXBpL2NhbXBhaWduL1tpZF0vY29udGFjdHMudHM/Mjc0YiJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBwYWdlcy9hcGkvY2FtcGFpZ24vW2lkXS9jb250YWN0cy50c1xyXG5cclxuaW1wb3J0IHR5cGUgeyBOZXh0QXBpUmVxdWVzdCwgTmV4dEFwaVJlc3BvbnNlIH0gZnJvbSAnbmV4dCc7XHJcbmltcG9ydCBjbGllbnRQcm9taXNlIGZyb20gJy4uLy4uLy4uLy4uL2xpYi9tb25nbyc7XHJcbmltcG9ydCB7IHJlZGlzIH0gZnJvbSAnLi4vLi4vLi4vLi4vbGliL3JlZGlzJztcclxuaW1wb3J0IHsgT2JqZWN0SWQgfSBmcm9tICdtb25nb2RiJztcclxuXHJcbmNvbnN0IE1BWF9QQUdFX1NJWkUgPSAyMDA7XHJcbmNvbnN0IE1BWF9BVFRFTVBUUyA9IE51bWJlcihwcm9jZXNzLmVudi5NQVhfQVRURU1QVFMgfHwgMyk7XHJcblxyXG5mdW5jdGlvbiBzYWZlTnVtKHY6IGFueSwgZmFsbGJhY2sgPSAwKSB7XHJcbiAgY29uc3QgbiA9IE51bWJlcih2KTtcclxuICByZXR1cm4gTnVtYmVyLmlzRmluaXRlKG4pID8gTWF0aC5tYXgoMCwgTWF0aC5mbG9vcihuKSkgOiBmYWxsYmFjaztcclxufVxyXG5cclxuLyoqXHJcbiAqIEJ1aWxkIGEgc2ltcGxlIHByZXZpZXcgb2JqZWN0IGZyb20gZWl0aGVyIHRoZSBzdGVwIG9yIHRoZSBjYW1wYWlnbiBkZWZpbml0aW9uLlxyXG4gKiBLZXB0IGZvciBjb21wYXRpYmlsaXR5IHdpdGggZWFybGllciBjbGllbnRzOyBub3QgcmVxdWlyZWQgZm9yIHRoZSBjdXJyZW50IFVJLlxyXG4gKi9cclxuYXN5bmMgZnVuY3Rpb24gYnVpbGRQcmV2aWV3Rm9yUm93KGNhbXBhaWduSWQ6IHN0cmluZywgY2FtcGFpZ25Eb2M6IGFueSwgcm93OiBhbnkpIHtcclxuICB0cnkge1xyXG4gICAgY29uc3Qga2V5ID0gYGNhbXBhaWduOiR7Y2FtcGFpZ25JZH06ZGVmaW5pdGlvbmA7XHJcbiAgICBjb25zdCByYXcgPSBhd2FpdCByZWRpcy5nZXQoa2V5KTtcclxuICAgIGlmIChyYXcpIHtcclxuICAgICAgY29uc3QgZGVmaW5pdGlvbiA9IEpTT04ucGFyc2UocmF3KTtcclxuICAgICAgaWYgKHJvdy5zdGVwICYmIHJvdy5zdGVwLmJvZHkpIHtcclxuICAgICAgICByZXR1cm4geyBzdWJqZWN0OiByb3cuc3RlcC5zdWJqZWN0IHx8IGRlZmluaXRpb24uaW5pdGlhbD8uc3ViamVjdCB8fCBjYW1wYWlnbkRvYz8ubmFtZSB8fCAnJywgYm9keTogcm93LnN0ZXAuYm9keSB8fCAnJyB9O1xyXG4gICAgICB9XHJcbiAgICAgIHJldHVybiB7IHN1YmplY3Q6IGRlZmluaXRpb24uaW5pdGlhbD8uc3ViamVjdCB8fCBjYW1wYWlnbkRvYz8ubmFtZSB8fCAnJywgYm9keTogZGVmaW5pdGlvbi5pbml0aWFsPy5ib2R5IHx8IGNhbXBhaWduRG9jPy5ib2R5IHx8ICcnIH07XHJcbiAgICB9XHJcbiAgfSBjYXRjaCAoZSkge1xyXG4gICAgLy8gaWdub3JlIGFuZCBjb250aW51ZSB0byBmYWxsYmFja1xyXG4gIH1cclxuXHJcbiAgY29uc3Qgc3ViamVjdCA9IHJvdy5zdGVwPy5zdWJqZWN0IHx8IGNhbXBhaWduRG9jPy5zdWJqZWN0IHx8IGNhbXBhaWduRG9jPy50aXRsZSB8fCBjYW1wYWlnbkRvYz8ubmFtZSB8fCBgQ2FtcGFpZ24gJHtjYW1wYWlnbklkfWA7XHJcbiAgY29uc3QgYm9keSA9IHJvdy5zdGVwPy5ib2R5IHx8IGNhbXBhaWduRG9jPy5ib2R5IHx8IGNhbXBhaWduRG9jPy5jb250ZW50IHx8ICcnO1xyXG4gIHJldHVybiB7IHN1YmplY3QsIGJvZHkgfTtcclxufVxyXG5cclxuZXhwb3J0IGRlZmF1bHQgYXN5bmMgZnVuY3Rpb24gaGFuZGxlcihyZXE6IE5leHRBcGlSZXF1ZXN0LCByZXM6IE5leHRBcGlSZXNwb25zZSkge1xyXG4gIGNvbnN0IHsgaWQgfSA9IHJlcS5xdWVyeTtcclxuICBpZiAoIWlkIHx8IHR5cGVvZiBpZCAhPT0gJ3N0cmluZycpIHJldHVybiByZXMuc3RhdHVzKDQwMCkuanNvbih7IGVycm9yOiAnSW52YWxpZCBjYW1wYWlnbiBpZCcgfSk7XHJcblxyXG4gIC8vIFF1ZXJ5IHBhcmFtczogcGFnZSwgcGFnZVNpemUsIHN0YXR1cywgc2VhcmNoLCBzb3J0LCB2aWV3QWxsXHJcbiAgY29uc3QgcGFnZSA9IHNhZmVOdW0ocmVxLnF1ZXJ5LnBhZ2UsIDEpO1xyXG4gIGNvbnN0IHBhZ2VTaXplID0gTWF0aC5taW4oTUFYX1BBR0VfU0laRSwgTWF0aC5tYXgoMSwgc2FmZU51bShyZXEucXVlcnkucGFnZVNpemUsIDI1KSkpO1xyXG4gIGNvbnN0IHN0YXR1cyA9IHR5cGVvZiByZXEucXVlcnkuc3RhdHVzID09PSAnc3RyaW5nJyAmJiByZXEucXVlcnkuc3RhdHVzLmxlbmd0aCA/IHJlcS5xdWVyeS5zdGF0dXMgOiB1bmRlZmluZWQ7XHJcbiAgY29uc3Qgc2VhcmNoID0gdHlwZW9mIHJlcS5xdWVyeS5zZWFyY2ggPT09ICdzdHJpbmcnICYmIHJlcS5xdWVyeS5zZWFyY2gubGVuZ3RoID8gcmVxLnF1ZXJ5LnNlYXJjaCA6IHVuZGVmaW5lZDtcclxuICBjb25zdCBzb3J0ID0gcmVxLnF1ZXJ5LnNvcnQgPT09ICdhc2MnID8gMSA6IC0xO1xyXG4gIGNvbnN0IHZpZXdBbGwgPSByZXEucXVlcnkudmlld0FsbCA9PT0gJ3RydWUnIHx8IHJlcS5xdWVyeS52aWV3QWxsID09PSAnMSc7XHJcblxyXG4gIHRyeSB7XHJcbiAgICBjb25zdCBjbGllbnQgPSBhd2FpdCBjbGllbnRQcm9taXNlO1xyXG4gICAgY29uc3QgZGIgPSBjbGllbnQuZGIoJ1BsYXRmb3JtRGF0YScpO1xyXG4gICAgY29uc3QgY2FtcGFpZ25JZCA9IG5ldyBPYmplY3RJZChpZCk7XHJcblxyXG4gICAgY29uc3QgY2FtcGFpZ25Eb2MgPSBhd2FpdCBkYi5jb2xsZWN0aW9uKCdjYW1wYWlnbnMnKS5maW5kT25lKHsgX2lkOiBjYW1wYWlnbklkIH0pO1xyXG4gICAgaWYgKCFjYW1wYWlnbkRvYykgcmV0dXJuIHJlcy5zdGF0dXMoNDA0KS5qc29uKHsgZXJyb3I6ICdDYW1wYWlnbiBub3QgZm91bmQnIH0pO1xyXG5cclxuICAgIGNvbnN0IGZpbHRlcjogYW55ID0geyBjYW1wYWlnbklkIH07XHJcblxyXG4gICAgaWYgKHN0YXR1cykgZmlsdGVyLnN0YXR1cyA9IHN0YXR1cztcclxuICAgIGlmIChzZWFyY2gpIHtcclxuICAgICAgLy8gc2VhcmNoIGFnYWluc3QgZW1haWwgb3IgY29udGFjdCBzbmFwc2hvdCBmaWVsZHNcclxuICAgICAgZmlsdGVyLiRvciA9IFtcclxuICAgICAgICB7IGVtYWlsOiB7ICRyZWdleDogbmV3IFJlZ0V4cChzZWFyY2gucmVwbGFjZSgvWy4qKz9eJHt9KCl8W1xcXVxcXFxdL2csICdcXFxcJCYnKSwgJ2knKSB9IH0sXHJcbiAgICAgICAgeyBjb250YWN0SWRTdHI6IHsgJHJlZ2V4OiBuZXcgUmVnRXhwKHNlYXJjaC5yZXBsYWNlKC9bLiorP14ke30oKXxbXFxdXFxcXF0vZywgJ1xcXFwkJicpLCAnaScpIH0gfSxcclxuICAgICAgXTtcclxuICAgIH1cclxuXHJcbiAgICAvLyBQYWdpbmF0aW9uIGNhbGN1bGF0aW9uXHJcbiAgICBjb25zdCB0b3RhbCA9IGF3YWl0IGRiLmNvbGxlY3Rpb24oJ2NhbXBhaWduX2NvbnRhY3RzJykuY291bnREb2N1bWVudHMoZmlsdGVyKTtcclxuXHJcbiAgICAvLyBJZiB2aWV3QWxsIHJlcXVlc3RlZCwgd2UnbGwgcmV0dXJuIHVwIHRvIGEgc2VydmVyIGNhcFxyXG4gICAgbGV0IGVmZmVjdGl2ZUxpbWl0ID0gcGFnZVNpemU7XHJcbiAgICBsZXQgc2tpcCA9IChwYWdlIC0gMSkgKiBwYWdlU2l6ZTtcclxuICAgIGlmICh2aWV3QWxsKSB7XHJcbiAgICAgIGNvbnN0IHZpZXdBbGxDYXAgPSBNYXRoLm1pbig1MDAwLCBNYXRoLm1heChwYWdlU2l6ZSwgdG90YWwpKTtcclxuICAgICAgZWZmZWN0aXZlTGltaXQgPSB2aWV3QWxsQ2FwO1xyXG4gICAgICBza2lwID0gMDtcclxuICAgIH1cclxuXHJcbiAgICBjb25zdCBjdXJzb3IgPSBkYlxyXG4gICAgICAuY29sbGVjdGlvbignY2FtcGFpZ25fY29udGFjdHMnKVxyXG4gICAgICAuZmluZChmaWx0ZXIsIHtcclxuICAgICAgICBwcm9qZWN0aW9uOiB7XHJcbiAgICAgICAgICBfaWQ6IDEsXHJcbiAgICAgICAgICBjb250YWN0SWQ6IDEsXHJcbiAgICAgICAgICBlbWFpbDogMSxcclxuICAgICAgICAgIHN0YXR1czogMSxcclxuICAgICAgICAgIGF0dGVtcHRzOiAxLFxyXG4gICAgICAgICAgYmdBdHRlbXB0czogMSxcclxuICAgICAgICAgIGxhc3RBdHRlbXB0QXQ6IDEsXHJcbiAgICAgICAgICBsYXN0RXJyb3I6IDEsXHJcbiAgICAgICAgICBzdGVwOiAxLFxyXG4gICAgICAgICAgY29udGFjdEVtYWlsOiAxLFxyXG4gICAgICAgICAgZW1haWxTbmFwc2hvdDogMSxcclxuICAgICAgICAgIGNvbnRhY3RJZFN0cjogMSxcclxuICAgICAgICB9LFxyXG4gICAgICB9KVxyXG4gICAgICAuc29ydCh7IGxhc3RBdHRlbXB0QXQ6IHNvcnQsIGVtYWlsOiAxIH0pXHJcbiAgICAgIC5za2lwKHNraXApXHJcbiAgICAgIC5saW1pdChlZmZlY3RpdmVMaW1pdCk7XHJcblxyXG4gICAgY29uc3Qgcm93cyA9IGF3YWl0IGN1cnNvci50b0FycmF5KCk7XHJcblxyXG4gICAgLy8gQ29sbGVjdCBjb250YWN0SWRzIHRoYXQgbmVlZCBlbWFpbCBiYWNrZmlsbFxyXG4gICAgY29uc3QgY29udGFjdElkVG9Sb3dzOiBSZWNvcmQ8c3RyaW5nLCBhbnlbXT4gPSB7fTtcclxuICAgIGNvbnN0IG9iamVjdElkc1RvTG9va3VwOiBPYmplY3RJZFtdID0gW107XHJcbiAgICBmb3IgKGNvbnN0IHIgb2Ygcm93cykge1xyXG4gICAgICAvLyBOb3JtYWxpemUgY29udGFjdElkIHRvIHN0cmluZyBmb3IgbWFwcGluZ1xyXG4gICAgICBjb25zdCBjaWRSYXcgPSByLmNvbnRhY3RJZCA/PyByLmNvbnRhY3RJZFN0ciA/PyAoci5faWQgPyByLl9pZC50b1N0cmluZygpIDogbnVsbCk7XHJcbiAgICAgIGNvbnN0IGNpZFN0ciA9IGNpZFJhdyA/IFN0cmluZyhjaWRSYXcpIDogbnVsbDtcclxuXHJcbiAgICAgIC8vIGlmIGVtYWlsIGV4aXN0cyBpbiBsZWRnZXIgcm93LCBubyBuZWVkIHRvIGxvb2t1cFxyXG4gICAgICBpZiAoIXIuZW1haWwgJiYgY2lkU3RyKSB7XHJcbiAgICAgICAgLy8gdHJ5IHRvIHBhcnNlIGFzIE9iamVjdElkIGZvciBsb29rdXBcclxuICAgICAgICB0cnkge1xyXG4gICAgICAgICAgY29uc3Qgb2lkID0gbmV3IE9iamVjdElkKGNpZFN0cik7XHJcbiAgICAgICAgICBvYmplY3RJZHNUb0xvb2t1cC5wdXNoKG9pZCk7XHJcbiAgICAgICAgICBjb250YWN0SWRUb1Jvd3NbY2lkU3RyXSA9IGNvbnRhY3RJZFRvUm93c1tjaWRTdHJdIHx8IFtdO1xyXG4gICAgICAgICAgY29udGFjdElkVG9Sb3dzW2NpZFN0cl0ucHVzaChyKTtcclxuICAgICAgICB9IGNhdGNoIHtcclxuICAgICAgICAgIC8vIG5vdCBhbiBPYmplY3RJZCDigJQgc3RpbGwgcmVjb3JkIHNvIHdlIGNhbiBhdHRlbXB0IGZhbGxiYWNrIGxhdGVyXHJcbiAgICAgICAgICBjb250YWN0SWRUb1Jvd3NbY2lkU3RyXSA9IGNvbnRhY3RJZFRvUm93c1tjaWRTdHJdIHx8IFtdO1xyXG4gICAgICAgICAgY29udGFjdElkVG9Sb3dzW2NpZFN0cl0ucHVzaChyKTtcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICAvLyBRdWVyeSBjb250YWN0cyBjb2xsZWN0aW9uIGZvciBPYmplY3RJZCBtYXRjaGVzXHJcbiAgICBjb25zdCBpZFRvRW1haWw6IFJlY29yZDxzdHJpbmcsIHN0cmluZz4gPSB7fTtcclxuICAgIGlmIChvYmplY3RJZHNUb0xvb2t1cC5sZW5ndGggPiAwKSB7XHJcbiAgICAgIGNvbnN0IGNvbnRhY3RzUmF3ID0gYXdhaXQgZGJcclxuICAgICAgICAuY29sbGVjdGlvbignY29udGFjdHMnKVxyXG4gICAgICAgIC5maW5kKHsgX2lkOiB7ICRpbjogb2JqZWN0SWRzVG9Mb29rdXAgfSB9LCB7IHByb2plY3Rpb246IHsgX2lkOiAxLCBlbWFpbDogMSB9IH0pXHJcbiAgICAgICAgLnRvQXJyYXkoKTtcclxuXHJcbiAgICAgIGZvciAoY29uc3QgYyBvZiBjb250YWN0c1Jhdykge1xyXG4gICAgICAgIGlmICghYyB8fCAhYy5faWQpIGNvbnRpbnVlO1xyXG4gICAgICAgIGlkVG9FbWFpbFtjLl9pZC50b1N0cmluZygpXSA9IGMuZW1haWwgPz8gJyc7XHJcbiAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICAvLyBCdWlsZCByZXNwb25zZSBpdGVtcyDigJQgZmlsbCBlbWFpbCBmcm9tIGxlZGdlciBvciBmcm9tIGNvbnRhY3RzIGxvb2t1cCwgb3IgbnVsbFxyXG4gICAgY29uc3QgaXRlbXM6IGFueVtdID0gW107XHJcbiAgICBmb3IgKGNvbnN0IHIgb2Ygcm93cykge1xyXG4gICAgICBjb25zdCBjaWRSYXcgPSByLmNvbnRhY3RJZCA/PyByLmNvbnRhY3RJZFN0ciA/PyAoci5faWQgPyByLl9pZC50b1N0cmluZygpIDogbnVsbCk7XHJcbiAgICAgIGNvbnN0IGNpZFN0ciA9IGNpZFJhdyA/IFN0cmluZyhjaWRSYXcpIDogbnVsbDtcclxuICAgICAgbGV0IGVtYWlsID0gci5lbWFpbCA/PyBudWxsO1xyXG4gICAgICBpZiAoIWVtYWlsICYmIGNpZFN0cikge1xyXG4gICAgICAgIGVtYWlsID0gaWRUb0VtYWlsW2NpZFN0cl0gPz8gbnVsbDtcclxuICAgICAgfVxyXG5cclxuICAgICAgLy8gQXMgYSBsYXN0IHJlc29ydCwgdHJ5IHRvIHNlZSBpZiB0aGUgbGVkZ2VyIHJvdyBzdG9yZXMgYW4gZW1haWwgaW4gYW5vdGhlciBmaWVsZFxyXG4gICAgICBpZiAoIWVtYWlsICYmIChyLmNvbnRhY3RFbWFpbCB8fCByLmVtYWlsU25hcHNob3QpKSB7XHJcbiAgICAgICAgZW1haWwgPSByLmNvbnRhY3RFbWFpbCA/PyByLmVtYWlsU25hcHNob3QgPz8gbnVsbDtcclxuICAgICAgfVxyXG5cclxuICAgICAgLy8ga2VlcCBwcmV2aWV3IGZvciBjb21wYXRpYmlsaXR5IChtYXkgYmUgZW1wdHkpXHJcbiAgICAgIGNvbnN0IHByZXZpZXcgPSBhd2FpdCBidWlsZFByZXZpZXdGb3JSb3coaWQsIGNhbXBhaWduRG9jLCByKTtcclxuXHJcbiAgICAgIGl0ZW1zLnB1c2goe1xyXG4gICAgICAgIGlkOiByLl9pZD8udG9TdHJpbmc/LigpID8/IHIuX2lkLFxyXG4gICAgICAgIGNvbnRhY3RJZDogY2lkU3RyLFxyXG4gICAgICAgIGVtYWlsLFxyXG4gICAgICAgIHN0YXR1czogci5zdGF0dXMsXHJcbiAgICAgICAgYXR0ZW1wdHM6IHIuYXR0ZW1wdHMgPz8gMCxcclxuICAgICAgICBiZ0F0dGVtcHRzOiB0eXBlb2Ygci5iZ0F0dGVtcHRzID09PSAnbnVtYmVyJyA/IHIuYmdBdHRlbXB0cyA6IDAsXHJcbiAgICAgICAgbGFzdEF0dGVtcHRBdDogci5sYXN0QXR0ZW1wdEF0ID8/IG51bGwsXHJcbiAgICAgICAgbGFzdEVycm9yOiByLmxhc3RFcnJvciA/PyBudWxsLFxyXG4gICAgICAgIHByZXZpZXdTdWJqZWN0OiBwcmV2aWV3LnN1YmplY3QgPz8gJycsXHJcbiAgICAgICAgcHJldmlld0JvZHk6IHByZXZpZXcuYm9keSA/PyAnJyxcclxuICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuIHJlcy5zdGF0dXMoMjAwKS5qc29uKHtcclxuICAgICAgY2FtcGFpZ25JZDogaWQsXHJcbiAgICAgIHRvdGFsLFxyXG4gICAgICBwYWdlLFxyXG4gICAgICBwYWdlU2l6ZTogZWZmZWN0aXZlTGltaXQsXHJcbiAgICAgIHBhZ2VzOiB2aWV3QWxsID8gMSA6IE1hdGgubWF4KDEsIE1hdGguY2VpbCh0b3RhbCAvIHBhZ2VTaXplKSksXHJcbiAgICAgIGl0ZW1zLFxyXG4gICAgICBtYXhBdHRlbXB0czogTUFYX0FUVEVNUFRTLFxyXG4gICAgICB2aWV3QWxsOiAhIXZpZXdBbGwsXHJcbiAgICB9KTtcclxuICB9IGNhdGNoIChlcnIpIHtcclxuICAgIGNvbnNvbGUuZXJyb3IoJ0NvbnRhY3RzIEFQSSBlcnJvcicsIGVycik7XHJcbiAgICByZXR1cm4gcmVzLnN0YXR1cyg1MDApLmpzb24oeyBlcnJvcjogJ0ludGVybmFsIHNlcnZlciBlcnJvcicgfSk7XHJcbiAgfVxyXG59XHJcbiJdLCJuYW1lcyI6WyJjbGllbnRQcm9taXNlIiwicmVkaXMiLCJPYmplY3RJZCIsIk1BWF9QQUdFX1NJWkUiLCJNQVhfQVRURU1QVFMiLCJOdW1iZXIiLCJwcm9jZXNzIiwiZW52Iiwic2FmZU51bSIsInYiLCJmYWxsYmFjayIsIm4iLCJpc0Zpbml0ZSIsIk1hdGgiLCJtYXgiLCJmbG9vciIsImJ1aWxkUHJldmlld0ZvclJvdyIsImNhbXBhaWduSWQiLCJjYW1wYWlnbkRvYyIsInJvdyIsImtleSIsInJhdyIsImdldCIsImRlZmluaXRpb24iLCJKU09OIiwicGFyc2UiLCJzdGVwIiwiYm9keSIsInN1YmplY3QiLCJpbml0aWFsIiwibmFtZSIsImUiLCJ0aXRsZSIsImNvbnRlbnQiLCJoYW5kbGVyIiwicmVxIiwicmVzIiwiaWQiLCJxdWVyeSIsInN0YXR1cyIsImpzb24iLCJlcnJvciIsInBhZ2UiLCJwYWdlU2l6ZSIsIm1pbiIsImxlbmd0aCIsInVuZGVmaW5lZCIsInNlYXJjaCIsInNvcnQiLCJ2aWV3QWxsIiwiY2xpZW50IiwiZGIiLCJjb2xsZWN0aW9uIiwiZmluZE9uZSIsIl9pZCIsImZpbHRlciIsIiRvciIsImVtYWlsIiwiJHJlZ2V4IiwiUmVnRXhwIiwicmVwbGFjZSIsImNvbnRhY3RJZFN0ciIsInRvdGFsIiwiY291bnREb2N1bWVudHMiLCJlZmZlY3RpdmVMaW1pdCIsInNraXAiLCJ2aWV3QWxsQ2FwIiwiY3Vyc29yIiwiZmluZCIsInByb2plY3Rpb24iLCJjb250YWN0SWQiLCJhdHRlbXB0cyIsImJnQXR0ZW1wdHMiLCJsYXN0QXR0ZW1wdEF0IiwibGFzdEVycm9yIiwiY29udGFjdEVtYWlsIiwiZW1haWxTbmFwc2hvdCIsImxpbWl0Iiwicm93cyIsInRvQXJyYXkiLCJjb250YWN0SWRUb1Jvd3MiLCJvYmplY3RJZHNUb0xvb2t1cCIsInIiLCJjaWRSYXciLCJ0b1N0cmluZyIsImNpZFN0ciIsIlN0cmluZyIsIm9pZCIsInB1c2giLCJpZFRvRW1haWwiLCJjb250YWN0c1JhdyIsIiRpbiIsImMiLCJpdGVtcyIsInByZXZpZXciLCJwcmV2aWV3U3ViamVjdCIsInByZXZpZXdCb2R5IiwicGFnZXMiLCJjZWlsIiwibWF4QXR0ZW1wdHMiLCJlcnIiLCJjb25zb2xlIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(api)/./pages/api/campaign/[id]/contacts.ts\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../../webpack-api-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next"], () => (__webpack_exec__("(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fcampaign%2F%5Bid%5D%2Fcontacts&preferredRegion=&absolutePagePath=.%2Fpages%5Capi%5Ccampaign%5C%5Bid%5D%5Ccontacts.ts&middlewareConfigBase64=e30%3D!")));
module.exports = __webpack_exports__;

})();