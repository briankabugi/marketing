"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "pages/api/campaign/new-events";
exports.ids = ["pages/api/campaign/new-events"];
exports.modules = {

/***/ "ioredis":
/*!**************************!*\
  !*** external "ioredis" ***!
  \**************************/
/***/ ((module) => {

module.exports = require("ioredis");

/***/ }),

/***/ "next/dist/compiled/next-server/pages-api.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/pages-api.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/pages-api.runtime.dev.js");

/***/ }),

/***/ "(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fcampaign%2Fnew-events&preferredRegion=&absolutePagePath=.%2Fpages%5Capi%5Ccampaign%5Cnew-events.ts&middlewareConfigBase64=e30%3D!":
/*!************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fcampaign%2Fnew-events&preferredRegion=&absolutePagePath=.%2Fpages%5Capi%5Ccampaign%5Cnew-events.ts&middlewareConfigBase64=e30%3D! ***!
  \************************************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   config: () => (/* binding */ config),\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__),\n/* harmony export */   routeModule: () => (/* binding */ routeModule)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/pages-api/module.compiled */ \"(api)/./node_modules/next/dist/server/future/route-modules/pages-api/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(api)/./node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/build/templates/helpers */ \"(api)/./node_modules/next/dist/build/templates/helpers.js\");\n/* harmony import */ var _pages_api_campaign_new_events_ts__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./pages\\api\\campaign\\new-events.ts */ \"(api)/./pages/api/campaign/new-events.ts\");\n\n\n\n// Import the userland code.\n\n// Re-export the handler (should be the default export).\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__.hoist)(_pages_api_campaign_new_events_ts__WEBPACK_IMPORTED_MODULE_3__, \"default\"));\n// Re-export config.\nconst config = (0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__.hoist)(_pages_api_campaign_new_events_ts__WEBPACK_IMPORTED_MODULE_3__, \"config\");\n// Create and export the route module that will be consumed.\nconst routeModule = new next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__.PagesAPIRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.PAGES_API,\n        page: \"/api/campaign/new-events\",\n        pathname: \"/api/campaign/new-events\",\n        // The following aren't used in production.\n        bundlePath: \"\",\n        filename: \"\"\n    },\n    userland: _pages_api_campaign_new_events_ts__WEBPACK_IMPORTED_MODULE_3__\n});\n\n//# sourceMappingURL=pages-api.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LXJvdXRlLWxvYWRlci9pbmRleC5qcz9raW5kPVBBR0VTX0FQSSZwYWdlPSUyRmFwaSUyRmNhbXBhaWduJTJGbmV3LWV2ZW50cyZwcmVmZXJyZWRSZWdpb249JmFic29sdXRlUGFnZVBhdGg9LiUyRnBhZ2VzJTVDYXBpJTVDY2FtcGFpZ24lNUNuZXctZXZlbnRzLnRzJm1pZGRsZXdhcmVDb25maWdCYXNlNjQ9ZTMwJTNEISIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7OztBQUFzRztBQUN2QztBQUNMO0FBQzFEO0FBQ2tFO0FBQ2xFO0FBQ0EsaUVBQWUsd0VBQUssQ0FBQyw4REFBUSxZQUFZLEVBQUM7QUFDMUM7QUFDTyxlQUFlLHdFQUFLLENBQUMsOERBQVE7QUFDcEM7QUFDTyx3QkFBd0IsZ0hBQW1CO0FBQ2xEO0FBQ0EsY0FBYyx5RUFBUztBQUN2QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMLFlBQVk7QUFDWixDQUFDOztBQUVEIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vbWFya2V0aW5nLW12cC8/MGQyNyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBQYWdlc0FQSVJvdXRlTW9kdWxlIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvZnV0dXJlL3JvdXRlLW1vZHVsZXMvcGFnZXMtYXBpL21vZHVsZS5jb21waWxlZFwiO1xuaW1wb3J0IHsgUm91dGVLaW5kIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvZnV0dXJlL3JvdXRlLWtpbmRcIjtcbmltcG9ydCB7IGhvaXN0IH0gZnJvbSBcIm5leHQvZGlzdC9idWlsZC90ZW1wbGF0ZXMvaGVscGVyc1wiO1xuLy8gSW1wb3J0IHRoZSB1c2VybGFuZCBjb2RlLlxuaW1wb3J0ICogYXMgdXNlcmxhbmQgZnJvbSBcIi4vcGFnZXNcXFxcYXBpXFxcXGNhbXBhaWduXFxcXG5ldy1ldmVudHMudHNcIjtcbi8vIFJlLWV4cG9ydCB0aGUgaGFuZGxlciAoc2hvdWxkIGJlIHRoZSBkZWZhdWx0IGV4cG9ydCkuXG5leHBvcnQgZGVmYXVsdCBob2lzdCh1c2VybGFuZCwgXCJkZWZhdWx0XCIpO1xuLy8gUmUtZXhwb3J0IGNvbmZpZy5cbmV4cG9ydCBjb25zdCBjb25maWcgPSBob2lzdCh1c2VybGFuZCwgXCJjb25maWdcIik7XG4vLyBDcmVhdGUgYW5kIGV4cG9ydCB0aGUgcm91dGUgbW9kdWxlIHRoYXQgd2lsbCBiZSBjb25zdW1lZC5cbmV4cG9ydCBjb25zdCByb3V0ZU1vZHVsZSA9IG5ldyBQYWdlc0FQSVJvdXRlTW9kdWxlKHtcbiAgICBkZWZpbml0aW9uOiB7XG4gICAgICAgIGtpbmQ6IFJvdXRlS2luZC5QQUdFU19BUEksXG4gICAgICAgIHBhZ2U6IFwiL2FwaS9jYW1wYWlnbi9uZXctZXZlbnRzXCIsXG4gICAgICAgIHBhdGhuYW1lOiBcIi9hcGkvY2FtcGFpZ24vbmV3LWV2ZW50c1wiLFxuICAgICAgICAvLyBUaGUgZm9sbG93aW5nIGFyZW4ndCB1c2VkIGluIHByb2R1Y3Rpb24uXG4gICAgICAgIGJ1bmRsZVBhdGg6IFwiXCIsXG4gICAgICAgIGZpbGVuYW1lOiBcIlwiXG4gICAgfSxcbiAgICB1c2VybGFuZFxufSk7XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPXBhZ2VzLWFwaS5qcy5tYXAiXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fcampaign%2Fnew-events&preferredRegion=&absolutePagePath=.%2Fpages%5Capi%5Ccampaign%5Cnew-events.ts&middlewareConfigBase64=e30%3D!\n");

/***/ }),

/***/ "(api)/./lib/redis.ts":
/*!**********************!*\
  !*** ./lib/redis.ts ***!
  \**********************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   redis: () => (/* binding */ redis),\n/* harmony export */   subscribe: () => (/* binding */ subscribe),\n/* harmony export */   subscribeToChannels: () => (/* binding */ subscribeToChannels)\n/* harmony export */ });\n/* harmony import */ var ioredis__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ioredis */ \"ioredis\");\n/* harmony import */ var ioredis__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(ioredis__WEBPACK_IMPORTED_MODULE_0__);\n// lib/redis.ts\n\nconst redis = new (ioredis__WEBPACK_IMPORTED_MODULE_0___default())(process.env.REDIS_URL || \"redis://127.0.0.1:6379\", {\n    maxRetriesPerRequest: null,\n    lazyConnect: true,\n    reconnectOnError: (err)=>{\n        const targetErrors = [\n            \"READONLY\",\n            \"ECONNRESET\",\n            \"ETIMEDOUT\"\n        ];\n        try {\n            if (err && typeof err.message === \"string\") {\n                return targetErrors.some((e)=>err.message.includes(e));\n            }\n        } catch  {\n        // fall through\n        }\n        return false;\n    }\n});\nredis.on(\"connect\", ()=>console.log(\"Redis connected\"));\nredis.on(\"ready\", ()=>console.log(\"Redis ready\"));\nredis.on(\"error\", (err)=>console.error(\"Redis error\", err));\nredis.on(\"close\", ()=>console.warn(\"Redis connection closed\"));\nredis.on(\"reconnecting\", ()=>console.log(\"Redis reconnecting\"));\n/**\r\n * Subscribe to a single Redis channel (ioredis-style).\r\n *\r\n * Returns an async unsubscribe function that will remove listener, unsubscribe and quit the duplicate client.\r\n *\r\n * This implementation avoids calling `subscribe(channel, callback)` (which mismatches TS overloads)\r\n * and instead calls `await sub.subscribe(channel)` then listens to the 'message' event.\r\n */ async function subscribe(channel, handler) {\n    const sub = redis.duplicate();\n    // message listener that delegates to handler with parsed JSON when possible\n    const onMessage = (msgChannel, message)=>{\n        if (msgChannel !== channel) return;\n        try {\n            handler(JSON.parse(message));\n        } catch  {\n            handler(message);\n        }\n    };\n    // attach error logging early\n    sub.on(\"error\", (err)=>{\n        console.error(`Redis subscriber error for channel ${channel}`, err);\n    });\n    // attach the message handler and subscribe\n    sub.on(\"message\", onMessage);\n    try {\n        // ioredis duplicate may be lazy; connect explicitly\n        if (typeof sub.connect === \"function\") {\n            // connect() is a no-op if already connected\n            // ignore errors - the caller will see lack of events\n            // but log for debugging\n            await sub.connect().catch((err)=>{\n                console.warn(\"Subscriber connect error (continuing):\", err);\n            });\n        }\n        // call subscribe without a callback to satisfy TS overloads\n        await sub.subscribe(channel);\n    } catch (err) {\n        console.error(`Failed to subscribe to Redis channel ${channel}`, err);\n    }\n    // Return unsubscribe function\n    return async ()=>{\n        try {\n            sub.off(\"message\", onMessage);\n            try {\n                await sub.unsubscribe(channel);\n            } catch (e) {\n            // ignore\n            }\n            try {\n                await sub.quit();\n            } catch (e) {\n            // ignore\n            }\n        } catch (err) {\n            console.warn(`Failed to cleanly unsubscribe from Redis channel ${channel}`, err);\n        }\n    };\n}\n/**\r\n * Robust multi-channel subscription helper.\r\n * Supports ioredis style duplicate subscriber.\r\n *\r\n * sub: a pre-created subscriber client (e.g. redis.duplicate()) OR any compatible client.\r\n * channels: list of channel names\r\n * handler: (channel, message) => void\r\n *\r\n * This function will subscribe to each channel and also attach a fallback 'message' handler\r\n * (useful when some redis clients call back with different signatures).\r\n *\r\n * NOTE: This function does NOT call sub.quit()/sub.unsubscribe for you â€” the caller is responsible for cleanup.\r\n */ async function subscribeToChannels(sub, channels, handler) {\n    if (!sub || !channels || channels.length === 0) return;\n    // ensure connection if possible\n    try {\n        if (typeof sub.connect === \"function\") {\n            await sub.connect().catch((err)=>{\n                console.warn(\"subscribeToChannels: subscriber connect warning\", err);\n            });\n        }\n    } catch (e) {\n    // ignore connect errors\n    }\n    // Per-channel subscribe (ioredis subscribe returns a Promise)\n    for (const ch of channels){\n        try {\n            if (typeof sub.subscribe === \"function\") {\n                // call subscribe without callback to keep TS happy\n                await sub.subscribe(ch).catch((err)=>{\n                    // some clients may reject; try to continue\n                    console.warn(`subscribeToChannels: subscribe(${ch}) failed`, err);\n                });\n            } else {\n                // fallback: some clients may have different API\n                try {\n                    await sub.subscribe(ch);\n                } catch (e) {\n                    console.warn(`subscribeToChannels: fallback subscribe for ${ch} failed`, e);\n                }\n            }\n        } catch (e) {\n            console.warn(`subscribe failed for channel ${ch}, will attempt fallback`, e);\n        }\n    }\n    // Attach 'message' listener for ioredis-style events: (channel, message)\n    try {\n        if (typeof sub.on === \"function\") {\n            const onMsg = (a, b)=>{\n                // a may be channel or message depending on client; prefer (channel, message)\n                if (typeof a === \"string\" && typeof b === \"string\") {\n                    handler(a, b);\n                } else if (typeof b === \"string\" && channels.includes(b)) {\n                    // unusual ordering, try to map\n                    handler(b, a);\n                } else {\n                    // best-effort fallback: stringify inputs\n                    handler(String(a), String(b));\n                }\n            };\n            // store reference so caller may remove later if needed\n            sub.__subscribe_to_channels_on_message = onMsg;\n            sub.on(\"message\", onMsg);\n        }\n    } catch (e) {\n        console.warn(\"Fallback Redis message hook failed\", e);\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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USxDQUFDMEIsSUFBSTtvQkFDeEQsK0JBQStCO29CQUMvQmxCLFFBQVFrQixHQUFHRDtnQkFDYixPQUFPO29CQUNMLHlDQUF5QztvQkFDekNqQixRQUFRbUIsT0FBT0YsSUFBSUUsT0FBT0Q7Z0JBQzVCO1lBQ0Y7WUFDQSx1REFBdUQ7WUFDdERqQixJQUFZbUIsa0NBQWtDLEdBQUdKO1lBQ2xEZixJQUFJUixFQUFFLENBQUMsV0FBV3VCO1FBQ3BCO0lBQ0YsRUFBRSxPQUFPekIsR0FBRztRQUNWRyxRQUFRRyxJQUFJLENBQUMsc0NBQXNDTjtJQUNyRDtBQUNGIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vbWFya2V0aW5nLW12cC8uL2xpYi9yZWRpcy50cz81MWU5Il0sInNvdXJjZXNDb250ZW50IjpbIi8vIGxpYi9yZWRpcy50c1xyXG5pbXBvcnQgSU9SZWRpcyBmcm9tICdpb3JlZGlzJztcclxuXHJcbmV4cG9ydCBjb25zdCByZWRpcyA9IG5ldyBJT1JlZGlzKHByb2Nlc3MuZW52LlJFRElTX1VSTCB8fCAncmVkaXM6Ly8xMjcuMC4wLjE6NjM3OScsIHtcclxuICBtYXhSZXRyaWVzUGVyUmVxdWVzdDogbnVsbCxcclxuICBsYXp5Q29ubmVjdDogdHJ1ZSxcclxuICByZWNvbm5lY3RPbkVycm9yOiAoZXJyOiBhbnkpID0+IHtcclxuICAgIGNvbnN0IHRhcmdldEVycm9ycyA9IFsnUkVBRE9OTFknLCAnRUNPTk5SRVNFVCcsICdFVElNRURPVVQnXTtcclxuICAgIHRyeSB7XHJcbiAgICAgIGlmIChlcnIgJiYgdHlwZW9mIGVyci5tZXNzYWdlID09PSAnc3RyaW5nJykge1xyXG4gICAgICAgIHJldHVybiB0YXJnZXRFcnJvcnMuc29tZShlID0+IGVyci5tZXNzYWdlLmluY2x1ZGVzKGUpKTtcclxuICAgICAgfVxyXG4gICAgfSBjYXRjaCB7XHJcbiAgICAgIC8vIGZhbGwgdGhyb3VnaFxyXG4gICAgfVxyXG4gICAgcmV0dXJuIGZhbHNlO1xyXG4gIH0sXHJcbn0pO1xyXG5cclxucmVkaXMub24oJ2Nvbm5lY3QnLCAoKSA9PiBjb25zb2xlLmxvZygnUmVkaXMgY29ubmVjdGVkJykpO1xyXG5yZWRpcy5vbigncmVhZHknLCAoKSA9PiBjb25zb2xlLmxvZygnUmVkaXMgcmVhZHknKSk7XHJcbnJlZGlzLm9uKCdlcnJvcicsIChlcnIpID0+IGNvbnNvbGUuZXJyb3IoJ1JlZGlzIGVycm9yJywgZXJyKSk7XHJcbnJlZGlzLm9uKCdjbG9zZScsICgpID0+IGNvbnNvbGUud2FybignUmVkaXMgY29ubmVjdGlvbiBjbG9zZWQnKSk7XHJcbnJlZGlzLm9uKCdyZWNvbm5lY3RpbmcnLCAoKSA9PiBjb25zb2xlLmxvZygnUmVkaXMgcmVjb25uZWN0aW5nJykpO1xyXG5cclxuLyoqXHJcbiAqIFN1YnNjcmliZSB0byBhIHNpbmdsZSBSZWRpcyBjaGFubmVsIChpb3JlZGlzLXN0eWxlKS5cclxuICpcclxuICogUmV0dXJucyBhbiBhc3luYyB1bnN1YnNjcmliZSBmdW5jdGlvbiB0aGF0IHdpbGwgcmVtb3ZlIGxpc3RlbmVyLCB1bnN1YnNjcmliZSBhbmQgcXVpdCB0aGUgZHVwbGljYXRlIGNsaWVudC5cclxuICpcclxuICogVGhpcyBpbXBsZW1lbnRhdGlvbiBhdm9pZHMgY2FsbGluZyBgc3Vic2NyaWJlKGNoYW5uZWwsIGNhbGxiYWNrKWAgKHdoaWNoIG1pc21hdGNoZXMgVFMgb3ZlcmxvYWRzKVxyXG4gKiBhbmQgaW5zdGVhZCBjYWxscyBgYXdhaXQgc3ViLnN1YnNjcmliZShjaGFubmVsKWAgdGhlbiBsaXN0ZW5zIHRvIHRoZSAnbWVzc2FnZScgZXZlbnQuXHJcbiAqL1xyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gc3Vic2NyaWJlKGNoYW5uZWw6IHN0cmluZywgaGFuZGxlcjogKGRhdGE6IGFueSkgPT4gdm9pZCk6IFByb21pc2U8KCkgPT4gUHJvbWlzZTx2b2lkPj4ge1xyXG4gIGNvbnN0IHN1YiA9IHJlZGlzLmR1cGxpY2F0ZSgpO1xyXG5cclxuICAvLyBtZXNzYWdlIGxpc3RlbmVyIHRoYXQgZGVsZWdhdGVzIHRvIGhhbmRsZXIgd2l0aCBwYXJzZWQgSlNPTiB3aGVuIHBvc3NpYmxlXHJcbiAgY29uc3Qgb25NZXNzYWdlID0gKG1zZ0NoYW5uZWw6IHN0cmluZywgbWVzc2FnZTogc3RyaW5nKSA9PiB7XHJcbiAgICBpZiAobXNnQ2hhbm5lbCAhPT0gY2hhbm5lbCkgcmV0dXJuO1xyXG4gICAgdHJ5IHtcclxuICAgICAgaGFuZGxlcihKU09OLnBhcnNlKG1lc3NhZ2UpKTtcclxuICAgIH0gY2F0Y2gge1xyXG4gICAgICBoYW5kbGVyKG1lc3NhZ2UpO1xyXG4gICAgfVxyXG4gIH07XHJcblxyXG4gIC8vIGF0dGFjaCBlcnJvciBsb2dnaW5nIGVhcmx5XHJcbiAgc3ViLm9uKCdlcnJvcicsIChlcnI6IGFueSkgPT4ge1xyXG4gICAgY29uc29sZS5lcnJvcihgUmVkaXMgc3Vic2NyaWJlciBlcnJvciBmb3IgY2hhbm5lbCAke2NoYW5uZWx9YCwgZXJyKTtcclxuICB9KTtcclxuXHJcbiAgLy8gYXR0YWNoIHRoZSBtZXNzYWdlIGhhbmRsZXIgYW5kIHN1YnNjcmliZVxyXG4gIHN1Yi5vbignbWVzc2FnZScsIG9uTWVzc2FnZSk7XHJcblxyXG4gIHRyeSB7XHJcbiAgICAvLyBpb3JlZGlzIGR1cGxpY2F0ZSBtYXkgYmUgbGF6eTsgY29ubmVjdCBleHBsaWNpdGx5XHJcbiAgICBpZiAodHlwZW9mIChzdWIgYXMgYW55KS5jb25uZWN0ID09PSAnZnVuY3Rpb24nKSB7XHJcbiAgICAgIC8vIGNvbm5lY3QoKSBpcyBhIG5vLW9wIGlmIGFscmVhZHkgY29ubmVjdGVkXHJcbiAgICAgIC8vIGlnbm9yZSBlcnJvcnMgLSB0aGUgY2FsbGVyIHdpbGwgc2VlIGxhY2sgb2YgZXZlbnRzXHJcbiAgICAgIC8vIGJ1dCBsb2cgZm9yIGRlYnVnZ2luZ1xyXG4gICAgICBhd2FpdCAoc3ViIGFzIGFueSkuY29ubmVjdCgpLmNhdGNoKChlcnI6IGFueSkgPT4ge1xyXG4gICAgICAgIGNvbnNvbGUud2FybignU3Vic2NyaWJlciBjb25uZWN0IGVycm9yIChjb250aW51aW5nKTonLCBlcnIpO1xyXG4gICAgICB9KTtcclxuICAgIH1cclxuICAgIC8vIGNhbGwgc3Vic2NyaWJlIHdpdGhvdXQgYSBjYWxsYmFjayB0byBzYXRpc2Z5IFRTIG92ZXJsb2Fkc1xyXG4gICAgYXdhaXQgKHN1YiBhcyBhbnkpLnN1YnNjcmliZShjaGFubmVsKTtcclxuICB9IGNhdGNoIChlcnIpIHtcclxuICAgIGNvbnNvbGUuZXJyb3IoYEZhaWxlZCB0byBzdWJzY3JpYmUgdG8gUmVkaXMgY2hhbm5lbCAke2NoYW5uZWx9YCwgZXJyKTtcclxuICB9XHJcblxyXG4gIC8vIFJldHVybiB1bnN1YnNjcmliZSBmdW5jdGlvblxyXG4gIHJldHVybiBhc3luYyAoKSA9PiB7XHJcbiAgICB0cnkge1xyXG4gICAgICBzdWIub2ZmKCdtZXNzYWdlJywgb25NZXNzYWdlKTtcclxuICAgICAgdHJ5IHtcclxuICAgICAgICBhd2FpdCAoc3ViIGFzIGFueSkudW5zdWJzY3JpYmUoY2hhbm5lbCk7XHJcbiAgICAgIH0gY2F0Y2ggKGUpIHtcclxuICAgICAgICAvLyBpZ25vcmVcclxuICAgICAgfVxyXG4gICAgICB0cnkge1xyXG4gICAgICAgIGF3YWl0IChzdWIgYXMgYW55KS5xdWl0KCk7XHJcbiAgICAgIH0gY2F0Y2ggKGUpIHtcclxuICAgICAgICAvLyBpZ25vcmVcclxuICAgICAgfVxyXG4gICAgfSBjYXRjaCAoZXJyKSB7XHJcbiAgICAgIGNvbnNvbGUud2FybihgRmFpbGVkIHRvIGNsZWFubHkgdW5zdWJzY3JpYmUgZnJvbSBSZWRpcyBjaGFubmVsICR7Y2hhbm5lbH1gLCBlcnIpO1xyXG4gICAgfVxyXG4gIH07XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBSb2J1c3QgbXVsdGktY2hhbm5lbCBzdWJzY3JpcHRpb24gaGVscGVyLlxyXG4gKiBTdXBwb3J0cyBpb3JlZGlzIHN0eWxlIGR1cGxpY2F0ZSBzdWJzY3JpYmVyLlxyXG4gKlxyXG4gKiBzdWI6IGEgcHJlLWNyZWF0ZWQgc3Vic2NyaWJlciBjbGllbnQgKGUuZy4gcmVkaXMuZHVwbGljYXRlKCkpIE9SIGFueSBjb21wYXRpYmxlIGNsaWVudC5cclxuICogY2hhbm5lbHM6IGxpc3Qgb2YgY2hhbm5lbCBuYW1lc1xyXG4gKiBoYW5kbGVyOiAoY2hhbm5lbCwgbWVzc2FnZSkgPT4gdm9pZFxyXG4gKlxyXG4gKiBUaGlzIGZ1bmN0aW9uIHdpbGwgc3Vic2NyaWJlIHRvIGVhY2ggY2hhbm5lbCBhbmQgYWxzbyBhdHRhY2ggYSBmYWxsYmFjayAnbWVzc2FnZScgaGFuZGxlclxyXG4gKiAodXNlZnVsIHdoZW4gc29tZSByZWRpcyBjbGllbnRzIGNhbGwgYmFjayB3aXRoIGRpZmZlcmVudCBzaWduYXR1cmVzKS5cclxuICpcclxuICogTk9URTogVGhpcyBmdW5jdGlvbiBkb2VzIE5PVCBjYWxsIHN1Yi5xdWl0KCkvc3ViLnVuc3Vic2NyaWJlIGZvciB5b3Ug4oCUIHRoZSBjYWxsZXIgaXMgcmVzcG9uc2libGUgZm9yIGNsZWFudXAuXHJcbiAqL1xyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gc3Vic2NyaWJlVG9DaGFubmVscyhcclxuICBzdWI6IGFueSxcclxuICBjaGFubmVsczogc3RyaW5nW10sXHJcbiAgaGFuZGxlcjogKGNoYW5uZWw6IHN0cmluZywgbWVzc2FnZTogc3RyaW5nKSA9PiB2b2lkXHJcbik6IFByb21pc2U8dm9pZD4ge1xyXG4gIGlmICghc3ViIHx8ICFjaGFubmVscyB8fCBjaGFubmVscy5sZW5ndGggPT09IDApIHJldHVybjtcclxuXHJcbiAgLy8gZW5zdXJlIGNvbm5lY3Rpb24gaWYgcG9zc2libGVcclxuICB0cnkge1xyXG4gICAgaWYgKHR5cGVvZiBzdWIuY29ubmVjdCA9PT0gJ2Z1bmN0aW9uJykge1xyXG4gICAgICBhd2FpdCBzdWIuY29ubmVjdCgpLmNhdGNoKChlcnI6IGFueSkgPT4ge1xyXG4gICAgICAgIGNvbnNvbGUud2Fybignc3Vic2NyaWJlVG9DaGFubmVsczogc3Vic2NyaWJlciBjb25uZWN0IHdhcm5pbmcnLCBlcnIpO1xyXG4gICAgICB9KTtcclxuICAgIH1cclxuICB9IGNhdGNoIChlKSB7XHJcbiAgICAvLyBpZ25vcmUgY29ubmVjdCBlcnJvcnNcclxuICB9XHJcblxyXG4gIC8vIFBlci1jaGFubmVsIHN1YnNjcmliZSAoaW9yZWRpcyBzdWJzY3JpYmUgcmV0dXJucyBhIFByb21pc2UpXHJcbiAgZm9yIChjb25zdCBjaCBvZiBjaGFubmVscykge1xyXG4gICAgdHJ5IHtcclxuICAgICAgaWYgKHR5cGVvZiBzdWIuc3Vic2NyaWJlID09PSAnZnVuY3Rpb24nKSB7XHJcbiAgICAgICAgLy8gY2FsbCBzdWJzY3JpYmUgd2l0aG91dCBjYWxsYmFjayB0byBrZWVwIFRTIGhhcHB5XHJcbiAgICAgICAgYXdhaXQgc3ViLnN1YnNjcmliZShjaCkuY2F0Y2goKGVycjogYW55KSA9PiB7XHJcbiAgICAgICAgICAvLyBzb21lIGNsaWVudHMgbWF5IHJlamVjdDsgdHJ5IHRvIGNvbnRpbnVlXHJcbiAgICAgICAgICBjb25zb2xlLndhcm4oYHN1YnNjcmliZVRvQ2hhbm5lbHM6IHN1YnNjcmliZSgke2NofSkgZmFpbGVkYCwgZXJyKTtcclxuICAgICAgICB9KTtcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICAvLyBmYWxsYmFjazogc29tZSBjbGllbnRzIG1heSBoYXZlIGRpZmZlcmVudCBBUElcclxuICAgICAgICB0cnkge1xyXG4gICAgICAgICAgYXdhaXQgKHN1YiBhcyBhbnkpLnN1YnNjcmliZShjaCk7XHJcbiAgICAgICAgfSBjYXRjaCAoZSkge1xyXG4gICAgICAgICAgY29uc29sZS53YXJuKGBzdWJzY3JpYmVUb0NoYW5uZWxzOiBmYWxsYmFjayBzdWJzY3JpYmUgZm9yICR7Y2h9IGZhaWxlZGAsIGUpO1xyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgfSBjYXRjaCAoZSkge1xyXG4gICAgICBjb25zb2xlLndhcm4oYHN1YnNjcmliZSBmYWlsZWQgZm9yIGNoYW5uZWwgJHtjaH0sIHdpbGwgYXR0ZW1wdCBmYWxsYmFja2AsIGUpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgLy8gQXR0YWNoICdtZXNzYWdlJyBsaXN0ZW5lciBmb3IgaW9yZWRpcy1zdHlsZSBldmVudHM6IChjaGFubmVsLCBtZXNzYWdlKVxyXG4gIHRyeSB7XHJcbiAgICBpZiAodHlwZW9mIHN1Yi5vbiA9PT0gJ2Z1bmN0aW9uJykge1xyXG4gICAgICBjb25zdCBvbk1zZyA9IChhOiBhbnksIGI6IGFueSkgPT4ge1xyXG4gICAgICAgIC8vIGEgbWF5IGJlIGNoYW5uZWwgb3IgbWVzc2FnZSBkZXBlbmRpbmcgb24gY2xpZW50OyBwcmVmZXIgKGNoYW5uZWwsIG1lc3NhZ2UpXHJcbiAgICAgICAgaWYgKHR5cGVvZiBhID09PSAnc3RyaW5nJyAmJiB0eXBlb2YgYiA9PT0gJ3N0cmluZycpIHtcclxuICAgICAgICAgIGhhbmRsZXIoYSwgYik7XHJcbiAgICAgICAgfSBlbHNlIGlmICh0eXBlb2YgYiA9PT0gJ3N0cmluZycgJiYgY2hhbm5lbHMuaW5jbHVkZXMoYikpIHtcclxuICAgICAgICAgIC8vIHVudXN1YWwgb3JkZXJpbmcsIHRyeSB0byBtYXBcclxuICAgICAgICAgIGhhbmRsZXIoYiwgYSk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgIC8vIGJlc3QtZWZmb3J0IGZhbGxiYWNrOiBzdHJpbmdpZnkgaW5wdXRzXHJcbiAgICAgICAgICBoYW5kbGVyKFN0cmluZyhhKSwgU3RyaW5nKGIpKTtcclxuICAgICAgICB9XHJcbiAgICAgIH07XHJcbiAgICAgIC8vIHN0b3JlIHJlZmVyZW5jZSBzbyBjYWxsZXIgbWF5IHJlbW92ZSBsYXRlciBpZiBuZWVkZWRcclxuICAgICAgKHN1YiBhcyBhbnkpLl9fc3Vic2NyaWJlX3RvX2NoYW5uZWxzX29uX21lc3NhZ2UgPSBvbk1zZztcclxuICAgICAgc3ViLm9uKCdtZXNzYWdlJywgb25Nc2cpO1xyXG4gICAgfVxyXG4gIH0gY2F0Y2ggKGUpIHtcclxuICAgIGNvbnNvbGUud2FybignRmFsbGJhY2sgUmVkaXMgbWVzc2FnZSBob29rIGZhaWxlZCcsIGUpO1xyXG4gIH1cclxufVxyXG4iXSwibmFtZXMiOlsiSU9SZWRpcyIsInJlZGlzIiwicHJvY2VzcyIsImVudiIsIlJFRElTX1VSTCIsIm1heFJldHJpZXNQZXJSZXF1ZXN0IiwibGF6eUNvbm5lY3QiLCJyZWNvbm5lY3RPbkVycm9yIiwiZXJyIiwidGFyZ2V0RXJyb3JzIiwibWVzc2FnZSIsInNvbWUiLCJlIiwiaW5jbHVkZXMiLCJvbiIsImNvbnNvbGUiLCJsb2ciLCJlcnJvciIsIndhcm4iLCJzdWJzY3JpYmUiLCJjaGFubmVsIiwiaGFuZGxlciIsInN1YiIsImR1cGxpY2F0ZSIsIm9uTWVzc2FnZSIsIm1zZ0NoYW5uZWwiLCJKU09OIiwicGFyc2UiLCJjb25uZWN0IiwiY2F0Y2giLCJvZmYiLCJ1bnN1YnNjcmliZSIsInF1aXQiLCJzdWJzY3JpYmVUb0NoYW5uZWxzIiwiY2hhbm5lbHMiLCJsZW5ndGgiLCJjaCIsIm9uTXNnIiwiYSIsImIiLCJTdHJpbmciLCJfX3N1YnNjcmliZV90b19jaGFubmVsc19vbl9tZXNzYWdlIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(api)/./lib/redis.ts\n");

/***/ }),

/***/ "(api)/./pages/api/campaign/new-events.ts":
/*!******************************************!*\
  !*** ./pages/api/campaign/new-events.ts ***!
  \******************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (/* binding */ handler)\n/* harmony export */ });\n/* harmony import */ var _lib_redis__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../lib/redis */ \"(api)/./lib/redis.ts\");\n// pages/api/campaign/new-events.ts\n\nasync function handler(req, res) {\n    // Standard SSE headers\n    res.setHeader(\"Content-Type\", \"text/event-stream\");\n    res.setHeader(\"Cache-Control\", \"no-cache\");\n    res.setHeader(\"Connection\", \"keep-alive\");\n    // Disable buffering for nginx/fastly proxies\n    res.setHeader(\"X-Accel-Buffering\", \"no\");\n    res.flushHeaders && res.flushHeaders();\n    // Create a dedicated subscriber so we don't interfere with main client usage\n    const sub = _lib_redis__WEBPACK_IMPORTED_MODULE_0__.redis.duplicate();\n    try {\n        await sub.connect();\n    } catch (err) {\n        console.error(\"Failed to connect redis subscriber for /campaign/new-events\", err);\n        // Send an SSE error event then close\n        try {\n            res.write(`event: error\\n`);\n            res.write(`data: ${JSON.stringify({\n                error: \"redis-connect-failed\"\n            })}\\n\\n`);\n        } catch (_) {}\n        res.end();\n        return;\n    }\n    // Heartbeat to keep connection alive for proxies/load balancers\n    const heartbeatMs = 15000;\n    const heartbeat = setInterval(()=>{\n        try {\n            res.write(`event: ping\\n`);\n            res.write(`data: ${JSON.stringify({\n                ts: Date.now()\n            })}\\n\\n`);\n        } catch (e) {\n        // ignore writes errors\n        }\n    }, heartbeatMs);\n    // Subscribe to campaign:new events\n    try {\n        await sub.subscribe(\"campaign:new\");\n        sub.on(\"message\", (channel, msg)=>{\n            if (channel !== \"campaign:new\") return;\n            try {\n                res.write(`data: ${msg}\\n\\n`);\n            } catch (e) {\n                console.warn(\"SSE write failed\", e);\n            }\n        });\n    } catch (err) {\n        console.error(\"Failed to subscribe to campaign:new\", err);\n        try {\n            res.write(`event: error\\n`);\n            res.write(`data: ${JSON.stringify({\n                error: \"subscribe-failed\"\n            })}\\n\\n`);\n        } catch (_) {}\n    }\n    // Cleanup on client disconnect\n    req.on(\"close\", async ()=>{\n        clearInterval(heartbeat);\n        try {\n            // best-effort unsubscribe + quit\n            try {\n                await sub.unsubscribe(\"campaign:new\");\n            } catch (_) {}\n            try {\n                await sub.quit();\n            } catch (_) {}\n        } catch (e) {\n            console.warn(\"Error while cleaning up redis subscriber for /campaign/new-events\", e);\n        }\n        try {\n            res.end();\n        } catch (_) {}\n    });\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi9wYWdlcy9hcGkvY2FtcGFpZ24vbmV3LWV2ZW50cy50cyIsIm1hcHBpbmdzIjoiOzs7OztBQUFBLG1DQUFtQztBQUVRO0FBRTVCLGVBQWVDLFFBQzVCQyxHQUFtQixFQUNuQkMsR0FBb0I7SUFFcEIsdUJBQXVCO0lBQ3ZCQSxJQUFJQyxTQUFTLENBQUMsZ0JBQWdCO0lBQzlCRCxJQUFJQyxTQUFTLENBQUMsaUJBQWlCO0lBQy9CRCxJQUFJQyxTQUFTLENBQUMsY0FBYztJQUM1Qiw2Q0FBNkM7SUFDN0NELElBQUlDLFNBQVMsQ0FBQyxxQkFBcUI7SUFDbENELElBQVlFLFlBQVksSUFBSSxJQUFhQSxZQUFZO0lBRXRELDZFQUE2RTtJQUM3RSxNQUFNQyxNQUFNTiw2Q0FBS0EsQ0FBQ08sU0FBUztJQUUzQixJQUFJO1FBQ0YsTUFBTUQsSUFBSUUsT0FBTztJQUNuQixFQUFFLE9BQU9DLEtBQUs7UUFDWkMsUUFBUUMsS0FBSyxDQUFDLCtEQUErREY7UUFDN0UscUNBQXFDO1FBQ3JDLElBQUk7WUFDRk4sSUFBSVMsS0FBSyxDQUFDLENBQUMsY0FBYyxDQUFDO1lBQzFCVCxJQUFJUyxLQUFLLENBQUMsQ0FBQyxNQUFNLEVBQUVDLEtBQUtDLFNBQVMsQ0FBQztnQkFBRUgsT0FBTztZQUF1QixHQUFHLElBQUksQ0FBQztRQUM1RSxFQUFFLE9BQU9JLEdBQUcsQ0FBRTtRQUNkWixJQUFJYSxHQUFHO1FBQ1A7SUFDRjtJQUVBLGdFQUFnRTtJQUNoRSxNQUFNQyxjQUFjO0lBQ3BCLE1BQU1DLFlBQVlDLFlBQVk7UUFDNUIsSUFBSTtZQUNGaEIsSUFBSVMsS0FBSyxDQUFDLENBQUMsYUFBYSxDQUFDO1lBQ3pCVCxJQUFJUyxLQUFLLENBQUMsQ0FBQyxNQUFNLEVBQUVDLEtBQUtDLFNBQVMsQ0FBQztnQkFBRU0sSUFBSUMsS0FBS0MsR0FBRztZQUFHLEdBQUcsSUFBSSxDQUFDO1FBQzdELEVBQUUsT0FBT0MsR0FBRztRQUNWLHVCQUF1QjtRQUN6QjtJQUNGLEdBQUdOO0lBRUgsbUNBQW1DO0lBQ25DLElBQUk7UUFDRixNQUFNWCxJQUFJa0IsU0FBUyxDQUFDO1FBRXBCbEIsSUFBSW1CLEVBQUUsQ0FBQyxXQUFXLENBQUNDLFNBQVNDO1lBQzFCLElBQUlELFlBQVksZ0JBQWdCO1lBQ2hDLElBQUk7Z0JBQ0Z2QixJQUFJUyxLQUFLLENBQUMsQ0FBQyxNQUFNLEVBQUVlLElBQUksSUFBSSxDQUFDO1lBQzlCLEVBQUUsT0FBT0osR0FBRztnQkFDVmIsUUFBUWtCLElBQUksQ0FBQyxvQkFBb0JMO1lBQ25DO1FBQ0Y7SUFDRixFQUFFLE9BQU9kLEtBQUs7UUFDWkMsUUFBUUMsS0FBSyxDQUFDLHVDQUF1Q0Y7UUFDckQsSUFBSTtZQUNGTixJQUFJUyxLQUFLLENBQUMsQ0FBQyxjQUFjLENBQUM7WUFDMUJULElBQUlTLEtBQUssQ0FBQyxDQUFDLE1BQU0sRUFBRUMsS0FBS0MsU0FBUyxDQUFDO2dCQUFFSCxPQUFPO1lBQW1CLEdBQUcsSUFBSSxDQUFDO1FBQ3hFLEVBQUUsT0FBT0ksR0FBRyxDQUFFO0lBQ2hCO0lBRUEsK0JBQStCO0lBQy9CYixJQUFJdUIsRUFBRSxDQUFDLFNBQVM7UUFDZEksY0FBY1g7UUFDZCxJQUFJO1lBQ0YsaUNBQWlDO1lBQ2pDLElBQUk7Z0JBQUUsTUFBTVosSUFBSXdCLFdBQVcsQ0FBQztZQUFpQixFQUFFLE9BQU9mLEdBQUcsQ0FBRTtZQUMzRCxJQUFJO2dCQUFFLE1BQU1ULElBQUl5QixJQUFJO1lBQUksRUFBRSxPQUFPaEIsR0FBRyxDQUFFO1FBQ3hDLEVBQUUsT0FBT1EsR0FBRztZQUNWYixRQUFRa0IsSUFBSSxDQUFDLHFFQUFxRUw7UUFDcEY7UUFDQSxJQUFJO1lBQUVwQixJQUFJYSxHQUFHO1FBQUksRUFBRSxPQUFPRCxHQUFHLENBQUU7SUFDakM7QUFDRiIsInNvdXJjZXMiOlsid2VicGFjazovL21hcmtldGluZy1tdnAvLi9wYWdlcy9hcGkvY2FtcGFpZ24vbmV3LWV2ZW50cy50cz85ZjllIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIHBhZ2VzL2FwaS9jYW1wYWlnbi9uZXctZXZlbnRzLnRzXHJcbmltcG9ydCB0eXBlIHsgTmV4dEFwaVJlcXVlc3QsIE5leHRBcGlSZXNwb25zZSB9IGZyb20gJ25leHQnO1xyXG5pbXBvcnQgeyByZWRpcyB9IGZyb20gJy4uLy4uLy4uL2xpYi9yZWRpcyc7XHJcblxyXG5leHBvcnQgZGVmYXVsdCBhc3luYyBmdW5jdGlvbiBoYW5kbGVyKFxyXG4gIHJlcTogTmV4dEFwaVJlcXVlc3QsXHJcbiAgcmVzOiBOZXh0QXBpUmVzcG9uc2VcclxuKSB7XHJcbiAgLy8gU3RhbmRhcmQgU1NFIGhlYWRlcnNcclxuICByZXMuc2V0SGVhZGVyKCdDb250ZW50LVR5cGUnLCAndGV4dC9ldmVudC1zdHJlYW0nKTtcclxuICByZXMuc2V0SGVhZGVyKCdDYWNoZS1Db250cm9sJywgJ25vLWNhY2hlJyk7XHJcbiAgcmVzLnNldEhlYWRlcignQ29ubmVjdGlvbicsICdrZWVwLWFsaXZlJyk7XHJcbiAgLy8gRGlzYWJsZSBidWZmZXJpbmcgZm9yIG5naW54L2Zhc3RseSBwcm94aWVzXHJcbiAgcmVzLnNldEhlYWRlcignWC1BY2NlbC1CdWZmZXJpbmcnLCAnbm8nKTtcclxuICAocmVzIGFzIGFueSkuZmx1c2hIZWFkZXJzICYmIChyZXMgYXMgYW55KS5mbHVzaEhlYWRlcnMoKTtcclxuXHJcbiAgLy8gQ3JlYXRlIGEgZGVkaWNhdGVkIHN1YnNjcmliZXIgc28gd2UgZG9uJ3QgaW50ZXJmZXJlIHdpdGggbWFpbiBjbGllbnQgdXNhZ2VcclxuICBjb25zdCBzdWIgPSByZWRpcy5kdXBsaWNhdGUoKTtcclxuXHJcbiAgdHJ5IHtcclxuICAgIGF3YWl0IHN1Yi5jb25uZWN0KCk7XHJcbiAgfSBjYXRjaCAoZXJyKSB7XHJcbiAgICBjb25zb2xlLmVycm9yKCdGYWlsZWQgdG8gY29ubmVjdCByZWRpcyBzdWJzY3JpYmVyIGZvciAvY2FtcGFpZ24vbmV3LWV2ZW50cycsIGVycik7XHJcbiAgICAvLyBTZW5kIGFuIFNTRSBlcnJvciBldmVudCB0aGVuIGNsb3NlXHJcbiAgICB0cnkge1xyXG4gICAgICByZXMud3JpdGUoYGV2ZW50OiBlcnJvclxcbmApO1xyXG4gICAgICByZXMud3JpdGUoYGRhdGE6ICR7SlNPTi5zdHJpbmdpZnkoeyBlcnJvcjogJ3JlZGlzLWNvbm5lY3QtZmFpbGVkJyB9KX1cXG5cXG5gKTtcclxuICAgIH0gY2F0Y2ggKF8pIHsgfVxyXG4gICAgcmVzLmVuZCgpO1xyXG4gICAgcmV0dXJuO1xyXG4gIH1cclxuXHJcbiAgLy8gSGVhcnRiZWF0IHRvIGtlZXAgY29ubmVjdGlvbiBhbGl2ZSBmb3IgcHJveGllcy9sb2FkIGJhbGFuY2Vyc1xyXG4gIGNvbnN0IGhlYXJ0YmVhdE1zID0gMTUwMDA7XHJcbiAgY29uc3QgaGVhcnRiZWF0ID0gc2V0SW50ZXJ2YWwoKCkgPT4ge1xyXG4gICAgdHJ5IHtcclxuICAgICAgcmVzLndyaXRlKGBldmVudDogcGluZ1xcbmApO1xyXG4gICAgICByZXMud3JpdGUoYGRhdGE6ICR7SlNPTi5zdHJpbmdpZnkoeyB0czogRGF0ZS5ub3coKSB9KX1cXG5cXG5gKTtcclxuICAgIH0gY2F0Y2ggKGUpIHtcclxuICAgICAgLy8gaWdub3JlIHdyaXRlcyBlcnJvcnNcclxuICAgIH1cclxuICB9LCBoZWFydGJlYXRNcyk7XHJcblxyXG4gIC8vIFN1YnNjcmliZSB0byBjYW1wYWlnbjpuZXcgZXZlbnRzXHJcbiAgdHJ5IHtcclxuICAgIGF3YWl0IHN1Yi5zdWJzY3JpYmUoXCJjYW1wYWlnbjpuZXdcIik7XHJcblxyXG4gICAgc3ViLm9uKFwibWVzc2FnZVwiLCAoY2hhbm5lbCwgbXNnKSA9PiB7XHJcbiAgICAgIGlmIChjaGFubmVsICE9PSBcImNhbXBhaWduOm5ld1wiKSByZXR1cm47XHJcbiAgICAgIHRyeSB7XHJcbiAgICAgICAgcmVzLndyaXRlKGBkYXRhOiAke21zZ31cXG5cXG5gKTtcclxuICAgICAgfSBjYXRjaCAoZSkge1xyXG4gICAgICAgIGNvbnNvbGUud2FybihcIlNTRSB3cml0ZSBmYWlsZWRcIiwgZSk7XHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG4gIH0gY2F0Y2ggKGVycikge1xyXG4gICAgY29uc29sZS5lcnJvcignRmFpbGVkIHRvIHN1YnNjcmliZSB0byBjYW1wYWlnbjpuZXcnLCBlcnIpO1xyXG4gICAgdHJ5IHtcclxuICAgICAgcmVzLndyaXRlKGBldmVudDogZXJyb3JcXG5gKTtcclxuICAgICAgcmVzLndyaXRlKGBkYXRhOiAke0pTT04uc3RyaW5naWZ5KHsgZXJyb3I6ICdzdWJzY3JpYmUtZmFpbGVkJyB9KX1cXG5cXG5gKTtcclxuICAgIH0gY2F0Y2ggKF8pIHsgfVxyXG4gIH1cclxuXHJcbiAgLy8gQ2xlYW51cCBvbiBjbGllbnQgZGlzY29ubmVjdFxyXG4gIHJlcS5vbignY2xvc2UnLCBhc3luYyAoKSA9PiB7XHJcbiAgICBjbGVhckludGVydmFsKGhlYXJ0YmVhdCk7XHJcbiAgICB0cnkge1xyXG4gICAgICAvLyBiZXN0LWVmZm9ydCB1bnN1YnNjcmliZSArIHF1aXRcclxuICAgICAgdHJ5IHsgYXdhaXQgc3ViLnVuc3Vic2NyaWJlKCdjYW1wYWlnbjpuZXcnKTsgfSBjYXRjaCAoXykgeyB9XHJcbiAgICAgIHRyeSB7IGF3YWl0IHN1Yi5xdWl0KCk7IH0gY2F0Y2ggKF8pIHsgfVxyXG4gICAgfSBjYXRjaCAoZSkge1xyXG4gICAgICBjb25zb2xlLndhcm4oJ0Vycm9yIHdoaWxlIGNsZWFuaW5nIHVwIHJlZGlzIHN1YnNjcmliZXIgZm9yIC9jYW1wYWlnbi9uZXctZXZlbnRzJywgZSk7XHJcbiAgICB9XHJcbiAgICB0cnkgeyByZXMuZW5kKCk7IH0gY2F0Y2ggKF8pIHsgfVxyXG4gIH0pO1xyXG59XHJcbiJdLCJuYW1lcyI6WyJyZWRpcyIsImhhbmRsZXIiLCJyZXEiLCJyZXMiLCJzZXRIZWFkZXIiLCJmbHVzaEhlYWRlcnMiLCJzdWIiLCJkdXBsaWNhdGUiLCJjb25uZWN0IiwiZXJyIiwiY29uc29sZSIsImVycm9yIiwid3JpdGUiLCJKU09OIiwic3RyaW5naWZ5IiwiXyIsImVuZCIsImhlYXJ0YmVhdE1zIiwiaGVhcnRiZWF0Iiwic2V0SW50ZXJ2YWwiLCJ0cyIsIkRhdGUiLCJub3ciLCJlIiwic3Vic2NyaWJlIiwib24iLCJjaGFubmVsIiwibXNnIiwid2FybiIsImNsZWFySW50ZXJ2YWwiLCJ1bnN1YnNjcmliZSIsInF1aXQiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(api)/./pages/api/campaign/new-events.ts\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../webpack-api-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next"], () => (__webpack_exec__("(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fcampaign%2Fnew-events&preferredRegion=&absolutePagePath=.%2Fpages%5Capi%5Ccampaign%5Cnew-events.ts&middlewareConfigBase64=e30%3D!")));
module.exports = __webpack_exports__;

})();